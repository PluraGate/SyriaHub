node.exe : (node:39184) 
ExperimentalWarning: CommonJS module C:\U
sers\AvArc\RiderProjects\SyriaHub\vitest.
config.ts is loading ES Module C:\Users\A
vArc\RiderProjects\SyriaHub\node_modules\
@vitejs\plugin-react\dist\index.js using 
require().
At C:\Program Files\nodejs\npx.ps1:29 
char:3
+   & $NODE_EXE $NPX_CLI_JS $args
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecifi 
   ed: ((node:39184) Ex...sing require(  
  ).:String) [], RemoteException
    + FullyQualifiedErrorId : NativeComm 
   andError
 
Support for loading ES Module in 
require() is an experimental feature and 
might change at any time
(Use `node --trace-warnings ...` to show 
where the warning was created)

[1m[46m RUN [49m[22m [36mv4.0.16 [39m[90mC:/Users/AvArc/RiderProjects/SyriaHub[39m

[90mstdout[2m | tests/unit/components/Footer.test.tsx
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ΓÜÖ∩╕Å  write to custom object with { processEnv: myObject }
[dotenv@17.2.3] injecting env (0) from .env -- tip: ≡ƒöÉ prevent building .env in docker: https://dotenvx.com/prebuild

[90mstdout[2m | tests/unit/components/SpatialEditor.test.tsx
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒæÑ sync secrets across teammates & machines: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ΓÜÖ∩╕Å  write to custom object with { processEnv: myObject }

[90mstdout[2m | tests/unit/components/JuryPanel.test.tsx
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ΓÜÖ∩╕Å  specify custom .env file path with { path: '/custom/path/.env' }
[dotenv@17.2.3] injecting env (0) from .env -- tip: ≡ƒöÉ prevent committing .env to code: https://dotenvx.com/precommit

[90mstdout[2m | tests/unit/components/AuthForm.test.tsx
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒöÉ prevent committing .env to code: https://dotenvx.com/precommit
[dotenv@17.2.3] injecting env (0) from .env -- tip: ΓÜÖ∩╕Å  override existing env vars with { override: true }

[90mstdout[2m | tests/unit/lib/patternDetector.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ΓÜÖ∩╕Å  enable debug logging with { debug: true }
[dotenv@17.2.3] injecting env (0) from .env -- tip: Γ£à audit secrets and track compliance: https://dotenvx.com/ops

[90mstdout[2m | tests/unit/api/routes.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒöÉ prevent building .env in docker: https://dotenvx.com/prebuild
[dotenv@17.2.3] injecting env (0) from .env -- tip: ≡ƒæÑ sync secrets across teammates & machines: https://dotenvx.com/ops

[90mstdout[2m | tests/unit/lib/citations.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒöæ add access controls to secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ΓÜÖ∩╕Å  write to custom object with { processEnv: myObject }

[90mstdout[2m | tests/unit/db/counterAudit.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒùé∩╕Å backup and recover secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ≡ƒæÑ sync secrets across teammates & machines: https://dotenvx.com/ops

[90mstdout[2m | tests/unit/components/CommentsSection.test.tsx
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒöÉ prevent committing .env to code: https://dotenvx.com/precommit
[dotenv@17.2.3] injecting env (0) from .env -- tip: ≡ƒæÑ sync secrets across teammates & machines: https://dotenvx.com/ops

[90mstdout[2m | tests/unit/lib/supabase.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒöæ add access controls to secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ΓÜÖ∩╕Å  suppress all logs with { quiet: true }

[90mstdout[2m | tests/unit/components/UserLevelBadge.test.tsx
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ΓÜÖ∩╕Å  suppress all logs with { quiet: true }
[dotenv@17.2.3] injecting env (0) from .env -- tip: ΓÜÖ∩╕Å  enable debug logging with { debug: true }

[90mstdout[2m | tests/unit/components/HomeContentFilter.test.tsx
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒùé∩╕Å backup and recover secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ≡ƒöÉ prevent committing .env to code: https://dotenvx.com/precommit

[90mstdout[2m | tests/unit/components/BadgeDisplay.test.tsx
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒöä add secrets lifecycle management: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ≡ƒöÉ encrypt with Dotenvx: https://dotenvx.com

[90mstdout[2m | tests/unit/lib/formatDate.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒöÉ prevent building .env in docker: https://dotenvx.com/prebuild
[dotenv@17.2.3] injecting env (0) from .env -- tip: ΓÜÖ∩╕Å  override existing env vars with { override: true }

[90mstdout[2m | tests/unit/lib/moderation.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ΓÜÖ∩╕Å  write to custom object with { processEnv: myObject }
[dotenv@17.2.3] injecting env (0) from .env -- tip: ≡ƒöæ add access controls to secrets: https://dotenvx.com/ops

[90mstderr[2m | 
tests/unit/lib/moderation.test.ts[2m > 
[22m[2mModeration Module[2m > 
[22m[2mmoderateContentWithOpenAI[2m > 
[22m[2mshould return safe result when 
API key is not configured
[22m[39mOpenAI API key not configured, 
skipping AI moderation

 [32mΓ£ô[39m tests/unit/lib/citations.test.ts [2m([22m[2m29 tests[22m[2m)[22m[32m 61[2mms[22m[39m
[90mstderr[2m | 
tests/unit/lib/moderation.test.ts[2m > 
[22m[2mModeration Module[2m > 
[22m[2mmoderateContentWithOpenAI[2m > 
[22m[2mshould handle API errors 
gracefully (fail open)
[22m[39mOpenAI moderation error: 
Error: OpenAI API error: Internal Server 
Error
    at moderateContentWithOpenAI (C:/User
s/AvArc/RiderProjects/SyriaHub/domain/mod
eration/service.ts:76:13)
[90m    at processTicksAndRejections (no
de:internal/process/task_queues:105:5)[3
9m
    at C:/Users/AvArc/RiderProjects/Syria
Hub/tests/unit/lib/moderation.test.ts:98:
22
    at [90mfile:///C:/Users/AvArc/RiderP
rojects/SyriaHub/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:915:20

[90mstderr[2m | 
tests/unit/lib/moderation.test.ts[2m > 
[22m[2mModeration Module[2m > 
[22m[2mmoderateContentWithOpenAI[2m > 
[22m[2mshould handle network errors 
gracefully
[22m[39mOpenAI moderation error: 
Error: Network error
    at C:/Users/AvArc/RiderProjects/Syria
Hub/tests/unit/lib/moderation.test.ts:107
:39
    at [90mfile:///C:/Users/AvArc/RiderP
rojects/SyriaHub/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:145:11
    at [90mfile:///C:/Users/AvArc/RiderP
rojects/SyriaHub/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:915:26
    at [90mfile:///C:/Users/AvArc/RiderP
rojects/SyriaHub/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Us
ers/AvArc/RiderProjects/SyriaHub/[39mnod
e_modules/[4m@vitest[24m/runner/dist/in
dex.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/AvArc/RiderP
rojects/SyriaHub/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Av
Arc/RiderProjects/SyriaHub/[39mnode_modu
les/[4mvitest[24m/dist/chunks/traces.U4
xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///C:/Users/AvArc
/RiderProjects/SyriaHub/[39mnode_modules
/[4mvitest[24m/dist/chunks/test.B8ej_ZH
S.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/AvA
rc/RiderProjects/SyriaHub/[39mnode_modul
es/[4m@vitest[24m/runner/dist/index.js:
1653:12[90m)[39m

[90mstderr[2m | 
tests/unit/lib/moderation.test.ts[2m > 
[22m[2mModeration Module[2m > [22m[2
mmoderateContentWithPerspective[2m > 
[22m[2mshould return safe result when 
API key is not configured
[22m[39mPerspective API key not 
configured, skipping moderation

[90mstderr[2m | 
tests/unit/lib/moderation.test.ts[2m > 
[22m[2mModeration Module[2m > 
[22m[2mmoderateContent (main 
function)[2m > [22m[2mshould fall 
back to Perspective when OpenAI not 
configured
[22m[39mOpenAI API key not configured, 
skipping AI moderation

 [32mΓ£ô[39m tests/unit/lib/patternDetector.test.ts [2m([22m[2m50 tests[22m[2m)[22m[32m 30[2mms[22m[39m
[90mstderr[2m | 
tests/unit/lib/moderation.test.ts[2m > 
[22m[2mModeration Module[2m > 
[22m[2mmoderateContent (main 
function)[2m > [22m[2mshould return 
safe default when no APIs configured
[22m[39mOpenAI API key not configured, 
skipping AI moderation

[90mstderr[2m | 
tests/unit/lib/moderation.test.ts[2m > 
[22m[2mModeration Module[2m > 
[22m[2mmoderateContent (main 
function)[2m > [22m[2mshould return 
safe default when no APIs configured
[22m[39mPerspective API key not 
configured, skipping moderation

 [32mΓ£ô[39m tests/unit/lib/moderation.test.ts [2m([22m[2m15 tests[22m[2m)[22m[32m 38[2mms[22m[39m
 [32mΓ£ô[39m tests/unit/lib/supabase.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 1175[2mms[22m[39m
       [33m[2mΓ£ô[22m[39m should export createClient function [33m 589[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m should export middleware utilities [33m 441[2mms[22m[39m
[90mstdout[2m | tests/unit/api/routes.test.ts[2m > [22m[2mAPI Route Structure[2m > [22m[2mPosts API[2m > [22m[2mshould have GET and POST handlers
[22m[39m[dotenv@17.2.3] injecting env (0) from .env.local -- tip: ΓÜÖ∩╕Å  override existing env vars with { override: true }

 [32mΓ£ô[39m tests/unit/components/BadgeDisplay.test.tsx [2m([22m[2m4 tests[22m[2m)[22m[32m 120[2mms[22m[39m
 [32mΓ£ô[39m tests/unit/api/routes.test.ts [2m([22m[2m2 tests[22m[2m)[22m[33m 1258[2mms[22m[39m
       [33m[2mΓ£ô[22m[39m should have proper exports [33m 717[2mms[22m[39m
       [33m[2mΓ£ô[22m[39m should have GET and POST handlers [33m 539[2mms[22m[39m
[90mstderr[2m | tests/unit/components/C
ommentsSection.test.tsx[2m > 
[22m[2mCommentsSection Component[2m > 
[22m[2mError handling[2m > 
[22m[2mshould show error toast on 
network failure
[22m[39mComments fetch error: Error: 
Network error
    at C:/Users/AvArc/RiderProjects/Syria
Hub/tests/unit/components/CommentsSection
.test.tsx:195:39
    at [90mfile:///C:/Users/AvArc/RiderP
rojects/SyriaHub/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:145:11
    at [90mfile:///C:/Users/AvArc/RiderP
rojects/SyriaHub/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:915:26
    at [90mfile:///C:/Users/AvArc/RiderP
rojects/SyriaHub/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Us
ers/AvArc/RiderProjects/SyriaHub/[39mnod
e_modules/[4m@vitest[24m/runner/dist/in
dex.js:1209:10[90m)[39m
    at [90mfile:///C:/Users/AvArc/RiderP
rojects/SyriaHub/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/Av
Arc/RiderProjects/SyriaHub/[39mnode_modu
les/[4mvitest[24m/dist/chunks/traces.U4
xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///C:/Users/AvArc
/RiderProjects/SyriaHub/[39mnode_modules
/[4mvitest[24m/dist/chunks/test.B8ej_ZH
S.js:239:21[90m)[39m
    at runTest [90m(file:///C:/Users/AvA
rc/RiderProjects/SyriaHub/[39mnode_modul
es/[4m@vitest[24m/runner/dist/index.js:
1653:12[90m)[39m

 [32mΓ£ô[39m tests/unit/components/CommentsSection.test.tsx [2m([22m[2m15 tests[22m[2m)[22m[33m 404[2mms[22m[39m
 [32mΓ£ô[39m tests/unit/components/UserLevelBadge.test.tsx [2m([22m[2m10 tests[22m[2m)[22m[32m 209[2mms[22m[39m
 [32mΓ£ô[39m tests/unit/components/Footer.test.tsx [2m([22m[2m2 tests[22m[2m)[22m[33m 743[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m renders the navigation links [33m 595[2mms[22m[39m
 [32mΓ£ô[39m tests/unit/components/SpatialEditor.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[33m 1022[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m handles search input [33m 592[2mms[22m[39m
[90mstderr[2m | tests/unit/components/J
uryPanel.test.tsx[2m > 
[22m[2mJuryPanel Component[2m > 
[22m[2mopens voting dialog on click
[22m[39mWarning: Missing `Description` 
or `aria-describedby={undefined}` for 
{DialogContent}.

[90mstderr[2m | tests/unit/components/J
uryPanel.test.tsx[2m > 
[22m[2mJuryPanel Component[2m > 
[22m[2mallows voting workflow
[22m[39mWarning: Missing `Description` 
or `aria-describedby={undefined}` for 
{DialogContent}.

 [32mΓ£ô[39m tests/unit/db/counterAudit.test.ts [2m([22m[2m2 tests[22m[2m)[22m[33m 4783[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m returns no mismatches in current database [33m 356[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m stays consistent after mutations [33m 1873[2mms[22m[39m
 [32mΓ£ô[39m tests/unit/components/HomeContentFilter.test.tsx [2m([22m[2m18 tests[22m[2m)[22m[33m 3299[2mms[22m[39m
       [33m[2mΓ£ô[22m[39m should filter posts by title [33m 539[2mms[22m[39m
       [33m[2mΓ£ô[22m[39m should filter posts by content [33m 361[2mms[22m[39m
       [33m[2mΓ£ô[22m[39m should show no results message when filter matches nothing [33m 394[2mms[22m[39m
 [32mΓ£ô[39m tests/unit/lib/formatDate.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 54[2mms[22m[39m
 [32mΓ£ô[39m tests/unit/components/AuthForm.test.tsx [2m([22m[2m21 tests[22m[2m)[22m[33m 4686[2mms[22m[39m
       [33m[2mΓ£ô[22m[39m should render sign in button [33m 351[2mms[22m[39m
       [33m[2mΓ£ô[22m[39m should toggle password visibility [33m 357[2mms[22m[39m
       [33m[2mΓ£ô[22m[39m should call onSubmit with email and password [33m 761[2mms[22m[39m
       [33m[2mΓ£ô[22m[39m should show loading state during submission [33m 723[2mms[22m[39m
       [33m[2mΓ£ô[22m[39m should display error from onSubmit rejection [33m 695[2mms[22m[39m
       [33m[2mΓ£ô[22m[39m should handle non-Error rejections gracefully [33m 654[2mms[22m[39m
       [33m[2mΓ£ô[22m[39m should update email state on input [33m 324[2mms[22m[39m
[90mstderr[2m | tests/unit/components/J
uryPanel.test.tsx[2m > 
[22m[2mJuryPanel Component[2m > 
[22m[2mhandles submission error
[22m[39mWarning: Missing `Description` 
or `aria-describedby={undefined}` for 
{DialogContent}.

[90mstdout[2m | tests/unit/api/reports.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒôí add observability to secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ≡ƒöä add secrets lifecycle management: https://dotenvx.com/ops

[90mstdout[2m | tests/unit/lib/fingerprint.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒùé∩╕Å backup and recover secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ≡ƒ¢á∩╕Å  run anywhere with `dotenvx run -- yourcommand`

 [32mΓ£ô[39m tests/unit/api/reports.test.ts [2m([22m[2m25 tests[22m[2m)[22m[32m 32[2mms[22m[39m
[90mstdout[2m | tests/unit/lib/rateLimit.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ΓÜÖ∩╕Å  override existing env vars with { override: true }
[dotenv@17.2.3] injecting env (0) from .env -- tip: ≡ƒöÉ prevent committing .env to code: https://dotenvx.com/precommit

 [32mΓ£ô[39m tests/unit/lib/fingerprint.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 27[2mms[22m[39m
 [32mΓ£ô[39m tests/unit/lib/rateLimit.test.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 21[2mms[22m[39m
[90mstdout[2m | tests/unit/api/auth.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒæÑ sync secrets across teammates & machines: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: Γ£à audit secrets and track compliance: https://dotenvx.com/ops

[90mstdout[2m | tests/unit/lib/utils.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒöÉ encrypt with Dotenvx: https://dotenvx.com
[dotenv@17.2.3] injecting env (0) from .env -- tip: ΓÜÖ∩╕Å  enable debug logging with { debug: true }

 [32mΓ£ô[39m tests/unit/api/auth.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 20[2mms[22m[39m
 [32mΓ£ô[39m tests/unit/lib/utils.test.ts [2m([22m[2m27 tests[22m[2m)[22m[32m 25[2mms[22m[39m
[90mstdout[2m | tests/unit/api/comments.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒöæ add access controls to secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ≡ƒùé∩╕Å backup and recover secrets: https://dotenvx.com/ops

[90mstdout[2m | tests/unit/lib/apiUtils.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒöä add secrets lifecycle management: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: Γ£à audit secrets and track compliance: https://dotenvx.com/ops

[90mstdout[2m | tests/unit/api/posts.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: ≡ƒöæ add access controls to secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ≡ƒöä add secrets lifecycle management: https://dotenvx.com/ops

 [32mΓ£ô[39m tests/unit/api/comments.test.ts [2m([22m[2m23 tests[22m[2m)[22m[32m 24[2mms[22m[39m
 [32mΓ£ô[39m tests/unit/api/posts.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 25[2mms[22m[39m
 [32mΓ£ô[39m tests/unit/lib/apiUtils.test.ts [2m([22m[2m18 tests[22m[2m)[22m[32m 26[2mms[22m[39m
[90mstdout[2m | tests/unit/lib/gamification.test.ts
[22m[39m[dotenv@17.2.3] injecting env (21) from .env.local -- tip: Γ£à audit secrets and track compliance: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ΓÜÖ∩╕Å  write to custom object with { processEnv: myObject }

 [32mΓ£ô[39m tests/unit/lib/gamification.test.ts [2m([22m[2m34 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mΓ£ô[39m tests/unit/components/JuryPanel.test.tsx [2m([22m[2m6 tests[22m[2m)[22m[33m 7186[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m opens voting dialog on click [33m 588[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m allows voting workflow [33m 3779[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m handles submission error [33m 2636[2mms[22m[39m

[2m Test Files [22m [1m[32m24 passed[39m[22m[90m (24)[39m
[2m      Tests [22m [1m[32m397 passed[39m[22m[90m (397)[39m
[2m   Start at [22m 01:45:30
[2m   Duration [22m 20.80s[2m (transform 8.27s, setup 19.56s, import 24.98s, tests 25.28s, environment 153.78s)[22m

