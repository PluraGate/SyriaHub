node.exe : [baseline-browser-mapping] The data in this 
module is over two months old.  To ensure accurate 
Baseline data, please update: `npm i 
baseline-browser-mapping@latest -D`
At C:\Program Files\nodejs\npx.ps1:29 char:3
+   & $NODE_EXE $NPX_CLI_JS $args
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: ([baseline-br 
   ows...ping@latest -D`:String) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError
 
[{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\about\\ethics\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\about\\faq\\FaqPageClient.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\about\\faq\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\about\\gamification\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\about\\guide\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\about\\methodology\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\about\\mission\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\about\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\about\\privacy\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\about\\roles\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\about\\terms\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\achievements\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'supabase'. Either include it or remove the dependency array.","line":126,"column":8,"nodeType":"ArrayExpression","endLine":126,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [supabase]","fix":{"range":[3531,3533],"text":"[supabase]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { useTranslations } from 'next-intl'\r\nimport { Navbar } from '@/components/Navbar'\r\nimport { Footer } from '@/components/Footer'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { UserProgressCard } from '@/components/UserProgressCard'\r\nimport {\r\n    Trophy,\r\n    Star,\r\n    Medal,\r\n    Crown,\r\n    Award,\r\n    Users,\r\n    Flame,\r\n    Zap,\r\n    BookOpen,\r\n    MessageCircle,\r\n    ThumbsUp,\r\n    UserPlus,\r\n    ClipboardCheck,\r\n    UserCheck,\r\n    Rocket,\r\n    Lock,\r\n    CheckCircle2,\r\n    Loader2\r\n} from 'lucide-react'\r\nimport { cn } from '@/lib/utils'\r\n\r\ninterface Achievement {\r\n    id: string\r\n    name: string\r\n    description: string\r\n    icon: string\r\n    category: string\r\n    xp_reward: number\r\n    unlocked_at?: string\r\n    criteria?: {\r\n        type: string\r\n        threshold?: number\r\n    }\r\n}\r\n\r\ninterface AchievementsData {\r\n    unlocked: Achievement[]\r\n    available: Achievement[]\r\n    total_count: number\r\n    unlocked_count: number\r\n    completion_percentage: number\r\n}\r\n\r\nconst iconMap: Record<string, React.ComponentType<{ className?: string }>> = {\r\n    'footprints': Star,\r\n    'pen-tool': BookOpen,\r\n    'book-open': BookOpen,\r\n    'lightbulb': Star,\r\n    'hand-helping': Users,\r\n    'award': Award,\r\n    'trophy': Trophy,\r\n    'message-circle': MessageCircle,\r\n    'users': Users,\r\n    'star': Star,\r\n    'medal': Medal,\r\n    'crown': Crown,\r\n    'thumbs-up': ThumbsUp,\r\n    'trending-up': Zap,\r\n    'flame': Flame,\r\n    'zap': Zap,\r\n    'clipboard-check': ClipboardCheck,\r\n    'user-check': UserCheck,\r\n    'rocket': Rocket,\r\n    'user-plus': UserPlus,\r\n}\r\n\r\nconst categoryColors: Record<string, { bg: string, text: string, border: string }> = {\r\n    contribution: {\r\n        bg: 'bg-blue-50 dark:bg-blue-900/20',\r\n        text: 'text-blue-600 dark:text-blue-400',\r\n        border: 'border-blue-200 dark:border-blue-800'\r\n    },\r\n    community: {\r\n        bg: 'bg-green-50 dark:bg-green-900/20',\r\n        text: 'text-green-600 dark:text-green-400',\r\n        border: 'border-green-200 dark:border-green-800'\r\n    },\r\n    expertise: {\r\n        bg: 'bg-purple-50 dark:bg-purple-900/20',\r\n        text: 'text-purple-600 dark:text-purple-400',\r\n        border: 'border-purple-200 dark:border-purple-800'\r\n    },\r\n    special: {\r\n        bg: 'bg-amber-50 dark:bg-amber-900/20',\r\n        text: 'text-amber-600 dark:text-amber-400',\r\n        border: 'border-amber-200 dark:border-amber-800'\r\n    },\r\n}\r\n\r\nexport default function AchievementsPage() {\r\n    const [user, setUser] = useState<any>(null)\r\n    const [achievements, setAchievements] = useState<AchievementsData | null>(null)\r\n    const [loading, setLoading] = useState(true)\r\n    const [checking, setChecking] = useState(false)\r\n    const [activeTab, setActiveTab] = useState<'unlocked' | 'available'>('unlocked')\r\n    const supabase = createClient()\r\n    const t = useTranslations('Gamification')\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            const { data: { user } } = await supabase.auth.getUser()\r\n            setUser(user)\r\n\r\n            if (user) {\r\n                // Fetch achievements\r\n                const { data, error } = await supabase.rpc('get_user_achievements', {\r\n                    p_user_id: user.id\r\n                })\r\n\r\n                if (!error && data?.success) {\r\n                    setAchievements(data)\r\n                }\r\n            }\r\n            setLoading(false)\r\n        }\r\n        fetchData()\r\n    }, [])\r\n\r\n    const checkForNewAchievements = async () => {\r\n        if (!user) return\r\n        setChecking(true)\r\n\r\n        const { data, error } = await supabase.rpc('check_and_unlock_achievements', {\r\n            p_user_id: user.id\r\n        })\r\n\r\n        if (!error && data?.success) {\r\n            // Refresh achievements list\r\n            const { data: refreshed } = await supabase.rpc('get_user_achievements', {\r\n                p_user_id: user.id\r\n            })\r\n            if (refreshed?.success) {\r\n                setAchievements(refreshed)\r\n            }\r\n        }\r\n        setChecking(false)\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"min-h-screen bg-background dark:bg-dark-bg flex flex-col\">\r\n                <Navbar user={user} />\r\n                <main className=\"flex-1 flex items-center justify-center\">\r\n                    <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\r\n                </main>\r\n                <Footer />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    if (!user) {\r\n        return (\r\n            <div className=\"min-h-screen bg-background dark:bg-dark-bg flex flex-col\">\r\n                <Navbar user={user} />\r\n                <main className=\"flex-1 container-custom py-12\">\r\n                    <div className=\"text-center py-16\">\r\n                        <Lock className=\"w-16 h-16 mx-auto text-text-light dark:text-dark-text-muted mb-4\" />\r\n                        <h1 className=\"text-2xl font-bold text-text dark:text-dark-text mb-2\">\r\n                            {t('signInToView')}\r\n                        </h1>\r\n                        <p className=\"text-text-light dark:text-dark-text-muted\">\r\n                            {t('signInDescription')}\r\n                        </p>\r\n                    </div>\r\n                </main>\r\n                <Footer />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-background dark:bg-dark-bg flex flex-col\">\r\n            <Navbar user={user} />\r\n\r\n            <main className=\"flex-1 container-custom py-8\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between mb-8\">\r\n                    <div>\r\n                        <h1 className=\"text-3xl font-bold text-text dark:text-dark-text flex items-center gap-3\">\r\n                            <Trophy className=\"w-8 h-8 text-primary\" />\r\n                            {t('pageTitle')}\r\n                        </h1>\r\n                        <p className=\"text-text-light dark:text-dark-text-muted mt-1\">\r\n                            {t('pageSubtitle')}\r\n                        </p>\r\n                    </div>\r\n                    <button\r\n                        onClick={checkForNewAchievements}\r\n                        disabled={checking}\r\n                        className=\"px-4 py-2 bg-primary text-white rounded-lg font-medium hover:bg-primary-dark transition-colors disabled:opacity-50 flex items-center gap-2\"\r\n                    >\r\n                        {checking ? (\r\n                            <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                        ) : (\r\n                            <Zap className=\"w-4 h-4\" />\r\n                        )}\r\n                        {t('checkForNew')}\r\n                    </button>\r\n                </div>\r\n\r\n                <div className=\"grid lg:grid-cols-3 gap-8\">\r\n                    {/* Left Column - Progress Card */}\r\n                    <div className=\"lg:col-span-1\">\r\n                        <UserProgressCard userId={user.id} />\r\n\r\n                        {/* Stats Summary */}\r\n                        {achievements && (\r\n                            <div className=\"mt-6 p-6 bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border\">\r\n                                <h3 className=\"font-semibold text-text dark:text-dark-text mb-4\">\r\n                                    {t('achievementProgress')}\r\n                                </h3>\r\n                                <div className=\"space-y-4\">\r\n                                    <div>\r\n                                        <div className=\"flex justify-between text-sm mb-1\">\r\n                                            <span className=\"text-text-light dark:text-dark-text-muted\">{t('completion')}</span>\r\n                                            <span className=\"font-medium text-text dark:text-dark-text\">\r\n                                                {achievements.unlocked_count}/{achievements.total_count}\r\n                                            </span>\r\n                                        </div>\r\n                                        <div className=\"h-2 bg-gray-100 dark:bg-dark-border rounded-full overflow-hidden\">\r\n                                            <div\r\n                                                className=\"h-full bg-gradient-to-r from-primary to-secondary rounded-full transition-all\"\r\n                                                style={{ width: `${achievements.completion_percentage}%` }}\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-2 gap-4 pt-2\">\r\n                                        <div className=\"text-center p-3 bg-gray-50 dark:bg-dark-bg rounded-lg\">\r\n                                            <p className=\"text-2xl font-bold text-primary\">{achievements.unlocked_count}</p>\r\n                                            <p className=\"text-xs text-text-light dark:text-dark-text-muted\">{t('unlocked')}</p>\r\n                                        </div>\r\n                                        <div className=\"text-center p-3 bg-gray-50 dark:bg-dark-bg rounded-lg\">\r\n                                            <p className=\"text-2xl font-bold text-text dark:text-dark-text\">\r\n                                                {achievements.total_count - achievements.unlocked_count}\r\n                                            </p>\r\n                                            <p className=\"text-xs text-text-light dark:text-dark-text-muted\">{t('remaining')}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Right Column - Achievements Grid */}\r\n                    <div className=\"lg:col-span-2\">\r\n                        {/* Tabs */}\r\n                        <div className=\"flex gap-2 mb-6\">\r\n                            <button\r\n                                onClick={() => setActiveTab('unlocked')}\r\n                                className={cn(\r\n                                    \"px-4 py-2 rounded-lg font-medium transition-colors\",\r\n                                    activeTab === 'unlocked'\r\n                                        ? \"bg-primary text-white\"\r\n                                        : \"bg-gray-100 dark:bg-dark-surface text-text dark:text-dark-text hover:bg-gray-200 dark:hover:bg-dark-border\"\r\n                                )}\r\n                            >\r\n                                <CheckCircle2 className=\"w-4 h-4 inline mr-2\" />\r\n                                {t('unlocked')} ({achievements?.unlocked?.length || 0})\r\n                            </button>\r\n                            <button\r\n                                onClick={() => setActiveTab('available')}\r\n                                className={cn(\r\n                                    \"px-4 py-2 rounded-lg font-medium transition-colors\",\r\n                                    activeTab === 'available'\r\n                                        ? \"bg-primary text-white\"\r\n                                        : \"bg-gray-100 dark:bg-dark-surface text-text dark:text-dark-text hover:bg-gray-200 dark:hover:bg-dark-border\"\r\n                                )}\r\n                            >\r\n                                <Lock className=\"w-4 h-4 inline mr-2\" />\r\n                                {t('available')} ({achievements?.available?.length || 0})\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Achievement Cards */}\r\n                        <div className=\"grid gap-4 md:grid-cols-2\">\r\n                            {activeTab === 'unlocked' && achievements?.unlocked?.map((achievement) => {\r\n                                const Icon = iconMap[achievement.icon] || Award\r\n                                const colors = categoryColors[achievement.category] || categoryColors.special\r\n\r\n                                return (\r\n                                    <div\r\n                                        key={achievement.id}\r\n                                        className={cn(\r\n                                            \"p-4 rounded-xl border-2 transition-all\",\r\n                                            colors.bg,\r\n                                            colors.border\r\n                                        )}\r\n                                    >\r\n                                        <div className=\"flex items-start gap-3\">\r\n                                            <div className={cn(\r\n                                                \"p-3 rounded-xl\",\r\n                                                colors.bg\r\n                                            )}>\r\n                                                <Icon className={cn(\"w-6 h-6\", colors.text)} />\r\n                                            </div>\r\n                                            <div className=\"flex-1\">\r\n                                                <div className=\"flex items-center gap-2\">\r\n                                                    <h3 className=\"font-bold text-text dark:text-dark-text\">\r\n                                                        {achievement.name}\r\n                                                    </h3>\r\n                                                    <CheckCircle2 className=\"w-4 h-4 text-green-500\" />\r\n                                                </div>\r\n                                                <p className=\"text-sm text-text-light dark:text-dark-text-muted mt-1\">\r\n                                                    {achievement.description}\r\n                                                </p>\r\n                                                <div className=\"flex items-center gap-3 mt-2\">\r\n                                                    <span className=\"text-xs font-medium px-2 py-0.5 rounded-full bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400\">\r\n                                                        +{achievement.xp_reward} XP\r\n                                                    </span>\r\n                                                    {achievement.unlocked_at && (\r\n                                                        <span className=\"text-xs text-text-light dark:text-dark-text-muted\">\r\n                                                            {new Date(achievement.unlocked_at).toLocaleDateString()}\r\n                                                        </span>\r\n                                                    )}\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )\r\n                            })}\r\n\r\n                            {activeTab === 'available' && achievements?.available?.map((achievement) => {\r\n                                const Icon = iconMap[achievement.icon] || Award\r\n                                const colors = categoryColors[achievement.category] || categoryColors.special\r\n\r\n                                return (\r\n                                    <div\r\n                                        key={achievement.id}\r\n                                        className=\"p-4 rounded-xl border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-surface opacity-75 hover:opacity-100 transition-opacity\"\r\n                                    >\r\n                                        <div className=\"flex items-start gap-3\">\r\n                                            <div className=\"p-3 rounded-xl bg-gray-100 dark:bg-dark-border\">\r\n                                                <Icon className=\"w-6 h-6 text-text-light dark:text-dark-text-muted\" />\r\n                                            </div>\r\n                                            <div className=\"flex-1\">\r\n                                                <div className=\"flex items-center gap-2\">\r\n                                                    <h3 className=\"font-bold text-text dark:text-dark-text\">\r\n                                                        {achievement.name}\r\n                                                    </h3>\r\n                                                    <Lock className=\"w-4 h-4 text-text-light dark:text-dark-text-muted\" />\r\n                                                </div>\r\n                                                <p className=\"text-sm text-text-light dark:text-dark-text-muted mt-1\">\r\n                                                    {achievement.description}\r\n                                                </p>\r\n                                                <div className=\"flex items-center gap-3 mt-2\">\r\n                                                    <span className={cn(\r\n                                                        \"text-xs font-medium px-2 py-0.5 rounded-full capitalize\",\r\n                                                        colors.bg,\r\n                                                        colors.text\r\n                                                    )}>\r\n                                                        {achievement.category}\r\n                                                    </span>\r\n                                                    <span className=\"text-xs font-medium text-amber-600 dark:text-amber-400\">\r\n                                                        +{achievement.xp_reward} XP\r\n                                                    </span>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )\r\n                            })}\r\n\r\n                            {activeTab === 'unlocked' && (!achievements?.unlocked || achievements.unlocked.length === 0) && (\r\n                                <div className=\"col-span-2 text-center py-12\">\r\n                                    <Trophy className=\"w-16 h-16 mx-auto text-text-light dark:text-dark-text-muted mb-4 opacity-50\" />\r\n                                    <h3 className=\"text-lg font-medium text-text dark:text-dark-text mb-2\">\r\n                                        {t('noAchievements')}\r\n                                    </h3>\r\n                                    <p className=\"text-text-light dark:text-dark-text-muted\">\r\n                                        {t('noAchievementsDesc')}\r\n                                    </p>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </main>\r\n\r\n            <Footer />\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\admin\\AdminDashboardClient.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\admin\\analytics\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\admin\\appeals\\page.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchAppeals'. Either include it or remove the dependency array.","line":69,"column":8,"nodeType":"ArrayExpression","endLine":69,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [fetchAppeals, statusFilter]","fix":{"range":[2110,2124],"text":"[fetchAppeals, statusFilter]"}}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchAppeals'. Either include it or remove the dependency array.","line":86,"column":8,"nodeType":"ArrayExpression","endLine":86,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [fetchAppeals, supabase]","fix":{"range":[2632,2642],"text":"[fetchAppeals, supabase]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\admin\\audit\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\admin\\content\\page.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchPosts'. Either include it or remove the dependency array.","line":77,"column":8,"nodeType":"ArrayExpression","endLine":77,"endColumn":40,"suggestions":[{"desc":"Update the dependencies array to be: [statusFilter, typeFilter, page, fetchPosts]","fix":{"range":[2545,2577],"text":"[statusFilter, typeFilter, page, fetchPosts]"}}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchPosts'. Either include it or remove the dependency array.","line":97,"column":8,"nodeType":"ArrayExpression","endLine":97,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [fetchPosts, supabase]","fix":{"range":[3188,3198],"text":"[fetchPosts, supabase]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\admin\\coordination\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\admin\\feedback\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\admin\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\admin\\reports\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\admin\\search-analytics\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\admin\\tags\\page.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchUnverifiedTags' and 'fetchUsedColors'. Either include them or remove the dependency array.","line":65,"column":8,"nodeType":"ArrayExpression","endLine":65,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchUnverifiedTags, fetchUsedColors]","fix":{"range":[2446,2448],"text":"[fetchUnverifiedTags, fetchUsedColors]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\admin\\users\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\admin\\waitlist\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\analytics\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\auth\\callback\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\auth\\login\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":137,"column":20,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[5858,5898],"text":"\r\n                Don&apos;t have an account?"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[5858,5898],"text":"\r\n                Don&lsquo;t have an account?"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[5858,5898],"text":"\r\n                Don&#39;t have an account?"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[5858,5898],"text":"\r\n                Don&rsquo;t have an account?"},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import Link from 'next/link'\r\nimport { createClient } from '@/lib/supabase/server'\r\nimport { redirect } from 'next/navigation'\r\nimport { Navbar } from '@/components/Navbar'\r\nimport { Footer } from '@/components/Footer'\r\nimport { AlertCircle, BookOpen, Users, Sparkles } from 'lucide-react'\r\n\r\nexport default async function LoginPage({\r\n  searchParams,\r\n}: {\r\n  searchParams: Promise<{ error?: string }>\r\n}) {\r\n  const params = await searchParams\r\n  const supabase = await createClient()\r\n  const { data: { user } } = await supabase.auth.getUser()\r\n\r\n  if (user) {\r\n    redirect('/feed')\r\n  }\r\n\r\n  async function handleLogin(formData: FormData) {\r\n    'use server'\r\n\r\n    const email = formData.get('email') as string\r\n    const password = formData.get('password') as string\r\n\r\n    if (!email || !password) {\r\n      redirect('/auth/login?error=Email and password are required')\r\n    }\r\n\r\n    const supabase = await createClient()\r\n\r\n    const { error } = await supabase.auth.signInWithPassword({\r\n      email,\r\n      password,\r\n    })\r\n\r\n    if (error) {\r\n      console.error('Login error:', error)\r\n      redirect(`/auth/login?error=${error.message}`)\r\n    }\r\n\r\n    redirect('/feed')\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex flex-col bg-background dark:bg-dark-bg\">\r\n      <Navbar user={null} />\r\n\r\n      <main className=\"flex-1 flex\">\r\n        {/* Left - Branding Panel */}\r\n        <div className=\"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-primary via-primary-dark to-primary relative overflow-hidden\">\r\n          <div className=\"absolute inset-0 opacity-10\">\r\n            <div className=\"absolute top-20 right-20 w-72 h-72 bg-white rounded-full blur-3xl\" />\r\n            <div className=\"absolute bottom-20 left-20 w-96 h-96 bg-secondary rounded-full blur-3xl\" />\r\n          </div>\r\n\r\n          <div className=\"relative z-10 flex flex-col justify-center px-16 py-12\">\r\n            <Link href=\"/\" className=\"flex items-center gap-3 mb-12\">\r\n              <div className=\"w-12 h-12 bg-white/20 backdrop-blur rounded-xl flex items-center justify-center\">\r\n                <span className=\"text-white font-bold text-2xl\">S</span>\r\n              </div>\r\n              <span className=\"font-bold text-2xl text-white\">SyriaHub</span>\r\n            </Link>\r\n\r\n            <h1 className=\"text-4xl font-bold text-white mb-4\">\r\n              Welcome Back\r\n            </h1>\r\n            <p className=\"text-xl text-white/80 mb-12 max-w-md\">\r\n              Continue your research journey and connect with your community.\r\n            </p>\r\n\r\n            <div className=\"space-y-6\">\r\n              <div className=\"flex items-start gap-4\">\r\n                <div className=\"w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center flex-shrink-0\">\r\n                  <BookOpen className=\"w-5 h-5 text-white\" />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-semibold text-white\">Your Research Feed</h3>\r\n                  <p className=\"text-sm text-white/70\">See updates from researchers you follow</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-start gap-4\">\r\n                <div className=\"w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center flex-shrink-0\">\r\n                  <Users className=\"w-5 h-5 text-white\" />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-semibold text-white\">Group Discussions</h3>\r\n                  <p className=\"text-sm text-white/70\">Participate in collaborative research</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-start gap-4\">\r\n                <div className=\"w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center flex-shrink-0\">\r\n                  <Sparkles className=\"w-5 h-5 text-white\" />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-semibold text-white\">New Insights</h3>\r\n                  <p className=\"text-sm text-white/70\">Discover trending research in your field</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Right - Form Panel */}\r\n        <div className=\"flex-1 flex items-center justify-center px-6 py-12\">\r\n          <div className=\"w-full max-w-md\">\r\n            {/* Mobile Logo */}\r\n            <div className=\"text-center mb-8 lg:hidden\">\r\n              <Link href=\"/\" className=\"inline-flex items-center gap-2\">\r\n                <div className=\"w-10 h-10 bg-gradient-to-br from-primary to-secondary rounded-xl flex items-center justify-center\">\r\n                  <span className=\"text-white font-bold text-xl\">S</span>\r\n                </div>\r\n                <span className=\"font-bold text-2xl text-text dark:text-dark-text\">SyriaHub</span>\r\n              </Link>\r\n            </div>\r\n\r\n            {/* Error Message */}\r\n            {params.error && (\r\n              <div className=\"mb-6 p-4 rounded-2xl bg-accent/10 border border-accent/20\">\r\n                <div className=\"flex items-start gap-3\">\r\n                  <AlertCircle className=\"w-5 h-5 text-accent mt-0.5\" />\r\n                  <div>\r\n                    <h3 className=\"font-semibold text-text dark:text-dark-text\">Error</h3>\r\n                    <p className=\"text-sm text-text-light dark:text-dark-text-muted mt-1\">{params.error}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Form Card */}\r\n            <div className=\"bg-white dark:bg-dark-surface rounded-2xl border border-gray-200 dark:border-dark-border p-8\">\r\n              <h2 className=\"text-2xl font-bold text-text dark:text-dark-text mb-2\">\r\n                Sign in to your account\r\n              </h2>\r\n              <p className=\"text-text-light dark:text-dark-text-muted mb-8\">\r\n                Don't have an account?{' '}\r\n                <Link href=\"/auth/signup\" className=\"font-semibold text-primary hover:text-primary-dark transition-colors\">\r\n                  Sign up\r\n                </Link>\r\n              </p>\r\n\r\n              <form className=\"space-y-5\" action={handleLogin}>\r\n                <div>\r\n                  <label htmlFor=\"email\" className=\"block text-sm font-semibold text-text dark:text-dark-text mb-2\">\r\n                    Email address\r\n                  </label>\r\n                  <input\r\n                    id=\"email\"\r\n                    name=\"email\"\r\n                    type=\"email\"\r\n                    autoComplete=\"email\"\r\n                    required\r\n                    className=\"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-dark-border bg-gray-50 dark:bg-dark-bg text-text dark:text-dark-text placeholder:text-text-muted focus:border-primary focus:ring-2 focus:ring-primary/20 focus:bg-white dark:focus:bg-dark-surface transition-all\"\r\n                    placeholder=\"you@example.com\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label htmlFor=\"password\" className=\"block text-sm font-semibold text-text dark:text-dark-text mb-2\">\r\n                    Password\r\n                  </label>\r\n                  <input\r\n                    id=\"password\"\r\n                    name=\"password\"\r\n                    type=\"password\"\r\n                    autoComplete=\"current-password\"\r\n                    required\r\n                    className=\"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-dark-border bg-gray-50 dark:bg-dark-bg text-text dark:text-dark-text placeholder:text-text-muted focus:border-primary focus:ring-2 focus:ring-primary/20 focus:bg-white dark:focus:bg-dark-surface transition-all\"\r\n                    placeholder=\"Enter your password\"\r\n                  />\r\n                </div>\r\n\r\n                <button\r\n                  type=\"submit\"\r\n                  className=\"w-full py-3.5 bg-primary hover:bg-primary-dark text-white font-semibold rounded-xl transition-all shadow-sm hover:shadow-md\"\r\n                >\r\n                  Sign In\r\n                </button>\r\n              </form>\r\n\r\n              <div className=\"mt-6 text-center\">\r\n                <Link href=\"/auth/forgot-password\" className=\"text-sm text-text-light dark:text-dark-text-muted hover:text-primary transition-colors\">\r\n                  Forgot your password?\r\n                </Link>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </main>\r\n\r\n      <Footer />\r\n    </div>\r\n  )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\auth\\signout\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\auth\\signup\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":189,"column":24,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[7308,7353],"text":"\r\n                    You&apos;ve been invited by "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[7308,7353],"text":"\r\n                    You&lsquo;ve been invited by "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[7308,7353],"text":"\r\n                    You&#39;ve been invited by "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[7308,7353],"text":"\r\n                    You&rsquo;ve been invited by "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":203,"column":25,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[8018,8147],"text":"\r\n                      We&apos;ve sent you a confirmation link. Please check your inbox to verify your account.\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[8018,8147],"text":"\r\n                      We&lsquo;ve sent you a confirmation link. Please check your inbox to verify your account.\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[8018,8147],"text":"\r\n                      We&#39;ve sent you a confirmation link. Please check your inbox to verify your account.\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[8018,8147],"text":"\r\n                      We&rsquo;ve sent you a confirmation link. Please check your inbox to verify your account.\r\n                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":251,"column":24,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[10521,10561],"text":"\r\n                    Don&apos;t have a code?"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[10521,10561],"text":"\r\n                    Don&lsquo;t have a code?"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[10521,10561],"text":"\r\n                    Don&#39;t have a code?"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[10521,10561],"text":"\r\n                    Don&rsquo;t have a code?"},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import Link from 'next/link'\r\nimport { createClient } from '@/lib/supabase/server'\r\nimport { redirect } from 'next/navigation'\r\nimport { Navbar } from '@/components/Navbar'\r\nimport { Footer } from '@/components/Footer'\r\nimport { CheckCircle2, AlertCircle, Sparkles, Users, BookOpen, Ticket, Gift } from 'lucide-react'\r\n\r\nexport default async function SignupPage({\r\n  searchParams,\r\n}: {\r\n  searchParams: Promise<{ error?: string; success?: string; code?: string }>\r\n}) {\r\n  const params = await searchParams\r\n  const supabase = await createClient()\r\n  const { data: { user } } = await supabase.auth.getUser()\r\n\r\n  if (user) {\r\n    redirect('/feed')\r\n  }\r\n\r\n  // Pre-validate invite code if provided in URL\r\n  let preValidatedCode = ''\r\n  let inviterName = ''\r\n  if (params.code) {\r\n    const { data } = await supabase.rpc('validate_invite_code', {\r\n      p_code: params.code.toUpperCase().trim(),\r\n    })\r\n    if (data?.valid) {\r\n      preValidatedCode = params.code.toUpperCase().trim()\r\n      // Get inviter name\r\n      if (data.inviter_id) {\r\n        const { data: inviter } = await supabase\r\n          .from('users')\r\n          .select('name, email')\r\n          .eq('id', data.inviter_id)\r\n          .single()\r\n        if (inviter) {\r\n          inviterName = inviter.name || inviter.email?.split('@')[0] || ''\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  async function handleSignup(formData: FormData) {\r\n    'use server'\r\n\r\n    const email = formData.get('email') as string\r\n    const password = formData.get('password') as string\r\n    const inviteCode = formData.get('inviteCode') as string\r\n\r\n    if (!email || !password) {\r\n      redirect('/auth/signup?error=Email and password are required')\r\n    }\r\n\r\n    if (!inviteCode) {\r\n      redirect('/auth/signup?error=Invite code is required')\r\n    }\r\n\r\n    if (password.length < 6) {\r\n      redirect('/auth/signup?error=Password must be at least 6 characters')\r\n    }\r\n\r\n    const supabase = await createClient()\r\n\r\n    // Validate invite code first\r\n    const { data: inviteValidation, error: inviteError } = await supabase.rpc('validate_invite_code', {\r\n      p_code: inviteCode.toUpperCase().trim(),\r\n    })\r\n\r\n    if (inviteError || !inviteValidation?.valid) {\r\n      redirect(`/auth/signup?error=${inviteValidation?.error || 'Invalid invite code'}`)\r\n    }\r\n\r\n    // Create the account\r\n    const { data, error } = await supabase.auth.signUp({\r\n      email,\r\n      password,\r\n      options: {\r\n        emailRedirectTo: `${process.env.NEXT_PUBLIC_SITE_URL || 'http://localhost:3000'}/auth/callback`,\r\n        data: {\r\n          invite_code: inviteCode.toUpperCase().trim(),\r\n          invited_by: inviteValidation.inviter_id,\r\n        },\r\n      },\r\n    })\r\n\r\n    if (error) {\r\n      console.error('Signup error:', error)\r\n      redirect(`/auth/signup?error=${error.message}&code=${inviteCode}`)\r\n    }\r\n\r\n    // Mark invite as used\r\n    if (data.user) {\r\n      await supabase.rpc('use_invite_code', {\r\n        p_code: inviteCode.toUpperCase().trim(),\r\n        p_user_id: data.user.id,\r\n      })\r\n    }\r\n\r\n    if (data.user && !data.session) {\r\n      redirect('/auth/signup?success=check-email')\r\n    }\r\n\r\n    if (data.session) {\r\n      redirect('/feed')\r\n    }\r\n\r\n    redirect('/auth/signup?success=check-email')\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex flex-col bg-background dark:bg-dark-bg\">\r\n      <Navbar user={null} />\r\n\r\n      <main className=\"flex-1 flex\">\r\n        {/* Left - Branding Panel */}\r\n        <div className=\"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-primary via-primary-dark to-primary relative overflow-hidden\">\r\n          <div className=\"absolute inset-0 opacity-10\">\r\n            <div className=\"absolute top-20 right-20 w-72 h-72 bg-white rounded-full blur-3xl\" />\r\n            <div className=\"absolute bottom-20 left-20 w-96 h-96 bg-secondary rounded-full blur-3xl\" />\r\n          </div>\r\n\r\n          <div className=\"relative z-10 flex flex-col justify-center px-16 py-12\">\r\n            <Link href=\"/\" className=\"flex items-center gap-3 mb-12\">\r\n              <div className=\"w-12 h-12 bg-white/20 backdrop-blur rounded-xl flex items-center justify-center\">\r\n                <span className=\"text-white font-bold text-2xl\">S</span>\r\n              </div>\r\n              <span className=\"font-bold text-2xl text-white\">SyriaHub</span>\r\n            </Link>\r\n\r\n            <h1 className=\"text-4xl font-bold text-white mb-4\">\r\n              Join by Invitation\r\n            </h1>\r\n            <p className=\"text-xl text-white/80 mb-12 max-w-md\">\r\n              SyriaHub is currently invite-only to ensure a high-quality research community.\r\n            </p>\r\n\r\n            <div className=\"space-y-6\">\r\n              <div className=\"flex items-start gap-4\">\r\n                <div className=\"w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center flex-shrink-0\">\r\n                  <Ticket className=\"w-5 h-5 text-white\" />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-semibold text-white\">Invite Required</h3>\r\n                  <p className=\"text-sm text-white/70\">Get an invite from an existing member</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-start gap-4\">\r\n                <div className=\"w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center flex-shrink-0\">\r\n                  <Users className=\"w-5 h-5 text-white\" />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-semibold text-white\">Quality Community</h3>\r\n                  <p className=\"text-sm text-white/70\">Connect with verified researchers</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-start gap-4\">\r\n                <div className=\"w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center flex-shrink-0\">\r\n                  <Gift className=\"w-5 h-5 text-white\" />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-semibold text-white\">Pay It Forward</h3>\r\n                  <p className=\"text-sm text-white/70\">Each member can invite 5 colleagues</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Right - Form Panel */}\r\n        <div className=\"flex-1 flex items-center justify-center px-6 py-12\">\r\n          <div className=\"w-full max-w-md\">\r\n            {/* Mobile Logo */}\r\n            <div className=\"text-center mb-8 lg:hidden\">\r\n              <Link href=\"/\" className=\"inline-flex items-center gap-2\">\r\n                <div className=\"w-10 h-10 bg-gradient-to-br from-primary to-secondary rounded-xl flex items-center justify-center\">\r\n                  <span className=\"text-white font-bold text-xl\">S</span>\r\n                </div>\r\n                <span className=\"font-bold text-2xl text-text dark:text-dark-text\">SyriaHub</span>\r\n              </Link>\r\n            </div>\r\n\r\n            {/* Invited by banner */}\r\n            {inviterName && (\r\n              <div className=\"mb-6 p-4 rounded-2xl bg-primary/10 border border-primary/20\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <Gift className=\"w-5 h-5 text-primary\" />\r\n                  <p className=\"text-sm text-text dark:text-dark-text\">\r\n                    You've been invited by <strong>{inviterName}</strong>\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Success Message */}\r\n            {params.success === 'check-email' && (\r\n              <div className=\"mb-6 p-4 rounded-2xl bg-secondary/10 border border-secondary/20\">\r\n                <div className=\"flex items-start gap-3\">\r\n                  <CheckCircle2 className=\"w-5 h-5 text-secondary-dark mt-0.5\" />\r\n                  <div>\r\n                    <h3 className=\"font-semibold text-text dark:text-dark-text\">Check your email</h3>\r\n                    <p className=\"text-sm text-text-light dark:text-dark-text-muted mt-1\">\r\n                      We've sent you a confirmation link. Please check your inbox to verify your account.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Error Message */}\r\n            {params.error && (\r\n              <div className=\"mb-6 p-4 rounded-2xl bg-accent/10 border border-accent/20\">\r\n                <div className=\"flex items-start gap-3\">\r\n                  <AlertCircle className=\"w-5 h-5 text-accent mt-0.5\" />\r\n                  <div>\r\n                    <h3 className=\"font-semibold text-text dark:text-dark-text\">Error</h3>\r\n                    <p className=\"text-sm text-text-light dark:text-dark-text-muted mt-1\">{params.error}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Form Card */}\r\n            <div className=\"bg-white dark:bg-dark-surface rounded-2xl border border-gray-200 dark:border-dark-border p-8\">\r\n              <h2 className=\"text-2xl font-bold text-text dark:text-dark-text mb-2\">\r\n                Create your account\r\n              </h2>\r\n              <p className=\"text-text-light dark:text-dark-text-muted mb-8\">\r\n                Already have an account?{' '}\r\n                <Link href=\"/auth/login\" className=\"font-semibold text-primary hover:text-primary-dark transition-colors\">\r\n                  Sign in\r\n                </Link>\r\n              </p>\r\n\r\n              <form className=\"space-y-5\" action={handleSignup}>\r\n                {/* Invite Code */}\r\n                <div>\r\n                  <label htmlFor=\"inviteCode\" className=\"block text-sm font-semibold text-text dark:text-dark-text mb-2\">\r\n                    Invite Code *\r\n                  </label>\r\n                  <input\r\n                    id=\"inviteCode\"\r\n                    name=\"inviteCode\"\r\n                    type=\"text\"\r\n                    required\r\n                    defaultValue={preValidatedCode}\r\n                    placeholder=\"XXXX-XXXX\"\r\n                    className=\"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-dark-border bg-gray-50 dark:bg-dark-bg text-text dark:text-dark-text placeholder:text-text-muted focus:border-primary focus:ring-2 focus:ring-primary/20 focus:bg-white dark:focus:bg-dark-surface transition-all uppercase tracking-widest font-mono text-center text-lg\"\r\n                  />\r\n                  <p className=\"text-xs text-text-light dark:text-dark-text-muted mt-1.5\">\r\n                    Don't have a code?{' '}\r\n                    <Link href=\"/waitlist\" className=\"text-primary hover:underline\">\r\n                      Join the waitlist\r\n                    </Link>\r\n                  </p>\r\n                </div>\r\n\r\n                <hr className=\"border-gray-200 dark:border-dark-border\" />\r\n\r\n                {/* Email */}\r\n                <div>\r\n                  <label htmlFor=\"email\" className=\"block text-sm font-semibold text-text dark:text-dark-text mb-2\">\r\n                    Email address\r\n                  </label>\r\n                  <input\r\n                    id=\"email\"\r\n                    name=\"email\"\r\n                    type=\"email\"\r\n                    autoComplete=\"email\"\r\n                    required\r\n                    className=\"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-dark-border bg-gray-50 dark:bg-dark-bg text-text dark:text-dark-text placeholder:text-text-muted focus:border-primary focus:ring-2 focus:ring-primary/20 focus:bg-white dark:focus:bg-dark-surface transition-all\"\r\n                    placeholder=\"you@example.com\"\r\n                  />\r\n                </div>\r\n\r\n                {/* Password */}\r\n                <div>\r\n                  <label htmlFor=\"password\" className=\"block text-sm font-semibold text-text dark:text-dark-text mb-2\">\r\n                    Password\r\n                  </label>\r\n                  <input\r\n                    id=\"password\"\r\n                    name=\"password\"\r\n                    type=\"password\"\r\n                    autoComplete=\"new-password\"\r\n                    required\r\n                    minLength={6}\r\n                    className=\"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-dark-border bg-gray-50 dark:bg-dark-bg text-text dark:text-dark-text placeholder:text-text-muted focus:border-primary focus:ring-2 focus:ring-primary/20 focus:bg-white dark:focus:bg-dark-surface transition-all\"\r\n                    placeholder=\"At least 6 characters\"\r\n                  />\r\n                </div>\r\n\r\n                <button\r\n                  type=\"submit\"\r\n                  className=\"w-full py-3.5 bg-primary hover:bg-primary-dark text-white font-semibold rounded-xl transition-all shadow-sm hover:shadow-md\"\r\n                >\r\n                  Create Account\r\n                </button>\r\n              </form>\r\n\r\n              <p className=\"mt-6 text-xs text-center text-text-light dark:text-dark-text-muted\">\r\n                By signing up, you agree to our terms of service and privacy policy.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </main>\r\n\r\n      <Footer />\r\n    </div>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\editor\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\events\\[id]\\edit\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\events\\[id]\\page.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":88,"column":45,"nodeType":"JSXOpeningElement","endLine":92,"endColumn":47}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from '@/lib/supabase/server'\r\nimport { Navbar } from '@/components/Navbar'\r\nimport { Footer } from '@/components/Footer'\r\nimport { CommentsSection } from '@/components/CommentsSection'\r\nimport { RsvpButton } from '@/components/RsvpButton'\r\nimport { notFound } from 'next/navigation'\r\nimport { Calendar, MapPin, Clock, Link as LinkIcon, Users } from 'lucide-react'\r\nimport { format } from 'date-fns'\r\nimport { TagChip } from '@/components/TagChip'\r\nimport { ViewTracker } from '@/components/ViewTracker'\r\nimport { RejectionBanner } from '@/components/RejectionBanner'\r\nimport { EventActions } from '@/components/EventActions'\r\nimport { getAvatarGradient, getInitials } from '@/lib/utils'\r\nimport Link from 'next/link'\r\n\r\nexport default async function EventDetailsPage({ params }: { params: Promise<{ id: string }> }) {\r\n    const { id } = await params\r\n    const supabase = await createClient()\r\n    const { data: { user } } = await supabase.auth.getUser()\r\n\r\n    // Fetch Event\r\n    const { data: event } = await supabase\r\n        .from('posts')\r\n        .select(`\r\n      *,\r\n      author:users!author_id(name, email)\r\n    `)\r\n        .eq('id', id)\r\n        .single()\r\n\r\n    if (!event || event.content_type !== 'event') notFound()\r\n    // Fetch RSVPs\r\n    const { data: rsvps } = await supabase\r\n        .from('event_rsvps')\r\n        .select(`\r\n      status,\r\n      user:users(name, email, id)\r\n    `)\r\n        .eq('event_id', id)\r\n\r\n    const going = rsvps?.filter(r => r.status === 'going') || []\r\n    const maybe = rsvps?.filter(r => r.status === 'maybe') || []\r\n\r\n    // Get current user's RSVP status\r\n    const userRsvp = rsvps?.find(r => {\r\n        const u = Array.isArray(r.user) ? r.user[0] : r.user\r\n        return u?.id === user?.id\r\n    })?.status as 'going' | 'maybe' | 'not_going' | undefined\r\n\r\n    const startDate = new Date(event.metadata.start_time)\r\n    const endDate = event.metadata.end_time ? new Date(event.metadata.end_time) : null\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-background dark:bg-dark-bg flex flex-col\">\r\n            <Navbar user={user} />\r\n\r\n            <main className=\"flex-1 container-custom py-12\">\r\n                <div className=\"grid gap-8 lg:grid-cols-[1fr_350px]\">\r\n\r\n                    {/* Main Content */}\r\n                    <div className=\"space-y-8\">\r\n                        {/* Rejection Banner - shown only to event authors */}\r\n                        <RejectionBanner\r\n                            postId={event.id}\r\n                            postTitle={event.title}\r\n                            rejectionReason={event.rejection_reason}\r\n                            approvalStatus={event.approval_status || 'approved'}\r\n                            isAuthor={user?.id === event.author_id}\r\n                            contentType=\"event\"\r\n                        />\r\n\r\n                        <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border overflow-hidden\">\r\n                            {/* Status Banner */}\r\n                            {event.metadata.status && event.metadata.status !== 'scheduled' && (\r\n                                <div className={`w-full py-3 px-6 text-center font-bold uppercase tracking-wider text-sm ${event.metadata.status === 'cancelled'\r\n                                    ? 'bg-red-500 text-white'\r\n                                    : 'bg-amber-500 text-white'\r\n                                    }`}>\r\n                                    This event has been {event.metadata.status}\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Hero Banner Component */}\r\n                            <div className=\"relative h-48 md:h-80 bg-gradient-to-br from-primary/10 to-accent/10 flex items-center justify-center overflow-hidden\">\r\n                                {event.cover_image_url ? (\r\n                                    <>\r\n                                        <div className=\"absolute inset-0\">\r\n                                            <img\r\n                                                src={event.cover_image_url}\r\n                                                alt={event.title}\r\n                                                className=\"w-full h-full object-cover\"\r\n                                            />\r\n                                            <div className=\"absolute inset-0 bg-black/50\" />\r\n                                        </div>\r\n                                        <div className=\"relative z-10 text-center p-6 max-w-2xl\">\r\n                                            <h1 className=\"text-3xl md:text-4xl font-display font-bold text-white mb-4 drop-shadow-md\">\r\n                                                {event.title}\r\n                                            </h1>\r\n                                        </div>\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <div className=\"absolute inset-0 bg-grid-slate-900/[0.04] dark:bg-grid-slate-100/[0.04] [mask-image:linear-gradient(0deg,white,rgba(255,255,255,0.6))]\" />\r\n                                        <div className=\"relative z-10 text-center p-6 max-w-2xl\">\r\n                                            <h1 className=\"text-3xl md:text-4xl font-display font-bold text-text dark:text-dark-text mb-4 drop-shadow-sm\">\r\n                                                {event.title}\r\n                                            </h1>\r\n                                        </div>\r\n                                    </>\r\n                                )}\r\n                            </div>\r\n\r\n                            <div className=\"p-8\">\r\n                                <div className=\"flex flex-wrap gap-6 mb-8 text-text-light dark:text-dark-text-muted border-b border-gray-100 dark:border-dark-border pb-8\">\r\n                                    <div className=\"flex items-center gap-3 bg-gray-50 dark:bg-dark-bg p-3 rounded-lg border border-gray-100 dark:border-dark-border\">\r\n                                        <Calendar className=\"w-5 h-5 text-primary\" />\r\n                                        <div className=\"flex flex-col\">\r\n                                            <span className=\"text-xs font-semibold uppercase tracking-wider text-text-muted dark:text-dark-text-muted\">Date</span>\r\n                                            <span className=\"font-medium text-text dark:text-dark-text\">{format(startDate, 'MMM d, yyyy')}</span>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"flex items-center gap-3 bg-gray-50 dark:bg-dark-bg p-3 rounded-lg border border-gray-100 dark:border-dark-border\">\r\n                                        <Clock className=\"w-5 h-5 text-primary\" />\r\n                                        <div className=\"flex flex-col\">\r\n                                            <span className=\"text-xs font-semibold uppercase tracking-wider text-text-muted dark:text-dark-text-muted\">Time</span>\r\n                                            <span className=\"font-medium text-text dark:text-dark-text\">\r\n                                                {format(startDate, 'h:mm a')}\r\n                                                {endDate && ` - ${format(endDate, 'h:mm a')}`}\r\n                                            </span>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"flex items-center gap-3 bg-gray-50 dark:bg-dark-bg p-3 rounded-lg border border-gray-100 dark:border-dark-border flex-1 min-w-[200px]\">\r\n                                        <MapPin className=\"w-5 h-5 text-primary\" />\r\n                                        <div className=\"flex flex-col\">\r\n                                            <span className=\"text-xs font-semibold uppercase tracking-wider text-text-muted dark:text-dark-text-muted\">Location</span>\r\n                                            <span className=\"font-medium text-text dark:text-dark-text truncate\">{event.metadata.location}</span>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {event.metadata.link && (\r\n                                        <div className=\"flex items-center gap-3 bg-gray-50 dark:bg-dark-bg p-3 rounded-lg border border-gray-100 dark:border-dark-border w-full md:w-auto\">\r\n                                            <LinkIcon className=\"w-5 h-5 text-primary\" />\r\n                                            <div className=\"flex flex-col min-w-0\">\r\n                                                <span className=\"text-xs font-semibold uppercase tracking-wider text-text-muted dark:text-dark-text-muted\">Online Link</span>\r\n                                                <a href={event.metadata.link} target=\"_blank\" rel=\"noopener noreferrer\" className=\"font-medium text-primary hover:underline truncate max-w-[200px]\">\r\n                                                    {event.metadata.link.replace(/^https?:\\/\\//, '')}\r\n                                                </a>\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n\r\n                                <div className=\"prose prose-lg dark:prose-invert max-w-none text-text dark:text-dark-text mb-8\">\r\n                                    {event.content}\r\n                                </div>\r\n\r\n                                {event.tags && event.tags.length > 0 && (\r\n                                    <div className=\"flex flex-wrap gap-2 pt-4 border-t border-gray-100 dark:border-dark-border\">\r\n                                        {event.tags.map((tag: string) => (\r\n                                            <TagChip key={tag} tag={tag} />\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n\r\n                        <CommentsSection postId={id} />\r\n                    </div>\r\n\r\n                    {/* Sidebar */}\r\n                    <div className=\"space-y-6\">\r\n                        {/* RSVP Card */}\r\n                        <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-6 sticky top-24\">\r\n                            <EventActions\r\n                                eventId={id}\r\n                                isAuthor={user?.id === event.author_id}\r\n                            />\r\n\r\n                            <h3 className=\"text-lg font-bold text-text dark:text-dark-text mb-4\">\r\n                                Are you going?\r\n                            </h3>\r\n\r\n                            <RsvpButton\r\n                                eventId={id}\r\n                                initialStatus={userRsvp}\r\n                            />\r\n\r\n                            <div className=\"mt-6 pt-6 border-t border-gray-100 dark:border-dark-border\">\r\n                                <h4 className=\"font-semibold text-text dark:text-dark-text mb-3\">\r\n                                    Organized by\r\n                                </h4>\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <div className={`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold text-white ${getAvatarGradient(event.author_id)}`}>\r\n                                        {getInitials(event.author.name || undefined, event.author.email || undefined)}\r\n                                    </div>\r\n                                    <div className=\"flex flex-col\">\r\n                                        <span className=\"font-medium text-text dark:text-dark-text\">\r\n                                            {event.author.name || event.author.email?.split('@')[0]}\r\n                                        </span>\r\n                                        <span className=\"text-xs text-text-light dark:text-dark-text-muted\">\r\n                                            Event Host\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"mt-6 pt-6 border-t border-gray-100 dark:border-dark-border\">\r\n                                <div className=\"flex items-center justify-between mb-4\">\r\n                                    <h4 className=\"font-semibold text-text dark:text-dark-text flex items-center gap-2\">\r\n                                        <Users className=\"w-4 h-4\" />\r\n                                        Attendees\r\n                                    </h4>\r\n                                    <span className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                                        {going.length} going\r\n                                    </span>\r\n                                </div>\r\n\r\n                                {going.length > 0 ? (\r\n                                    <ul className=\"space-y-3\">\r\n                                        {going.slice(0, 5).map((rsvp: any) => (\r\n                                            <li key={rsvp.user.id} className=\"flex items-center gap-2 text-sm text-text dark:text-dark-text\">\r\n                                                <div className=\"w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-xs font-bold text-primary\">\r\n                                                    {rsvp.user.name?.[0] || rsvp.user.email?.[0] || '?'}\r\n                                                </div>\r\n                                                <span>{rsvp.user.name || rsvp.user.email?.split('@')[0]}</span>\r\n                                            </li>\r\n                                        ))}\r\n                                        {going.length > 5 && (\r\n                                            <li className=\"text-xs text-text-light dark:text-dark-text-muted pl-8\">\r\n                                                +{going.length - 5} more\r\n                                            </li>\r\n                                        )}\r\n                                    </ul>\r\n                                ) : (\r\n                                    <p className=\"text-sm text-text-light dark:text-dark-text-muted italic\">\r\n                                        Be the first to RSVP!\r\n                                    </p>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <ViewTracker postId={id} />\r\n            </main>\r\n\r\n            <Footer />\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\events\\create\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\events\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\explore\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":320,"column":97,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[12920,12934],"text":"Don&apos;t miss out"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[12920,12934],"text":"Don&lsquo;t miss out"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[12920,12934],"text":"Don&#39;t miss out"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[12920,12934],"text":"Don&rsquo;t miss out"},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { Suspense, useEffect, useState } from 'react'\r\nimport { useSearchParams } from 'next/navigation'\r\nimport Link from 'next/link'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { User } from '@supabase/supabase-js'\r\nimport { Navbar } from '@/components/Navbar'\r\nimport { Footer } from '@/components/Footer'\r\nimport { MagazineCard } from '@/components/MagazineCard'\r\nimport { FeaturedPost } from '@/components/FeaturedPost'\r\nimport { BentoGrid, BentoGridItem } from '@/components/BentoGrid'\r\nimport { GroupCard } from '@/components/GroupCard'\r\nimport { ProfileCard } from '@/components/ProfileCard'\r\nimport { SearchBar } from '@/components/SearchBar'\r\nimport { Compass, TrendingUp, Users, BookOpen, Sparkles, ChevronDown, X, Calendar } from 'lucide-react'\r\nimport { useTranslations } from 'next-intl'\r\n\r\nimport { Post } from '@/types'\r\n\r\ntype SortOption = 'recent' | 'trending' | 'cited'\r\n\r\nexport default function ExplorePage() {\r\n  return (\r\n    <Suspense fallback={<ExploreFallback />}>\r\n      <ExplorePageContent />\r\n    </Suspense>\r\n  )\r\n}\r\n\r\nfunction ExplorePageContent() {\r\n  const searchParams = useSearchParams()\r\n  const initialTag = searchParams.get('tag')\r\n\r\n  const [user, setUser] = useState<User | null>(null)\r\n  const [posts, setPosts] = useState<Post[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [selectedTag, setSelectedTag] = useState<string | null>(initialTag)\r\n  const [sortBy, setSortBy] = useState<SortOption>('recent')\r\n  const [allTags, setAllTags] = useState<string[]>([])\r\n  const supabase = createClient()\r\n  const t = useTranslations('Explore')\r\n  const tFeed = useTranslations('Feed')\r\n  const tCategories = useTranslations('Categories')\r\n\r\n  const [trendingPosts, setTrendingPosts] = useState<Post[]>([])\r\n  const [recommendedGroups, setRecommendedGroups] = useState<any[]>([])\r\n  const [profiles, setProfiles] = useState<any[]>([])\r\n  const [comingEvents, setComingEvents] = useState<Post[]>([])\r\n\r\n  useEffect(() => {\r\n    supabase.auth.getUser().then(({ data: { user } }) => {\r\n      setUser(user)\r\n    })\r\n  }, [supabase])\r\n\r\n  useEffect(() => {\r\n    const loadTags = async () => {\r\n      const { data } = await supabase\r\n        .from('posts')\r\n        .select('tags')\r\n\r\n      if (data) {\r\n        const tagsSet = new Set<string>()\r\n        data.forEach((post) => {\r\n          if (post.tags) {\r\n            post.tags.forEach((tag: string) => tagsSet.add(tag))\r\n          }\r\n        })\r\n        setAllTags(Array.from(tagsSet).sort())\r\n      }\r\n    }\r\n\r\n    loadTags()\r\n  }, [supabase])\r\n\r\n  useEffect(() => {\r\n    const loadContent = async () => {\r\n      setLoading(true)\r\n      try {\r\n        // Fetch Trending Posts\r\n        const { data: trendingData } = await supabase\r\n          .from('posts')\r\n          .select(`\r\n            *,\r\n            author:users!posts_author_id_fkey(id, name, email)\r\n          `)\r\n          .eq('status', 'published')\r\n          .neq('approval_status', 'rejected') // Hide rejected posts\r\n          .order('created_at', { ascending: false })\r\n          .limit(6)\r\n\r\n        setTrendingPosts(trendingData as Post[] || [])\r\n\r\n        // Fetch Recommended Groups\r\n        const { data: groupsData } = await supabase\r\n          .from('groups')\r\n          .select('*')\r\n          .eq('visibility', 'public')\r\n          .limit(6)\r\n\r\n        if (groupsData && groupsData.length > 0) {\r\n          const groupIds = groupsData.map((g: any) => g.id)\r\n          const { data: counts } = await supabase\r\n            .from('group_members')\r\n            .select('group_id')\r\n            .in('group_id', groupIds)\r\n\r\n          const countMap = new Map()\r\n          counts?.forEach(c => {\r\n            countMap.set(c.group_id, (countMap.get(c.group_id) || 0) + 1)\r\n          })\r\n\r\n          const groupsWithCounts = groupsData.map((g: any) => ({\r\n            ...g,\r\n            member_count: countMap.get(g.id) || 0\r\n          }))\r\n          setRecommendedGroups(groupsWithCounts)\r\n        }\r\n\r\n        // Fetch Main Feed Posts (Exclude events)\r\n        let query = supabase\r\n          .from('posts')\r\n          .select(`\r\n            *,\r\n            author:users!posts_author_id_fkey(id, name, email)\r\n          `)\r\n          .neq('content_type', 'event') // Exclude events\r\n          .neq('approval_status', 'rejected') // Hide rejected posts\r\n          .order('created_at', { ascending: false })\r\n\r\n        if (selectedTag) {\r\n          query = query.contains('tags', [selectedTag])\r\n        }\r\n\r\n        const { data: postsData } = await query\r\n        setPosts(postsData as Post[] || [])\r\n\r\n        // Fetch Events separately (showing 3 upcoming)\r\n        const { data: eventsData } = await supabase\r\n          .from('posts')\r\n          .select(`\r\n            *,\r\n            author:users!posts_author_id_fkey(id, name, email)\r\n          `)\r\n          .eq('content_type', 'event')\r\n          .neq('approval_status', 'rejected')\r\n          .order('metadata->>start_time', { ascending: true }) // Sort by event start time\r\n          .gt('metadata->>start_time', new Date().toISOString()) // Only future events\r\n          .limit(3)\r\n\r\n        setComingEvents(eventsData as Post[] || [])\r\n\r\n        // Fetch Profiles\r\n        const { data: profilesData } = await supabase\r\n          .from('users')\r\n          .select('id, name, role, bio, affiliation, avatar_url, cover_image_url')\r\n          .eq('role', 'researcher')\r\n          .limit(4)\r\n\r\n        setProfiles(profilesData || [])\r\n\r\n      } catch (error) {\r\n        console.error('Error fetching content:', error)\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n\r\n    loadContent()\r\n  }, [selectedTag, supabase])\r\n\r\n  const disciplines = [\r\n    'Computer Science', 'Mathematics', 'Physics', 'Biology',\r\n    'Chemistry', 'Medicine', 'Engineering', 'Psychology',\r\n    'Sociology', 'Economics', 'Philosophy', 'History',\r\n  ]\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background dark:bg-dark-bg flex flex-col\">\r\n      <Navbar user={user} />\r\n\r\n      <main className=\"flex-1\">\r\n        {/* Hero Header */}\r\n        <div className=\"relative bg-gradient-to-br from-primary via-primary-dark to-primary overflow-hidden\">\r\n          <div className=\"absolute inset-0 opacity-10\">\r\n            <div className=\"absolute top-0 right-0 w-96 h-96 bg-white rounded-full blur-3xl transform translate-x-1/2 -translate-y-1/2\" />\r\n            <div className=\"absolute bottom-0 left-0 w-64 h-64 bg-secondary rounded-full blur-3xl transform -translate-x-1/2 translate-y-1/2\" />\r\n          </div>\r\n\r\n          <div className=\"container-custom max-w-7xl relative z-10 py-16 md:py-24\">\r\n            <div className=\"max-w-3xl\">\r\n              <div className=\"flex items-center gap-2 mb-4\">\r\n                <Compass className=\"w-5 h-5 text-white/80\" />\r\n                <span className=\"text-sm font-semibold uppercase tracking-wider text-white/80\">\r\n                  {t('discover')}\r\n                </span>\r\n              </div>\r\n              <h1 className=\"text-4xl md:text-6xl font-bold text-white tracking-tight mb-4\">\r\n                {t('exploreResearch')}\r\n              </h1>\r\n              <p className=\"text-xl text-white/80 mb-8\">\r\n                {t('discoverDescription')}\r\n              </p>\r\n\r\n              {/* Search */}\r\n              <div className=\"max-w-xl\">\r\n                <SearchBar />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"container-custom max-w-7xl py-12\">\r\n          {/* Discipline Pills */}\r\n          <div className=\"mb-12\">\r\n            <div className=\"flex flex-wrap gap-3\">\r\n              <button\r\n                onClick={() => setSelectedTag(null)}\r\n                className={`px-5 py-2.5 rounded-full text-sm font-semibold transition-all ${selectedTag === null\r\n                  ? 'bg-primary text-white shadow-md'\r\n                  : 'bg-white dark:bg-dark-surface border border-gray-200 dark:border-dark-border text-text dark:text-dark-text hover:border-primary dark:hover:border-primary-light'\r\n                  }`}\r\n              >\r\n                {tFeed('allTopics')}\r\n              </button>\r\n              {disciplines.map((discipline) => (\r\n                <button\r\n                  key={discipline}\r\n                  onClick={() => setSelectedTag(discipline)}\r\n                  className={`px-5 py-2.5 rounded-full text-sm font-semibold transition-all ${selectedTag === discipline\r\n                    ? 'bg-primary text-white shadow-md'\r\n                    : 'bg-white dark:bg-dark-surface border border-gray-200 dark:border-dark-border text-text dark:text-dark-text hover:border-primary dark:hover:border-primary-light'\r\n                    }`}\r\n                >\r\n                  {tCategories(discipline)}\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Active Filter */}\r\n          {selectedTag && (\r\n            <div className=\"mb-8 flex items-center gap-3\">\r\n              <span className=\"text-text-light dark:text-dark-text-muted\">Filtering by:</span>\r\n              <div className=\"flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-full\">\r\n                <span className=\"font-semibold\">{selectedTag}</span>\r\n                <button\r\n                  onClick={() => setSelectedTag(null)}\r\n                  className=\"hover:bg-white/20 rounded-full p-1 transition-colors\"\r\n                >\r\n                  <X className=\"w-4 h-4\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {loading ? (\r\n            <div className=\"flex items-center justify-center py-20\">\r\n              <div className=\"text-center\">\r\n                <div className=\"inline-block animate-spin rounded-full h-10 w-10 border-b-2 border-primary mb-4\"></div>\r\n                <p className=\"text-text-light dark:text-dark-text-muted\">Loading content...</p>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <>\r\n              {/* Trending Posts - Bento Grid (Remains Full Width) */}\r\n              {!selectedTag && trendingPosts.length > 0 && (\r\n                <section className=\"mb-16\">\r\n                  <div className=\"flex items-center gap-3 mb-8\">\r\n                    <div className=\"w-10 h-10 bg-accent/20 rounded-xl flex items-center justify-center\">\r\n                      <TrendingUp className=\"w-5 h-5 text-accent\" />\r\n                    </div>\r\n                    <div>\r\n                      <h2 className=\"text-2xl font-bold text-text dark:text-dark-text\">{t('trendingNow')}</h2>\r\n                      <p className=\"text-sm text-text-light dark:text-dark-text-muted\">{t('hotResearch')}</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <BentoGrid columns={4} gap=\"lg\">\r\n                    {trendingPosts[0] && (\r\n                      <BentoGridItem size=\"2x2\">\r\n                        <FeaturedPost post={trendingPosts[0]} size=\"large\" showTrending />\r\n                      </BentoGridItem>\r\n                    )}\r\n                    {trendingPosts[1] && (\r\n                      <BentoGridItem size=\"1x2\">\r\n                        <FeaturedPost post={trendingPosts[1]} size=\"medium\" accentColor=\"secondary\" />\r\n                      </BentoGridItem>\r\n                    )}\r\n                    {trendingPosts[2] && (\r\n                      <BentoGridItem size=\"1x1\">\r\n                        <MagazineCard post={trendingPosts[2]} variant=\"compact\" className=\"h-full\" />\r\n                      </BentoGridItem>\r\n                    )}\r\n                    {trendingPosts[3] && (\r\n                      <BentoGridItem size=\"1x1\">\r\n                        <MagazineCard post={trendingPosts[3]} variant=\"compact\" className=\"h-full\" />\r\n                      </BentoGridItem>\r\n                    )}\r\n                  </BentoGrid>\r\n                </section>\r\n              )}\r\n\r\n              {/* Main Content & Sidebar Layout */}\r\n              <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-8\">\r\n                {/* Main Content Column */}\r\n                <div className=\"lg:col-span-9 space-y-16\">\r\n\r\n                  {/* Upcoming Events */}\r\n                  {!selectedTag && comingEvents.length > 0 && (\r\n                    <section>\r\n                      <div className=\"flex items-center justify-between mb-8\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                          <div className=\"w-10 h-10 bg-accent/10 rounded-xl flex items-center justify-center\">\r\n                            <Calendar className=\"w-5 h-5 text-accent\" />\r\n                          </div>\r\n                          <div>\r\n                            <h2 className=\"text-2xl font-bold text-text dark:text-dark-text\">{t('upcomingEvents')}</h2>\r\n                            <p className=\"text-sm text-text-light dark:text-dark-text-muted\">Don't miss out</p>\r\n                          </div>\r\n                        </div>\r\n                        <Link\r\n                          href=\"/events\"\r\n                          className=\"text-sm font-semibold text-primary hover:text-primary-dark transition-colors\"\r\n                        >\r\n                          View all ΓåÆ\r\n                        </Link>\r\n                      </div>\r\n\r\n                      <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\r\n                        {comingEvents.map((event) => (\r\n                          <MagazineCard key={event.id} post={event} variant=\"standard\" />\r\n                        ))}\r\n                      </div>\r\n                    </section>\r\n                  )}\r\n\r\n                  {/* Research Groups */}\r\n                  {!selectedTag && recommendedGroups.length > 0 && (\r\n                    <section>\r\n                      <div className=\"flex items-center justify-between mb-8\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                          <div className=\"w-10 h-10 bg-primary/10 rounded-xl flex items-center justify-center\">\r\n                            <Sparkles className=\"w-5 h-5 text-primary\" />\r\n                          </div>\r\n                          <div>\r\n                            <h2 className=\"text-2xl font-bold text-text dark:text-dark-text\">Research Groups</h2>\r\n                            <p className=\"text-sm text-text-light dark:text-dark-text-muted\">Join collaborative communities</p>\r\n                          </div>\r\n                        </div>\r\n                        <Link\r\n                          href=\"/groups\"\r\n                          className=\"text-sm font-semibold text-primary hover:text-primary-dark transition-colors\"\r\n                        >\r\n                          View all ΓåÆ\r\n                        </Link>\r\n                      </div>\r\n\r\n                      <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\r\n                        {recommendedGroups.slice(0, 3).map((group) => (\r\n                          <GroupCard key={group.id} group={group} />\r\n                        ))}\r\n                      </div>\r\n                    </section>\r\n                  )}\r\n\r\n                  {/* All Research */}\r\n                  <section>\r\n                    <div className=\"flex items-center justify-between mb-8\">\r\n                      <div className=\"flex items-center gap-3\">\r\n                        <div className=\"w-10 h-10 bg-gray-100 dark:bg-dark-surface rounded-xl flex items-center justify-center\">\r\n                          <BookOpen className=\"w-5 h-5 text-text-light dark:text-dark-text-muted\" />\r\n                        </div>\r\n                        <div>\r\n                          <h2 className=\"text-2xl font-bold text-text dark:text-dark-text\">\r\n                            {selectedTag ? `${selectedTag} Research` : 'Latest Research'}\r\n                          </h2>\r\n                          <p className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                            {posts.length} publications\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {/* Sort */}\r\n                      <div className=\"relative\">\r\n                        <select\r\n                          value={sortBy}\r\n                          onChange={(e) => setSortBy(e.target.value as SortOption)}\r\n                          className=\"appearance-none pl-4 pr-10 py-2.5 text-sm rounded-xl border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-surface text-text dark:text-dark-text cursor-pointer\"\r\n                        >\r\n                          <option value=\"recent\">Most Recent</option>\r\n                          <option value=\"trending\">Trending</option>\r\n                          <option value=\"cited\">Most Cited</option>\r\n                        </select>\r\n                        <ChevronDown className=\"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-text-light pointer-events-none\" />\r\n                      </div>\r\n                    </div>\r\n\r\n                    {posts.length > 0 ? (\r\n                      <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\r\n                        {posts.map((post) => (\r\n                          <MagazineCard key={post.id} post={post} variant=\"standard\" />\r\n                        ))}\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"text-center py-16 bg-gray-50 dark:bg-dark-surface rounded-2xl\">\r\n                        <BookOpen className=\"w-12 h-12 mx-auto mb-4 text-text-light dark:text-dark-text-muted\" />\r\n                        <h3 className=\"text-lg font-semibold text-text dark:text-dark-text mb-2\">No research found</h3>\r\n                        <p className=\"text-text-light dark:text-dark-text-muted\">\r\n                          {selectedTag ? `No posts found for \"${selectedTag}\"` : 'No posts available yet.'}\r\n                        </p>\r\n                      </div>\r\n                    )}\r\n                  </section>\r\n                </div>\r\n\r\n                {/* Sidebar Column */}\r\n                <div className=\"lg:col-span-3 space-y-8\">\r\n                  {/* Featured Researchers - Vertical List */}\r\n                  {!selectedTag && profiles.length > 0 && (\r\n                    <section className=\"bg-white dark:bg-dark-surface p-6 rounded-2xl border border-gray-100 dark:border-dark-border sticky top-24\">\r\n                      <div className=\"flex items-center gap-3 mb-6\">\r\n                        <div className=\"w-10 h-10 bg-secondary/20 rounded-xl flex items-center justify-center flex-shrink-0\">\r\n                          <Users className=\"w-5 h-5 text-secondary-dark\" />\r\n                        </div>\r\n                        <div>\r\n                          <h2 className=\"text-lg font-bold text-text dark:text-dark-text leading-tight\">Featured Researchers</h2>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"flex flex-col gap-4\">\r\n                        {profiles.map((profile) => (\r\n                          <ProfileCard key={profile.id} profile={profile} />\r\n                        ))}\r\n                      </div>\r\n                    </section>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n      </main >\r\n\r\n      <Footer />\r\n    </div >\r\n  )\r\n}\r\n\r\nfunction ExploreFallback() {\r\n  return (\r\n    <div className=\"min-h-screen bg-background dark:bg-dark-bg\">\r\n      <Navbar />\r\n      <div className=\"container-custom max-w-7xl py-12\">\r\n        <div className=\"animate-pulse\">\r\n          <div className=\"h-64 bg-gray-200 dark:bg-dark-surface rounded-2xl mb-12\" />\r\n          <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\r\n            {[...Array(6)].map((_, i) => (\r\n              <div key={i} className=\"h-64 bg-gray-200 dark:bg-dark-surface rounded-xl\" />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\feed\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\groups\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\groups\\[id]\\settings\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\groups\\create\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\groups\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\jury\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\notifications\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\offline\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\p\\[token]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\post\\[id]\\page.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":313,"column":19,"nodeType":"JSXOpeningElement","endLine":317,"endColumn":21},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":485,"column":19,"nodeType":"JSXOpeningElement","endLine":489,"endColumn":21},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":556,"column":27,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[22523,22552],"text":"\r\n                          &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[22523,22552],"text":"\r\n                          &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[22523,22552],"text":"\r\n                          &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[22523,22552],"text":"\r\n                          &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":556,"column":52,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[22576,22603],"text":"&quot;\r\n                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[22576,22603],"text":"&ldquo;\r\n                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[22576,22603],"text":"&#34;\r\n                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[22576,22603],"text":"&rdquo;\r\n                        "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { notFound, redirect } from 'next/navigation'\r\nimport Link from 'next/link'\r\nimport { ArrowLeft, Calendar, User as UserIcon, PenSquare, GitPullRequest, Clock, Eye, Share2, Bookmark, MessageSquare } from 'lucide-react'\r\nimport { createClient } from '@/lib/supabase/server'\r\nimport { Navbar } from '@/components/Navbar'\r\nimport { Footer } from '@/components/Footer'\r\nimport { TagChip } from '@/components/TagChip'\r\nimport { RelatedPosts } from '@/components/RelatedPosts'\r\nimport { CitationBacklinks } from '@/components/CitationBacklinks'\r\nimport { CommentsSection } from '@/components/CommentsSection'\r\nimport { AnswerList } from '@/components/AnswerList'\r\nimport { AnswerForm } from '@/components/AnswerForm'\r\nimport { ForkButton } from '@/components/ForkButton'\r\nimport { SuggestionDialog } from '@/components/SuggestionDialog'\r\nimport { KnowledgeGraph } from '@/components/KnowledgeGraph'\r\nimport { CitationContextBar } from '@/components/CitationContextBar'\r\nimport { PostMoreOptions } from '@/components/PostMoreOptions'\r\nimport { TextSelectionHandler } from '@/components/TextSelectionHandler'\r\nimport { BookmarkButton } from '@/components/BookmarkButton'\r\nimport { EditButton } from '@/components/EditButton'\r\nimport { LinkedResourcesSection } from '@/components/LinkedResourcesSection'\r\nimport { EpistemicRecommendations } from '@/components/EpistemicRecommendations'\r\nimport { SessionContextBar } from '@/components/SessionContextBar'\r\nimport { PostSessionTracker } from '@/components/PostSessionTracker'\r\nimport { GitFork } from 'lucide-react'\r\nimport ReactMarkdown from 'react-markdown'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Metadata } from 'next'\r\nimport { RejectionBanner } from '@/components/RejectionBanner'\r\n\r\ninterface PostPageProps {\r\n  params: Promise<{\r\n    id: string\r\n  }>\r\n}\r\n\r\n// Generate dynamic metadata for SEO\r\nexport async function generateMetadata({ params }: PostPageProps): Promise<Metadata> {\r\n  const { id } = await params\r\n  const supabase = await createClient()\r\n\r\n  const { data: post } = await supabase\r\n    .from('posts')\r\n    .select(`\r\n      id,\r\n      title,\r\n      content,\r\n      tags,\r\n      content_type,\r\n      author:users!posts_author_id_fkey(name, email)\r\n    `)\r\n    .eq('id', id)\r\n    .single()\r\n\r\n  if (!post) {\r\n    return {\r\n      title: 'Post Not Found | SyriaHub',\r\n      description: 'The requested post could not be found.',\r\n    }\r\n  }\r\n\r\n  const authorName = (post.author as any)?.name || (post.author as any)?.email?.split('@')[0] || 'Anonymous'\r\n  const description = post.content.replace(/[#*_`\\[\\]]/g, '').substring(0, 155) + '...'\r\n  const siteUrl = process.env.NEXT_PUBLIC_SITE_URL || 'https://syrealize.com'\r\n  const ogImageUrl = `${siteUrl}/api/og?id=${post.id}`\r\n\r\n  return {\r\n    title: `${post.title} | SyriaHub`,\r\n    description,\r\n    authors: [{ name: authorName }],\r\n    keywords: post.tags || [],\r\n    openGraph: {\r\n      title: post.title,\r\n      description,\r\n      type: 'article',\r\n      url: `${siteUrl}/post/${post.id}`,\r\n      images: [\r\n        {\r\n          url: ogImageUrl,\r\n          width: 1200,\r\n          height: 630,\r\n          alt: post.title,\r\n        },\r\n      ],\r\n      siteName: 'SyriaHub',\r\n    },\r\n    twitter: {\r\n      card: 'summary_large_image',\r\n      title: post.title,\r\n      description,\r\n      images: [ogImageUrl],\r\n    },\r\n    alternates: {\r\n      canonical: `${siteUrl}/post/${post.id}`,\r\n    },\r\n  }\r\n}\r\n\r\n// Reading time calculator\r\nfunction getReadingTime(content: string): number {\r\n  const words = content.trim().split(/\\s+/).length\r\n  return Math.max(1, Math.ceil(words / 200))\r\n}\r\n\r\nexport default async function PostPage(props: PostPageProps) {\r\n  const params = await props.params\r\n  const { id } = params\r\n  const supabase = await createClient()\r\n  const {\r\n    data: { user },\r\n  } = await supabase.auth.getUser()\r\n\r\n  const { data: post, error } = await supabase\r\n    .from('posts')\r\n    .select(\r\n      `\r\n        *,\r\n        author:users!posts_author_id_fkey(id, name, email, bio, affiliation, avatar_url)\r\n      `\r\n    )\r\n    .eq('id', id)\r\n    .single()\r\n\r\n  if (error || !post) {\r\n    console.error('Error fetching post:', error)\r\n    notFound()\r\n  }\r\n\r\n  // Redirect events to the dedicated event page\r\n  if (post.content_type === 'event') {\r\n    redirect(`/events/${id}`)\r\n  }\r\n\r\n  let relatedPosts: any[] = []\r\n  if (post.tags && post.tags.length > 0) {\r\n    const { data } = await supabase\r\n      .from('posts')\r\n      .select(\r\n        `\r\n          id,\r\n          title,\r\n          tags,\r\n          created_at,\r\n          author:users(name, email)\r\n        `\r\n      )\r\n      .neq('id', id)\r\n      .overlaps('tags', post.tags)\r\n      .limit(5)\r\n\r\n    relatedPosts = data || []\r\n  }\r\n\r\n  const { data: citationData } = await supabase\r\n    .from('citations')\r\n    .select(\r\n      `\r\n        source_post_id,\r\n        quote_content,\r\n        posts!citations_source_post_id_fkey (\r\n          id,\r\n          title,\r\n          created_at,\r\n          author:users(name, email)\r\n        )\r\n      `\r\n    )\r\n    .eq('target_post_id', id)\r\n\r\n\r\n  const citationBacklinks =\r\n    citationData?.map((c: any) => ({\r\n      ...c.posts,\r\n      quote_content: c.quote_content\r\n    })).filter((c: any) => c.id) || []\r\n\r\n  const authorDisplay =\r\n    post.author?.name || post.author?.email?.split('@')[0] || 'Anonymous'\r\n\r\n  const readingTime = getReadingTime(post.content || '')\r\n\r\n  // Fetch answers if it's a question\r\n  let answers: any[] = []\r\n  if (post.content_type === 'question') {\r\n    const { data: answersData } = await supabase\r\n      .from('posts')\r\n      .select(`\r\n        *,\r\n        author:users(id, name, email),\r\n        vote_count:post_votes(value)\r\n      `)\r\n      .eq('parent_id', id)\r\n      .eq('content_type', 'answer')\r\n      .order('is_accepted', { ascending: false })\r\n      .order('created_at', { ascending: true })\r\n\r\n    answers = answersData || []\r\n  }\r\n\r\n  // Fetch linked resources\r\n  let linkedResources: any[] = []\r\n  const { data: resourceLinksData } = await supabase\r\n    .from('resource_post_links')\r\n    .select(`\r\n      resource_id,\r\n      posts!resource_post_links_resource_id_fkey (\r\n        id,\r\n        title,\r\n        metadata,\r\n        created_at\r\n      )\r\n    `)\r\n    .eq('post_id', id)\r\n\r\n\r\n  if (resourceLinksData) {\r\n    linkedResources = resourceLinksData\r\n      .map((link: any) => link.posts)\r\n      .filter((r: any) => r !== null)\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background dark:bg-dark-bg flex flex-col\">\r\n      <Navbar user={user} />\r\n\r\n      {/* Hero Header with Cover Image Background */}\r\n      <header className={`group relative overflow-hidden ${post.cover_image_url ? 'min-h-[250px] sm:min-h-[350px] md:min-h-[400px]' : ''}`}>\r\n        {/* Cover Image Background */}\r\n        {post.cover_image_url && (\r\n          <>\r\n            <div\r\n              className=\"absolute inset-0 bg-cover bg-center transition-transform duration-700 group-hover:scale-105\"\r\n              style={{ backgroundImage: `url(${post.cover_image_url})` }}\r\n            />\r\n            <div className=\"absolute inset-0 bg-gradient-to-t from-black/70 via-black/50 to-black/30 transition-opacity duration-500 group-hover:opacity-60\" />\r\n          </>\r\n        )}\r\n\r\n        {/* Header Content */}\r\n        <div className={`relative z-10 ${post.cover_image_url ? '' : 'bg-white dark:bg-dark-surface border-b border-gray-200 dark:border-dark-border'}`}>\r\n          <div className=\"container-custom max-w-5xl py-6\">\r\n            {/* Back Link */}\r\n            <Link\r\n              href=\"/feed\"\r\n              className={`inline-flex items-center gap-2 text-sm transition-colors mb-4 md:mb-8 ${post.cover_image_url\r\n                ? 'text-white/80 hover:text-white'\r\n                : 'text-text-light dark:text-dark-text-muted hover:text-primary dark:hover:text-primary-light'\r\n                }`}\r\n            >\r\n              <ArrowLeft className=\"w-4 h-4\" />\r\n              Back to Feed\r\n            </Link>\r\n\r\n            {/* Content Type Badge */}\r\n            {post.content_type === 'question' && (\r\n              <div className=\"mb-4\">\r\n                <span className=\"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-secondary/20 text-secondary-dark dark:text-secondary text-sm font-semibold\">\r\n                  <MessageSquare className=\"w-4 h-4\" />\r\n                  Question\r\n                </span>\r\n              </div>\r\n            )}\r\n\r\n            {/* Title */}\r\n            <h1 className={`text-3xl sm:text-4xl md:text-5xl font-bold leading-tight tracking-tight mb-4 md:mb-6 ${post.cover_image_url ? 'text-white' : 'text-text dark:text-dark-text'\r\n              }`}>\r\n              {post.title}\r\n            </h1>\r\n\r\n            {/* Forked From */}\r\n            {post.forked_from && (\r\n              <div className=\"flex items-center gap-2 mb-4 md:mb-6 text-sm text-text-light dark:text-dark-text-muted bg-gray-50 dark:bg-dark-bg p-3 rounded-xl border border-gray-100 dark:border-dark-border w-fit\">\r\n                <GitFork className=\"w-4 h-4 text-secondary\" />\r\n                <span>Remixed from</span>\r\n                <Link href={`/post/${post.forked_from.id}`} className=\"font-semibold text-primary dark:text-primary-light hover:underline\">\r\n                  {post.forked_from.title}\r\n                </Link>\r\n              </div>\r\n            )}\r\n\r\n            {/* Tags */}\r\n            {post.tags && post.tags.length > 0 && (\r\n              <div className=\"flex flex-wrap gap-2 mb-4 md:mb-6\">\r\n                {post.cover_image_url ? (\r\n                  // White tags for visibility on cover image\r\n                  post.tags.map((tag: string) => (\r\n                    <span\r\n                      key={tag}\r\n                      className=\"px-3 py-1.5 text-sm font-medium bg-white/20 backdrop-blur-sm text-white rounded-full hover:bg-white/30 transition-colors\"\r\n                    >\r\n                      #{tag}\r\n                    </span>\r\n                  ))\r\n                ) : (\r\n                  // Normal tags for default background\r\n                  post.tags.map((tag: string) => (\r\n                    <TagChip key={tag} tag={tag} interactive />\r\n                  ))\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {/* Meta Row */}\r\n            <div className={`flex flex-wrap items-center gap-6 text-sm ${post.cover_image_url ? 'text-white/80' : 'text-text-light dark:text-dark-text-muted'\r\n              }`}>\r\n              {/* Author */}\r\n              <Link\r\n                href={`/profile/${post.author_id}`}\r\n                className={`flex items-center gap-3 transition-colors ${post.cover_image_url ? 'hover:text-white' : 'hover:text-primary dark:hover:text-primary-light'\r\n                  }`}\r\n              >\r\n                {post.author?.avatar_url ? (\r\n                  <img\r\n                    src={post.author.avatar_url}\r\n                    alt={authorDisplay}\r\n                    className=\"w-10 h-10 rounded-full object-cover ring-2 ring-white/20\"\r\n                  />\r\n                ) : (\r\n                  <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center text-white font-semibold\">\r\n                    {(post.author?.name?.[0] || post.author?.email?.[0] || 'U').toUpperCase()}\r\n                  </div>\r\n                )}\r\n                <div>\r\n                  <span className={`font-semibold block ${post.cover_image_url ? 'text-white' : 'text-text dark:text-dark-text'}`}>{authorDisplay}</span>\r\n                  {post.author?.affiliation && (\r\n                    <span className=\"text-xs\">{post.author.affiliation}</span>\r\n                  )}\r\n                </div>\r\n              </Link>\r\n\r\n              <span className=\"text-gray-300 dark:text-gray-700\">ΓÇó</span>\r\n\r\n              {/* Date */}\r\n              <div className=\"flex items-center gap-2\">\r\n                <Calendar className=\"w-4 h-4\" />\r\n                <time dateTime={post.created_at}>\r\n                  {new Date(post.created_at).toLocaleDateString('en-US', {\r\n                    year: 'numeric',\r\n                    month: 'long',\r\n                    day: 'numeric',\r\n                  })}\r\n                </time>\r\n              </div>\r\n\r\n              <span className=\"text-gray-300 dark:text-gray-700\">ΓÇó</span>\r\n\r\n              {/* Reading Time */}\r\n              <div className=\"flex items-center gap-2\">\r\n                <Clock className=\"w-4 h-4\" />\r\n                <span>{readingTime} min read</span>\r\n              </div>\r\n\r\n              {/* License */}\r\n              {post.license && (\r\n                <>\r\n                  <span className=\"text-gray-300 dark:text-gray-700\">ΓÇó</span>\r\n                  <span className=\"px-2 py-1 rounded-full bg-gray-100 dark:bg-dark-bg text-xs\">\r\n                    {post.license}\r\n                  </span>\r\n                </>\r\n              )}\r\n            </div>\r\n\r\n            {/* Action Buttons */}\r\n            <div className=\"flex items-center gap-3 mt-4 pt-4 md:mt-8 md:pt-6 border-t border-gray-100 dark:border-dark-border\">\r\n              {user && user.id === post.author_id ? (\r\n                <>\r\n                  <EditButton\r\n                    postId={post.id}\r\n                    postCreatedAt={post.created_at}\r\n                    isAuthor={true}\r\n                  />\r\n                  <Link href={`/post/${post.id}/suggestions`}>\r\n                    <Button variant=\"outline\" className=\"gap-2\">\r\n                      <GitPullRequest className=\"w-4 h-4\" />\r\n                      Suggestions\r\n                    </Button>\r\n                  </Link>\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <ForkButton\r\n                    postId={post.id}\r\n                    postTitle={post.title}\r\n                    postContent={post.content}\r\n                    postTags={post.tags || []}\r\n                  />\r\n                  <SuggestionDialog\r\n                    postId={post.id}\r\n                    currentContent={post.content}\r\n                  />\r\n                </>\r\n              )}\r\n\r\n              <div className=\"flex-1\" />\r\n\r\n              <BookmarkButton postId={post.id} />\r\n              <PostMoreOptions postId={post.id} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      <main className=\"flex-1 container-custom max-w-5xl py-12\">\r\n        <div className=\"grid lg:grid-cols-3 gap-12\">\r\n          {/* Main Content */}\r\n          <article className=\"lg:col-span-2 space-y-12\">\r\n            {/* Rejection Banner - shown only to authors of rejected posts */}\r\n            <RejectionBanner\r\n              postId={post.id}\r\n              postTitle={post.title}\r\n              rejectionReason={post.rejection_reason}\r\n              approvalStatus={post.approval_status || 'approved'}\r\n              isAuthor={user?.id === post.author_id}\r\n              contentType={post.content_type as 'post' | 'article' | 'question' | 'event'}\r\n            />\r\n\r\n            {/* Article Content */}\r\n            <div className=\"prose prose-lg max-w-none dark:prose-invert \r\n              prose-headings:font-bold prose-headings:text-text dark:prose-headings:text-dark-text \r\n              prose-h2:text-2xl prose-h2:mt-12 prose-h2:mb-4\r\n              prose-h3:text-xl prose-h3:mt-8 prose-h3:mb-3\r\n              prose-p:text-text-light prose-p:dark:text-dark-text-muted prose-p:leading-relaxed\r\n              prose-a:text-primary dark:prose-a:text-primary-light prose-a:no-underline hover:prose-a:underline\r\n              prose-strong:text-text dark:prose-strong:text-dark-text \r\n              prose-code:text-accent dark:prose-code:text-accent-light prose-code:bg-gray-100 dark:prose-code:bg-dark-surface prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded\r\n              prose-blockquote:border-l-4 prose-blockquote:border-primary prose-blockquote:bg-gray-50 dark:prose-blockquote:bg-dark-surface prose-blockquote:py-2 prose-blockquote:px-4 prose-blockquote:rounded-r-lg\r\n              prose-img:rounded-xl prose-img:shadow-soft-md\r\n              prose-ul:my-6 prose-li:my-1\r\n            \">\r\n              <TextSelectionHandler postId={post.id}>\r\n                <ReactMarkdown>{post.content || ''}</ReactMarkdown>\r\n              </TextSelectionHandler>\r\n            </div>\r\n\r\n            {/* Answers Section for Questions */}\r\n            {post.content_type === 'question' && (\r\n              <section className=\"space-y-8\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <h2 className=\"text-2xl font-bold text-text dark:text-dark-text\">\r\n                    {answers.length} {answers.length === 1 ? 'Answer' : 'Answers'}\r\n                  </h2>\r\n                </div>\r\n\r\n                <AnswerList\r\n                  answers={answers}\r\n                  isQuestionAuthor={user?.id === post.author_id}\r\n                />\r\n\r\n                {/* Answer Form */}\r\n                {user ? (\r\n                  <div className=\"bg-white dark:bg-dark-surface rounded-2xl border border-gray-200 dark:border-dark-border p-6\">\r\n                    <h3 className=\"text-lg font-semibold text-text dark:text-dark-text mb-4\">Your Answer</h3>\r\n                    <AnswerForm questionId={post.id} />\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"text-center py-12 bg-gray-50 dark:bg-dark-surface rounded-2xl\">\r\n                    <p className=\"text-text-light dark:text-dark-text-muted mb-4\">\r\n                      Sign in to answer this question.\r\n                    </p>\r\n                    <Link href=\"/auth/login\">\r\n                      <Button>Sign In</Button>\r\n                    </Link>\r\n                  </div>\r\n                )}\r\n              </section>\r\n            )}\r\n\r\n            {/* Comments Section */}\r\n            {post.content_type !== 'question' && <CommentsSection postId={post.id} />}\r\n          </article>\r\n\r\n          {/* Sidebar */}\r\n          <aside className=\"lg:col-span-1 space-y-6\">\r\n            {/* Author Card */}\r\n            <div className=\"bg-white dark:bg-dark-surface rounded-2xl border border-gray-200 dark:border-dark-border p-6\">\r\n              <h3 className=\"font-semibold text-sm uppercase tracking-wider text-text-light dark:text-dark-text-muted mb-4\">\r\n                About the Author\r\n              </h3>\r\n              <Link\r\n                href={`/profile/${post.author_id}`}\r\n                className=\"flex items-start gap-4 group\"\r\n              >\r\n                {post.author?.avatar_url ? (\r\n                  <img\r\n                    src={post.author.avatar_url}\r\n                    alt={authorDisplay}\r\n                    className=\"w-14 h-14 rounded-2xl object-cover flex-shrink-0 group-hover:scale-105 transition-transform\"\r\n                  />\r\n                ) : (\r\n                  <div className=\"w-14 h-14 rounded-2xl bg-gradient-to-br from-primary to-secondary flex items-center justify-center text-xl font-bold text-white flex-shrink-0 group-hover:scale-105 transition-transform\">\r\n                    {(post.author?.name?.[0] || post.author?.email?.[0] || 'U').toUpperCase()}\r\n                  </div>\r\n                )}\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <p className=\"font-semibold text-text dark:text-dark-text group-hover:text-primary dark:group-hover:text-primary-light transition-colors\">\r\n                    {authorDisplay}\r\n                  </p>\r\n                  {post.author?.affiliation && (\r\n                    <p className=\"text-sm text-text-light dark:text-dark-text-muted truncate\">\r\n                      {post.author.affiliation}\r\n                    </p>\r\n                  )}\r\n                  {post.author?.bio && (\r\n                    <p className=\"text-sm text-text-light dark:text-dark-text-muted line-clamp-2 mt-2\">\r\n                      {post.author.bio}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              </Link>\r\n            </div>\r\n\r\n            {/* Related Posts */}\r\n            {relatedPosts.length > 0 && (\r\n              <div className=\"bg-white dark:bg-dark-surface rounded-2xl border border-gray-200 dark:border-dark-border p-6\">\r\n                <h3 className=\"font-semibold text-sm uppercase tracking-wider text-text-light dark:text-dark-text-muted mb-4\">\r\n                  Related Research\r\n                </h3>\r\n                <div className=\"space-y-4\">\r\n                  {relatedPosts.slice(0, 4).map((relPost: any) => (\r\n                    <Link\r\n                      key={relPost.id}\r\n                      href={`/post/${relPost.id}`}\r\n                      className=\"block group\"\r\n                    >\r\n                      <h4 className=\"font-medium text-text dark:text-dark-text group-hover:text-primary dark:group-hover:text-primary-light transition-colors line-clamp-2 text-sm\">\r\n                        {relPost.title}\r\n                      </h4>\r\n                      <p className=\"text-xs text-text-light dark:text-dark-text-muted mt-1\">\r\n                        {new Date(relPost.created_at).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\r\n                      </p>\r\n                    </Link>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Citation Backlinks */}\r\n            {citationBacklinks.length > 0 && (\r\n              <div className=\"bg-white dark:bg-dark-surface rounded-2xl border border-gray-200 dark:border-dark-border p-6\">\r\n                <h3 className=\"font-semibold text-sm uppercase tracking-wider text-text-light dark:text-dark-text-muted mb-4\">\r\n                  Cited By\r\n                </h3>\r\n                <div className=\"space-y-4\">\r\n                  {citationBacklinks.slice(0, 4).map((citation: any) => (\r\n                    <Link\r\n                      key={citation.id}\r\n                      href={`/post/${citation.id}`}\r\n                      className=\"block group\"\r\n                    >\r\n                      <h4 className=\"font-medium text-text dark:text-dark-text group-hover:text-primary dark:group-hover:text-primary-light transition-colors line-clamp-2 text-sm\">\r\n                        {citation.title}\r\n                      </h4>\r\n                      {citation.quote_content && (\r\n                        <p className=\"text-xs text-text-light dark:text-dark-text-muted mt-1 italic line-clamp-2\">\r\n                          \"{citation.quote_content}\"\r\n                        </p>\r\n                      )}\r\n                    </Link>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Linked Resources */}\r\n            <LinkedResourcesSection resources={linkedResources} />\r\n\r\n            {/* Knowledge Graph */}\r\n            <div className=\"bg-white dark:bg-dark-surface rounded-2xl border border-gray-200 dark:border-dark-border p-6\">\r\n              <h3 className=\"font-semibold text-sm uppercase tracking-wider text-text-light dark:text-dark-text-muted mb-4\">\r\n                Knowledge Graph\r\n              </h3>\r\n              <KnowledgeGraph centerPostId={post.id} />\r\n            </div>\r\n\r\n            {/* Epistemic Recommendations - To Broaden This Inquiry */}\r\n            <EpistemicRecommendations postId={post.id} postTags={post.tags || []} />\r\n          </aside>\r\n        </div>\r\n      </main>\r\n\r\n      {/* Session Tracker - adds post to research trail */}\r\n      <PostSessionTracker postId={post.id} postTitle={post.title} postTags={post.tags || []} />\r\n\r\n      {/* Citation Context Bar */}\r\n      <CitationContextBar postId={post.id} currentTags={post.tags || []} />\r\n\r\n      <Footer />\r\n    </div>\r\n  )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\post\\[id]\\suggestions\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\profile\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\profile\\[id]\\profile_enhanced.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\profile\\edit\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\questions\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\questions\\ask\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\questions\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\research-lab\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\research-lab\\polls\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\research-lab\\question-advisor\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\research-lab\\search\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\research-lab\\statistics\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\research-lab\\surveys\\[id]\\edit\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\research-lab\\surveys\\[id]\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":231,"column":67,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12277,12403],"text":"\r\n                                    No questions added yet. Click &quot;Edit\" to add questions.\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12277,12403],"text":"\r\n                                    No questions added yet. Click &ldquo;Edit\" to add questions.\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12277,12403],"text":"\r\n                                    No questions added yet. Click &#34;Edit\" to add questions.\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12277,12403],"text":"\r\n                                    No questions added yet. Click &rdquo;Edit\" to add questions.\r\n                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":231,"column":72,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12277,12403],"text":"\r\n                                    No questions added yet. Click \"Edit&quot; to add questions.\r\n                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12277,12403],"text":"\r\n                                    No questions added yet. Click \"Edit&ldquo; to add questions.\r\n                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12277,12403],"text":"\r\n                                    No questions added yet. Click \"Edit&#34; to add questions.\r\n                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12277,12403],"text":"\r\n                                    No questions added yet. Click \"Edit&rdquo; to add questions.\r\n                                "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from '@/lib/supabase/server'\r\nimport { Navbar } from '@/components/Navbar'\r\nimport { Footer } from '@/components/Footer'\r\nimport { ResearchLabNav } from '@/components/research-lab/ResearchLabNav'\r\nimport { SurveyAuthorActions } from '@/components/research-lab/SurveyAuthorActions'\r\nimport { notFound, redirect } from 'next/navigation'\r\nimport Link from 'next/link'\r\nimport {\r\n    ArrowLeft,\r\n    Edit,\r\n    BarChart2,\r\n    Calendar,\r\n    Users,\r\n    Lock,\r\n    Globe\r\n} from 'lucide-react'\r\nimport { formatDistanceToNow } from 'date-fns'\r\nimport { SurveyTakeForm } from '@/components/research-lab/SurveyTakeForm'\r\n\r\ninterface PageProps {\r\n    params: Promise<{ id: string; locale: string }>\r\n}\r\n\r\nconst statusColors = {\r\n    draft: 'bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300',\r\n    active: 'bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400',\r\n    closed: 'bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400',\r\n    archived: 'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400'\r\n}\r\n\r\nexport default async function SurveyPage({ params }: PageProps) {\r\n    const { id } = await params\r\n    const supabase = await createClient()\r\n    const { data: { user } } = await supabase.auth.getUser()\r\n\r\n    // Fetch survey with questions\r\n    const { data: survey, error } = await supabase\r\n        .from('surveys')\r\n        .select(`\r\n            *,\r\n            author:users!author_id(id, name, email, avatar_url)\r\n        `)\r\n        .eq('id', id)\r\n        .single()\r\n\r\n    if (error || !survey) {\r\n        notFound()\r\n    }\r\n\r\n    // Fetch questions\r\n    const { data: questions } = await supabase\r\n        .from('survey_questions')\r\n        .select('*')\r\n        .eq('survey_id', id)\r\n        .order('order_index', { ascending: true })\r\n\r\n    // Check if user has already responded\r\n    let hasResponded = false\r\n    if (user && !survey.allow_multiple_responses) {\r\n        const { data: existingResponse } = await supabase\r\n            .from('survey_responses')\r\n            .select('id')\r\n            .eq('survey_id', id)\r\n            .eq('respondent_id', user.id)\r\n            .single()\r\n\r\n        hasResponded = !!existingResponse\r\n    }\r\n\r\n    const isAuthor = user?.id === survey.author_id\r\n    const canTakeSurvey = survey.status === 'active' && !isAuthor && !hasResponded\r\n\r\n    // If not the author and survey is not active, show appropriate message\r\n    if (!isAuthor && survey.status !== 'active') {\r\n        return (\r\n            <div className=\"min-h-screen bg-background dark:bg-dark-bg flex flex-col\">\r\n                <Navbar user={user} />\r\n                <div className=\"flex flex-1\">\r\n                    <div className=\"hidden lg:block\">\r\n                        <ResearchLabNav />\r\n                    </div>\r\n                    <main className=\"flex-1 container-custom py-8\">\r\n                        <div className=\"text-center py-16\">\r\n                            <Lock className=\"w-16 h-16 mx-auto text-gray-300 dark:text-dark-text-muted mb-4\" />\r\n                            <h1 className=\"text-2xl font-bold text-text dark:text-dark-text mb-2\">\r\n                                Survey Not Available\r\n                            </h1>\r\n                            <p className=\"text-text-light dark:text-dark-text-muted mb-6\">\r\n                                This survey is currently not accepting responses.\r\n                            </p>\r\n                            <Link\r\n                                href=\"/research-lab/surveys\"\r\n                                className=\"btn btn-primary\"\r\n                            >\r\n                                Browse Surveys\r\n                            </Link>\r\n                        </div>\r\n                    </main>\r\n                </div>\r\n                <Footer />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-background dark:bg-dark-bg flex flex-col\">\r\n            <Navbar user={user} />\r\n\r\n            <div className=\"flex flex-1\">\r\n                <div className=\"hidden lg:block\">\r\n                    <ResearchLabNav />\r\n                </div>\r\n\r\n                <main className=\"flex-1 container-custom py-8\">\r\n                    {/* Back button */}\r\n                    <Link\r\n                        href=\"/research-lab/surveys\"\r\n                        className=\"inline-flex items-center gap-2 text-text-light dark:text-dark-text-muted hover:text-primary transition-colors mb-6\"\r\n                    >\r\n                        <ArrowLeft className=\"w-4 h-4\" />\r\n                        Back to Surveys\r\n                    </Link>\r\n\r\n                    {/* Survey Header */}\r\n                    <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-6 mb-6\">\r\n                        <div className=\"flex flex-col md:flex-row md:items-start justify-between gap-4 mb-4\">\r\n                            <div className=\"flex-1\">\r\n                                <div className=\"flex items-center gap-3 mb-2\">\r\n                                    <h1 className=\"text-2xl font-display font-bold text-text dark:text-dark-text\">\r\n                                        {survey.title}\r\n                                    </h1>\r\n                                    <span className={`px-2 py-0.5 rounded-full text-xs font-medium ${statusColors[survey.status as keyof typeof statusColors]}`}>\r\n                                        {survey.status.charAt(0).toUpperCase() + survey.status.slice(1)}\r\n                                    </span>\r\n                                </div>\r\n                                {survey.description && (\r\n                                    <p className=\"text-text-light dark:text-dark-text-muted mb-4\">\r\n                                        {survey.description}\r\n                                    </p>\r\n                                )}\r\n                                <div className=\"flex flex-wrap items-center gap-4 text-sm text-text-light dark:text-dark-text-muted\">\r\n                                    <span className=\"flex items-center gap-1.5\">\r\n                                        <Users className=\"w-4 h-4\" />\r\n                                        {survey.response_count || 0} responses\r\n                                    </span>\r\n                                    <span className=\"flex items-center gap-1.5\">\r\n                                        <Calendar className=\"w-4 h-4\" />\r\n                                        Created {formatDistanceToNow(new Date(survey.created_at), { addSuffix: true })}\r\n                                    </span>\r\n                                    <span className=\"flex items-center gap-1.5\">\r\n                                        {survey.is_anonymous ? (\r\n                                            <>\r\n                                                <Lock className=\"w-4 h-4\" />\r\n                                                Anonymous\r\n                                            </>\r\n                                        ) : (\r\n                                            <>\r\n                                                <Globe className=\"w-4 h-4\" />\r\n                                                Identified\r\n                                            </>\r\n                                        )}\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Author Actions */}\r\n                            {isAuthor && (\r\n                                <SurveyAuthorActions\r\n                                    surveyId={id}\r\n                                    surveyTitle={survey.title}\r\n                                    publicToken={survey.public_token}\r\n                                    allowPublicResponses={survey.allow_public_responses}\r\n                                />\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Author Info */}\r\n                        <div className=\"pt-4 border-t border-gray-200 dark:border-dark-border\">\r\n                            <p className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                                Created by{' '}\r\n                                <span className=\"font-medium text-text dark:text-dark-text\">\r\n                                    {survey.author?.name || survey.author?.email?.split('@')[0] || 'Anonymous'}\r\n                                </span>\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Survey Content */}\r\n                    {isAuthor ? (\r\n                        // Author Preview\r\n                        <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-6\">\r\n                            <h2 className=\"text-lg font-semibold text-text dark:text-dark-text mb-4\">\r\n                                Survey Preview ({questions?.length || 0} questions)\r\n                            </h2>\r\n                            {questions && questions.length > 0 ? (\r\n                                <div className=\"space-y-4\">\r\n                                    {questions.map((question: Record<string, unknown>, index: number) => (\r\n                                        <div\r\n                                            key={question.id as string}\r\n                                            className=\"p-4 bg-gray-50 dark:bg-dark-bg rounded-lg border border-gray-200 dark:border-dark-border\"\r\n                                        >\r\n                                            <div className=\"flex items-start gap-3\">\r\n                                                <span className=\"flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 text-primary text-sm font-medium flex items-center justify-center\">\r\n                                                    {index + 1}\r\n                                                </span>\r\n                                                <div className=\"flex-1\">\r\n                                                    <p className=\"font-medium text-text dark:text-dark-text\">\r\n                                                        {question.question_text as string}\r\n                                                        {Boolean(question.required) && <span className=\"text-red-500 ml-1\">*</span>}\r\n                                                    </p>\r\n                                                    <p className=\"text-sm text-text-light dark:text-dark-text-muted mt-1\">\r\n                                                        Type: {(question.question_type as string).replace('_', ' ')}\r\n                                                    </p>\r\n                                                    {Array.isArray(question.options) && question.options.length > 0 && (\r\n                                                        <div className=\"mt-2 space-y-1\">\r\n                                                            {(question.options as Array<{ id: string; text: string }>).map((opt) => (\r\n                                                                <div key={opt.id} className=\"text-sm text-text-light dark:text-dark-text-muted flex items-center gap-2\">\r\n                                                                    <span className=\"w-3 h-3 rounded-full border border-gray-300 dark:border-dark-border\"></span>\r\n                                                                    {opt.text}\r\n                                                                </div>\r\n                                                            ))}\r\n                                                        </div>\r\n                                                    )}\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            ) : (\r\n                                <p className=\"text-center text-text-light dark:text-dark-text-muted py-8\">\r\n                                    No questions added yet. Click \"Edit\" to add questions.\r\n                                </p>\r\n                            )}\r\n                        </div>\r\n                    ) : canTakeSurvey ? (\r\n                        // Take Survey Form\r\n                        <SurveyTakeForm\r\n                            surveyId={id}\r\n                            questions={questions || []}\r\n                            isAnonymous={survey.is_anonymous}\r\n                        />\r\n                    ) : hasResponded ? (\r\n                        // Already Responded\r\n                        <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-8 text-center\">\r\n                            <div className=\"w-16 h-16 mx-auto bg-emerald-100 dark:bg-emerald-900/30 rounded-full flex items-center justify-center mb-4\">\r\n                                <svg className=\"w-8 h-8 text-emerald-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\r\n                                </svg>\r\n                            </div>\r\n                            <h2 className=\"text-xl font-semibold text-text dark:text-dark-text mb-2\">\r\n                                Thank you for your response!\r\n                            </h2>\r\n                            <p className=\"text-text-light dark:text-dark-text-muted\">\r\n                                You have already submitted a response to this survey.\r\n                            </p>\r\n                        </div>\r\n                    ) : null}\r\n                </main>\r\n            </div>\r\n\r\n            <Footer />\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\research-lab\\surveys\\[id]\\results\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\research-lab\\surveys\\create\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\research-lab\\surveys\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\resources\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\resources\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\resources\\upload\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\s\\[token]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\saved\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\search\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\settings\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\[locale]\\waitlist\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\analytics\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\appeals\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\auth\\login\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\auth\\logout\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\auth\\signup\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\auth\\user\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\bookmarks\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\citations\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\citations\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\comments\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\comments\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\coordination\\[threadId]\\messages\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\coordination\\[threadId]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\coordination\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\export\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\health\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\invite\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\jury\\create\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\jury\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\og\\route.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\plagiarism\\check\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\polls\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\polls\\[id]\\vote\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\polls\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\posts\\[id]\\accept\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\posts\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\posts\\[id]\\view\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\posts\\[id]\\vote\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\posts\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\public\\poll\\[token]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\public\\survey\\[token]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\question-advisor\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\report\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\reports\\[id]\\delete\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\reports\\[id]\\dismiss\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\reports\\[id]\\resolve\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\reports\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\reports\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\research-search\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\resources\\search\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\reviews\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\roles\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\saved-references\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\saved-searches\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\search\\analytics\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\search\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\search\\suggestions\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\surveys\\[id]\\respond\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\surveys\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\surveys\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\tags\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\users\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\users\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\waitlist\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\api\\web-search\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\robots.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\app\\sitemap.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\check_post_anon.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\check_recent_post.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\check_rsvps_table.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\AboutLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\AchievementCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ActivityFeed.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\AdminWaitlistDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\AdvancedSearchFilters.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\AnswerCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\AnswerForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\AnswerList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\AppErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\AppealButton.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":117,"column":83,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[4317,4318],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[4317,4318],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[4317,4318],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[4317,4318],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":117,"column":95,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[4329,4330],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[4329,4330],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[4329,4330],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[4329,4330],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":165,"column":50,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[7738,7793],"text":"ΓÇó You&apos;ll receive a notification when a decision is made"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[7738,7793],"text":"ΓÇó You&lsquo;ll receive a notification when a decision is made"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[7738,7793],"text":"ΓÇó You&#39;ll receive a notification when a decision is made"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[7738,7793],"text":"ΓÇó You&rsquo;ll receive a notification when a decision is made"},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useMemo } from 'react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { Scale, Send, Loader2, CheckCircle, AlertCircle } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from '@/components/ui/dialog'\r\nimport { useToast } from '@/components/ui/toast'\r\n\r\n\r\ninterface AppealButtonProps {\r\n    postId: string\r\n    postTitle?: string\r\n    onAppealSubmitted?: () => void\r\n}\r\n\r\n/**\r\n * AppealButton allows authors of flagged posts to dispute the moderation decision.\r\n * Only visible when post is flagged and user is the author.\r\n */\r\nexport function AppealButton({ postId, postTitle, onAppealSubmitted }: AppealButtonProps) {\r\n    const [isOpen, setIsOpen] = useState(false)\r\n    const [reason, setReason] = useState('')\r\n    const [submitting, setSubmitting] = useState(false)\r\n    const [submitted, setSubmitted] = useState(false)\r\n    const [error, setError] = useState<string | null>(null)\r\n    const supabase = useMemo(() => createClient(), [])\r\n    const { showToast } = useToast()\r\n\r\n\r\n    async function handleSubmit() {\r\n        if (!reason.trim()) {\r\n            setError('Please provide a reason for your appeal.')\r\n            return\r\n        }\r\n\r\n        if (reason.trim().length < 20) {\r\n            setError('Please provide a more detailed explanation (at least 20 characters).')\r\n            return\r\n        }\r\n\r\n        setSubmitting(true)\r\n        setError(null)\r\n\r\n        try {\r\n            // Get current user\r\n            const { data: { user } } = await supabase.auth.getUser()\r\n            if (!user) {\r\n                throw new Error('You must be logged in to submit an appeal.')\r\n            }\r\n\r\n            // Check if appeal already exists\r\n            const { data: existingAppeal } = await supabase\r\n                .from('moderation_appeals')\r\n                .select('id, status')\r\n                .eq('post_id', postId)\r\n                .eq('user_id', user.id)\r\n                .single()\r\n\r\n            if (existingAppeal) {\r\n                if (existingAppeal.status === 'pending') {\r\n                    throw new Error('You already have a pending appeal for this post.')\r\n                } else if (existingAppeal.status === 'rejected') {\r\n                    throw new Error('Your previous appeal was rejected. You cannot submit another appeal.')\r\n                }\r\n            }\r\n\r\n            // Submit appeal\r\n            const { error: insertError } = await supabase\r\n                .from('moderation_appeals')\r\n                .insert({\r\n                    post_id: postId,\r\n                    user_id: user.id,\r\n                    dispute_reason: reason.trim()\r\n                })\r\n\r\n            if (insertError) throw insertError\r\n\r\n            setSubmitted(true)\r\n            showToast('Appeal submitted successfully!', 'success')\r\n            onAppealSubmitted?.()\r\n\r\n            // Close after a moment\r\n            setTimeout(() => {\r\n                setIsOpen(false)\r\n                setSubmitted(false)\r\n                setReason('')\r\n            }, 2000)\r\n\r\n        } catch (err: any) {\r\n            setError(err.message || 'Failed to submit appeal. Please try again.')\r\n        } finally {\r\n            setSubmitting(false)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => setIsOpen(true)}\r\n                className=\"gap-2 text-orange-600 dark:text-orange-400 border-orange-200 dark:border-orange-800 hover:bg-orange-50 dark:hover:bg-orange-900/20\"\r\n            >\r\n                <Scale className=\"w-4 h-4\" />\r\n                Appeal Decision\r\n            </Button>\r\n\r\n            <Dialog open={isOpen} onOpenChange={setIsOpen}>\r\n                <DialogContent className=\"max-w-lg\">\r\n                    <DialogHeader>\r\n                        <DialogTitle className=\"flex items-center gap-2\">\r\n                            <Scale className=\"w-5 h-5 text-orange-500\" />\r\n                            Appeal Content Flag\r\n                        </DialogTitle>\r\n                        <DialogDescription>\r\n                            Your post {postTitle && <span className=\"font-medium\">\"{postTitle}\"</span>} has been flagged for review.\r\n                            If you believe this was a mistake, you can submit an appeal.\r\n                        </DialogDescription>\r\n                    </DialogHeader>\r\n\r\n                    {submitted ? (\r\n                        <div className=\"py-8 text-center\">\r\n                            <CheckCircle className=\"w-12 h-12 text-green-500 mx-auto mb-4\" />\r\n                            <h3 className=\"font-semibold text-lg mb-2\">Appeal Submitted!</h3>\r\n                            <p className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                                Our moderation team will review your appeal and respond shortly.\r\n                            </p>\r\n                        </div>\r\n                    ) : (\r\n                        <>\r\n                            <div className=\"space-y-4 py-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium mb-2\">\r\n                                        Why should this decision be reversed?\r\n                                    </label>\r\n                                    <textarea\r\n                                        value={reason}\r\n                                        onChange={(e) => {\r\n                                            setReason(e.target.value)\r\n                                            setError(null)\r\n                                        }}\r\n                                        placeholder=\"Please explain why you believe your content was incorrectly flagged. Be specific and provide context...\"\r\n                                        className=\"w-full h-32 px-3 py-2 rounded-lg border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text placeholder:text-text-light dark:placeholder:text-dark-text-muted focus:outline-none focus:ring-2 focus:ring-primary resize-none\"\r\n                                        disabled={submitting}\r\n                                    />\r\n                                    <p className=\"text-xs text-text-light dark:text-dark-text-muted mt-1\">\r\n                                        {reason.length}/500 characters\r\n                                    </p>\r\n                                </div>\r\n\r\n                                {error && (\r\n                                    <div className=\"flex items-start gap-2 p-3 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-400 text-sm\">\r\n                                        <AlertCircle className=\"w-4 h-4 flex-shrink-0 mt-0.5\" />\r\n                                        <span>{error}</span>\r\n                                    </div>\r\n                                )}\r\n\r\n                                <div className=\"p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800\">\r\n                                    <h4 className=\"font-medium text-sm text-blue-700 dark:text-blue-400 mb-1\">\r\n                                        What happens next?\r\n                                    </h4>\r\n                                    <ul className=\"text-xs text-blue-600 dark:text-blue-300 space-y-1\">\r\n                                        <li>ΓÇó Your appeal will be reviewed by our moderation team</li>\r\n                                        <li>ΓÇó You'll receive a notification when a decision is made</li>\r\n                                        <li>ΓÇó If approved, your content will be restored</li>\r\n                                    </ul>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <DialogFooter>\r\n                                <Button\r\n                                    variant=\"outline\"\r\n                                    onClick={() => setIsOpen(false)}\r\n                                    disabled={submitting}\r\n                                >\r\n                                    Cancel\r\n                                </Button>\r\n                                <Button\r\n                                    onClick={handleSubmit}\r\n                                    disabled={submitting || !reason.trim()}\r\n                                    className=\"gap-2\"\r\n                                >\r\n                                    {submitting ? (\r\n                                        <>\r\n                                            <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                                            Submitting...\r\n                                        </>\r\n                                    ) : (\r\n                                        <>\r\n                                            <Send className=\"w-4 h-4\" />\r\n                                            Submit Appeal\r\n                                        </>\r\n                                    )}\r\n                                </Button>\r\n                            </DialogFooter>\r\n                        </>\r\n                    )}\r\n                </DialogContent>\r\n            </Dialog>\r\n        </>\r\n    )\r\n}\r\n\r\n/**\r\n * Inline appeal status badge\r\n */\r\nexport function AppealStatus({ status }: { status: 'pending' | 'approved' | 'rejected' }) {\r\n    const config = {\r\n        pending: {\r\n            label: 'Appeal Pending',\r\n            className: 'bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400'\r\n        },\r\n        approved: {\r\n            label: 'Appeal Approved',\r\n            className: 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400'\r\n        },\r\n        rejected: {\r\n            label: 'Appeal Rejected',\r\n            className: 'bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400'\r\n        }\r\n    }\r\n\r\n    const { label, className } = config[status]\r\n\r\n    return (\r\n        <span className={`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${className}`}>\r\n            <Scale className=\"w-3 h-3\" />\r\n            {label}\r\n        </span>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\AuthForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\BadgeDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\BentoGrid.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\BookmarkButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\CitationBacklinks.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\CitationContextBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\CollaboratorAvatars.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":61,"column":29,"nodeType":"JSXOpeningElement","endLine":65,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { Users } from 'lucide-react'\r\n\r\ninterface CollaboratorAvatarsProps {\r\n    collaborators: {\r\n        id: string\r\n        name: string\r\n        avatar_url?: string\r\n        color: string\r\n    }[]\r\n    isConnected: boolean\r\n    userColor: string\r\n}\r\n\r\n/**\r\n * Displays avatars of users currently viewing/editing the same document\r\n */\r\nexport function CollaboratorAvatars({ collaborators, isConnected, userColor }: CollaboratorAvatarsProps) {\r\n    if (!isConnected) {\r\n        return (\r\n            <div className=\"flex items-center gap-2 text-sm text-text-light dark:text-dark-text-muted\">\r\n                <span className=\"w-2 h-2 rounded-full bg-gray-400 animate-pulse\" />\r\n                Connecting...\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const totalCount = collaborators.length + 1 // +1 for current user\r\n    const displayAvatars = collaborators.slice(0, 3)\r\n    const extraCount = collaborators.length > 3 ? collaborators.length - 3 : 0\r\n\r\n    return (\r\n        <div className=\"flex items-center gap-3\">\r\n            {/* Connection indicator */}\r\n            <div className=\"flex items-center gap-1.5 text-xs text-secondary-dark dark:text-secondary\">\r\n                <span className=\"w-2 h-2 rounded-full bg-secondary animate-pulse\" />\r\n                Live\r\n            </div>\r\n\r\n            {/* Avatars */}\r\n            <div className=\"flex -space-x-2\">\r\n                {/* Current user (you) */}\r\n                <div\r\n                    className=\"w-8 h-8 rounded-full border-2 border-white dark:border-dark-surface flex items-center justify-center text-white text-xs font-bold z-10\"\r\n                    style={{ backgroundColor: userColor }}\r\n                    title=\"You\"\r\n                >\r\n                    You\r\n                </div>\r\n\r\n                {/* Collaborators */}\r\n                {displayAvatars.map((collab, index) => (\r\n                    <div\r\n                        key={collab.id}\r\n                        className=\"w-8 h-8 rounded-full border-2 border-white dark:border-dark-surface overflow-hidden\"\r\n                        style={{ zIndex: 9 - index }}\r\n                        title={collab.name}\r\n                    >\r\n                        {collab.avatar_url ? (\r\n                            <img\r\n                                src={collab.avatar_url}\r\n                                alt={collab.name}\r\n                                className=\"w-full h-full object-cover\"\r\n                            />\r\n                        ) : (\r\n                            <div\r\n                                className=\"w-full h-full flex items-center justify-center text-white text-xs font-bold\"\r\n                                style={{ backgroundColor: collab.color }}\r\n                            >\r\n                                {collab.name.charAt(0).toUpperCase()}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                ))}\r\n\r\n                {/* Extra count badge */}\r\n                {extraCount > 0 && (\r\n                    <div className=\"w-8 h-8 rounded-full border-2 border-white dark:border-dark-surface bg-gray-200 dark:bg-dark-border flex items-center justify-center text-xs font-bold text-text dark:text-dark-text z-0\">\r\n                        +{extraCount}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Viewer count */}\r\n            <div className=\"flex items-center gap-1.5 text-sm text-text-light dark:text-dark-text-muted\">\r\n                <Users className=\"w-4 h-4\" />\r\n                <span>{totalCount} {totalCount === 1 ? 'viewer' : 'viewers'}</span>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\CommentTree.tsx","messages":[{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/login/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":285,"column":25,"nodeType":"JSXOpeningElement","endLine":285,"endColumn":106},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/login/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":285,"column":25,"nodeType":"JSXOpeningElement","endLine":285,"endColumn":106},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/login/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":285,"column":25,"nodeType":"JSXOpeningElement","endLine":285,"endColumn":106},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/login/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":285,"column":25,"nodeType":"JSXOpeningElement","endLine":285,"endColumn":106},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/login/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":285,"column":25,"nodeType":"JSXOpeningElement","endLine":285,"endColumn":106},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/login/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":285,"column":25,"nodeType":"JSXOpeningElement","endLine":285,"endColumn":106},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/login/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":285,"column":25,"nodeType":"JSXOpeningElement","endLine":285,"endColumn":106},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/login/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":285,"column":25,"nodeType":"JSXOpeningElement","endLine":285,"endColumn":106},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/login/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":285,"column":25,"nodeType":"JSXOpeningElement","endLine":285,"endColumn":106},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/login/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":285,"column":25,"nodeType":"JSXOpeningElement","endLine":285,"endColumn":106}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { UserAvatar } from '@/components/ui/UserAvatar'\r\nimport { formatDistanceToNow } from 'date-fns'\r\nimport { MessageSquare, ChevronDown, ChevronUp, CornerDownRight, Loader2 } from 'lucide-react'\r\nimport { cn } from '@/lib/utils'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface Comment {\r\n    id: string\r\n    content: string\r\n    created_at: string\r\n    user_id: string\r\n    post_id: string\r\n    parent_id: string | null\r\n    user?: {\r\n        id: string\r\n        name: string\r\n        email: string\r\n        avatar_url?: string\r\n    }\r\n    children?: Comment[]\r\n}\r\n\r\ninterface CommentTreeProps {\r\n    postId: string\r\n    comments: Comment[]\r\n    onCommentAdded?: () => void\r\n}\r\n\r\ninterface CommentNodeProps {\r\n    comment: Comment\r\n    depth: number\r\n    postId: string\r\n    onReply: (parentId: string, content: string) => Promise<void>\r\n}\r\n\r\nfunction CommentNode({ comment, depth, postId, onReply }: CommentNodeProps) {\r\n    const t = useTranslations('Comments')\r\n    const tForms = useTranslations('Forms')\r\n    const tCommon = useTranslations('Common')\r\n    const [isCollapsed, setIsCollapsed] = useState(false)\r\n    const [isReplying, setIsReplying] = useState(false)\r\n    const [replyContent, setReplyContent] = useState('')\r\n    const [submitting, setSubmitting] = useState(false)\r\n\r\n    const handleSubmitReply = async () => {\r\n        if (!replyContent.trim()) return\r\n        setSubmitting(true)\r\n        try {\r\n            await onReply(comment.id, replyContent)\r\n            setReplyContent('')\r\n            setIsReplying(false)\r\n        } finally {\r\n            setSubmitting(false)\r\n        }\r\n    }\r\n\r\n    const hasChildren = comment.children && comment.children.length > 0\r\n    const maxDepth = 4 // Max visual nesting depth\r\n\r\n    return (\r\n        <div className={cn('relative', depth > 0 && 'ml-4 pl-4 border-l border-gray-200 dark:border-dark-border')}>\r\n            <div className=\"py-3\">\r\n                {/* Comment Header */}\r\n                <div className=\"flex items-start gap-3\">\r\n                    <UserAvatar\r\n                        name={comment.user?.name}\r\n                        email={comment.user?.email}\r\n                        avatarUrl={comment.user?.avatar_url}\r\n                        size=\"sm\"\r\n                    />\r\n                    <div className=\"flex-1 min-w-0\">\r\n                        <div className=\"flex items-center gap-2 flex-wrap\">\r\n                            <span className=\"text-sm font-medium text-text dark:text-dark-text\">\r\n                                {comment.user?.name || 'Anonymous'}\r\n                            </span>\r\n                            <span className=\"text-xs text-text-light dark:text-dark-text-muted\">\r\n                                {formatDistanceToNow(new Date(comment.created_at), { addSuffix: true })}\r\n                            </span>\r\n                        </div>\r\n\r\n                        {/* Comment Content */}\r\n                        <p className=\"mt-1 text-sm text-text dark:text-dark-text whitespace-pre-wrap\">\r\n                            {comment.content}\r\n                        </p>\r\n\r\n                        {/* Actions */}\r\n                        <div className=\"flex items-center gap-3 mt-2\">\r\n                            {depth < maxDepth && (\r\n                                <button\r\n                                    onClick={() => setIsReplying(!isReplying)}\r\n                                    className=\"text-xs text-text-light dark:text-dark-text-muted hover:text-text dark:hover:text-dark-text flex items-center gap-1\"\r\n                                >\r\n                                    <CornerDownRight className=\"w-3 h-3\" />\r\n                                    {t('reply')}\r\n                                </button>\r\n                            )}\r\n\r\n                            {hasChildren && (\r\n                                <button\r\n                                    onClick={() => setIsCollapsed(!isCollapsed)}\r\n                                    className=\"text-xs text-text-light dark:text-dark-text-muted hover:text-text dark:hover:text-dark-text flex items-center gap-1\"\r\n                                >\r\n                                    {isCollapsed ? (\r\n                                        <>\r\n                                            <ChevronDown className=\"w-3 h-3\" />\r\n                                            Show {comment.children!.length} {comment.children!.length === 1 ? 'reply' : 'replies'}\r\n                                        </>\r\n                                    ) : (\r\n                                        <>\r\n                                            <ChevronUp className=\"w-3 h-3\" />\r\n                                            {t('hideReplies')}\r\n                                        </>\r\n                                    )}\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Reply Form */}\r\n                        {isReplying && (\r\n                            <div className=\"mt-3 space-y-2\">\r\n                                <textarea\r\n                                    value={replyContent}\r\n                                    onChange={(e) => setReplyContent(e.target.value)}\r\n                                    placeholder={tForms('writeReply')}\r\n                                    rows={2}\r\n                                    className=\"w-full px-3 py-2 text-sm rounded-md border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-surface text-text dark:text-dark-text resize-none focus:outline-none focus:ring-1 focus:ring-primary\"\r\n                                />\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <button\r\n                                        onClick={handleSubmitReply}\r\n                                        disabled={submitting || !replyContent.trim()}\r\n                                        className=\"px-3 py-1 text-xs font-medium rounded-md bg-primary text-white hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                                    >\r\n                                        {submitting ? (\r\n                                            <Loader2 className=\"w-3 h-3 animate-spin\" />\r\n                                        ) : (\r\n                                            'Reply'\r\n                                        )}\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => setIsReplying(false)}\r\n                                        className=\"px-3 py-1 text-xs text-text-light dark:text-dark-text-muted hover:text-text dark:hover:text-dark-text\"\r\n                                    >\r\n                                        {tCommon('cancel')}\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Children */}\r\n            {hasChildren && !isCollapsed && (\r\n                <div>\r\n                    {comment.children!.map((child) => (\r\n                        <CommentNode\r\n                            key={child.id}\r\n                            comment={child}\r\n                            depth={depth + 1}\r\n                            postId={postId}\r\n                            onReply={onReply}\r\n                        />\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport function CommentTree({ postId, comments, onCommentAdded }: CommentTreeProps) {\r\n    const router = useRouter()\r\n    const supabase = createClient()\r\n    const [user, setUser] = useState<any>(null)\r\n    const [newComment, setNewComment] = useState('')\r\n    const [submitting, setSubmitting] = useState(false)\r\n\r\n    useEffect(() => {\r\n        supabase.auth.getUser().then(({ data: { user } }) => {\r\n            setUser(user)\r\n        })\r\n    }, [supabase])\r\n\r\n    // Build tree structure from flat comments\r\n    const buildTree = (flatComments: Comment[]): Comment[] => {\r\n        const map = new Map<string, Comment>()\r\n        const roots: Comment[] = []\r\n\r\n        // First pass: create map\r\n        flatComments.forEach(comment => {\r\n            map.set(comment.id, { ...comment, children: [] })\r\n        })\r\n\r\n        // Second pass: build tree\r\n        flatComments.forEach(comment => {\r\n            const node = map.get(comment.id)!\r\n            if (comment.parent_id && map.has(comment.parent_id)) {\r\n                map.get(comment.parent_id)!.children!.push(node)\r\n            } else {\r\n                roots.push(node)\r\n            }\r\n        })\r\n\r\n        return roots\r\n    }\r\n\r\n    const commentTree = buildTree(comments)\r\n\r\n    const handleAddComment = async (parentId: string | null, content: string) => {\r\n        if (!user) {\r\n            router.push('/login')\r\n            return\r\n        }\r\n\r\n        try {\r\n            const { error } = await supabase.from('comments').insert({\r\n                post_id: postId,\r\n                user_id: user.id,\r\n                content,\r\n                parent_id: parentId,\r\n            })\r\n\r\n            if (error) throw error\r\n            onCommentAdded?.()\r\n        } catch (error) {\r\n            console.error('Error adding comment:', error)\r\n        }\r\n    }\r\n\r\n    const handleNewComment = async () => {\r\n        if (!newComment.trim()) return\r\n        setSubmitting(true)\r\n        try {\r\n            await handleAddComment(null, newComment)\r\n            setNewComment('')\r\n        } finally {\r\n            setSubmitting(false)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* New Comment Form */}\r\n            <div className=\"space-y-3\">\r\n                <h3 className=\"text-sm font-medium text-text dark:text-dark-text flex items-center gap-2\">\r\n                    <MessageSquare className=\"w-4 h-4\" />\r\n                    {comments.length} Comment{comments.length !== 1 ? 's' : ''}\r\n                </h3>\r\n\r\n                {user ? (\r\n                    <div className=\"flex gap-3\">\r\n                        <UserAvatar\r\n                            name={user.user_metadata?.name}\r\n                            email={user.email}\r\n                            avatarUrl={user.user_metadata?.avatar_url}\r\n                            size=\"sm\"\r\n                        />\r\n                        <div className=\"flex-1 space-y-2\">\r\n                            <textarea\r\n                                value={newComment}\r\n                                onChange={(e) => setNewComment(e.target.value)}\r\n                                placeholder=\"Write a comment...\"\r\n                                rows={3}\r\n                                className=\"w-full px-3 py-2 text-sm rounded-md border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-surface text-text dark:text-dark-text resize-none focus:outline-none focus:ring-1 focus:ring-primary\"\r\n                            />\r\n                            <button\r\n                                onClick={handleNewComment}\r\n                                disabled={submitting || !newComment.trim()}\r\n                                className=\"px-4 py-1.5 text-sm font-medium rounded-md bg-primary text-white hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                            >\r\n                                {submitting ? (\r\n                                    <Loader2 className=\"w-4 h-4 animate-spin inline mr-1\" />\r\n                                ) : null}\r\n                                Post Comment\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"text-center py-4 text-sm text-text-light dark:text-dark-text-muted\">\r\n                        <a href=\"/login\" className=\"text-primary dark:text-accent-light hover:underline\">\r\n                            Sign in\r\n                        </a>{' '}\r\n                        to join the discussion.\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Comments Tree */}\r\n            {commentTree.length > 0 ? (\r\n                <div className=\"divide-y divide-gray-100 dark:divide-dark-border\">\r\n                    {commentTree.map((comment) => (\r\n                        <CommentNode\r\n                            key={comment.id}\r\n                            comment={comment}\r\n                            depth={0}\r\n                            postId={postId}\r\n                            onReply={(parentId, content) => handleAddComment(parentId, content)}\r\n                        />\r\n                    ))}\r\n                </div>\r\n            ) : (\r\n                <p className=\"text-center py-8 text-sm text-text-light dark:text-dark-text-muted\">\r\n                    No comments yet. Be the first to share your thoughts.\r\n                </p>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\CommentsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ConflictWarning.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\CopyCitationButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\CoverImageUpload.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":117,"column":21,"nodeType":"JSXOpeningElement","endLine":121,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useCallback, useRef } from 'react'\r\nimport { ImagePlus, X, Loader2, Camera } from 'lucide-react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { useToast } from '@/components/ui/toast'\r\nimport { Button } from '@/components/ui/button'\r\n\r\ninterface CoverImageUploadProps {\r\n    value: string | null\r\n    onChange: (url: string | null) => void\r\n    userId: string\r\n    compact?: boolean\r\n}\r\n\r\nexport function CoverImageUpload({ value, onChange, userId, compact = false }: CoverImageUploadProps) {\r\n    const [uploading, setUploading] = useState(false)\r\n    const supabase = createClient()\r\n    const { showToast } = useToast()\r\n    const inputRef = useRef<HTMLInputElement>(null)\r\n\r\n    const handleUpload = useCallback(async (file: File) => {\r\n        if (!file) return\r\n\r\n        // Validate file type\r\n        if (!file.type.startsWith('image/')) {\r\n            showToast('Please upload an image file', 'error')\r\n            return\r\n        }\r\n\r\n        // Validate file size (5MB max)\r\n        if (file.size > 5 * 1024 * 1024) {\r\n            showToast('Image must be smaller than 5MB', 'error')\r\n            return\r\n        }\r\n\r\n        setUploading(true)\r\n\r\n        try {\r\n            const fileExt = file.name.split('.').pop()\r\n            const fileName = `covers/${userId}/${Date.now()}.${fileExt}`\r\n\r\n            const { error: uploadError } = await supabase.storage\r\n                .from('post_images')\r\n                .upload(fileName, file)\r\n\r\n            if (uploadError) throw uploadError\r\n\r\n            const { data: { publicUrl } } = supabase.storage\r\n                .from('post_images')\r\n                .getPublicUrl(fileName)\r\n\r\n            onChange(publicUrl)\r\n            showToast('Cover image uploaded!', 'success')\r\n        } catch (error) {\r\n            console.error('Upload failed:', error)\r\n            showToast('Failed to upload image', 'error')\r\n        } finally {\r\n            setUploading(false)\r\n        }\r\n    }, [supabase, userId, onChange, showToast])\r\n\r\n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0]\r\n        if (file) handleUpload(file)\r\n    }\r\n\r\n    const removeCover = () => {\r\n        onChange(null)\r\n    }\r\n\r\n    // Compact mode - just a button for corner placement\r\n    if (compact) {\r\n        return (\r\n            <div className=\"flex gap-2\">\r\n                <input\r\n                    ref={inputRef}\r\n                    type=\"file\"\r\n                    accept=\"image/*\"\r\n                    onChange={handleFileChange}\r\n                    className=\"hidden\"\r\n                />\r\n                <Button\r\n                    type=\"button\"\r\n                    size=\"sm\"\r\n                    onClick={() => inputRef.current?.click()}\r\n                    disabled={uploading}\r\n                    className=\"bg-black/60 hover:bg-black/80 text-white shadow-md gap-2 backdrop-blur-sm\"\r\n                >\r\n                    {uploading ? (\r\n                        <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                    ) : (\r\n                        <Camera className=\"w-4 h-4\" />\r\n                    )}\r\n                    {value ? 'Change Cover' : 'Add Cover'}\r\n                </Button>\r\n                {value && (\r\n                    <Button\r\n                        type=\"button\"\r\n                        size=\"sm\"\r\n                        onClick={removeCover}\r\n                        disabled={uploading}\r\n                        className=\"bg-red-500/90 hover:bg-red-500 text-white shadow-md\"\r\n                    >\r\n                        <X className=\"w-4 h-4\" />\r\n                    </Button>\r\n                )}\r\n            </div>\r\n        )\r\n    }\r\n\r\n    // Full mode with preview\r\n    if (value) {\r\n        return (\r\n            <div className=\"relative group\">\r\n                <div className=\"relative aspect-[21/9] rounded-2xl overflow-hidden border border-gray-200 dark:border-dark-border\">\r\n                    <img\r\n                        src={value}\r\n                        alt=\"Cover preview\"\r\n                        className=\"w-full h-full object-cover\"\r\n                    />\r\n                    <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3\">\r\n                        <input\r\n                            ref={inputRef}\r\n                            type=\"file\"\r\n                            accept=\"image/*\"\r\n                            onChange={handleFileChange}\r\n                            className=\"hidden\"\r\n                        />\r\n                        <Button\r\n                            type=\"button\"\r\n                            onClick={() => inputRef.current?.click()}\r\n                            className=\"bg-white text-gray-900 hover:bg-gray-100\"\r\n                        >\r\n                            <Camera className=\"w-4 h-4 mr-2\" />\r\n                            Change\r\n                        </Button>\r\n                        <Button\r\n                            type=\"button\"\r\n                            onClick={removeCover}\r\n                            variant=\"destructive\"\r\n                        >\r\n                            <X className=\"w-4 h-4 mr-2\" />\r\n                            Remove\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n                <p className=\"text-xs text-text-light dark:text-dark-text-muted mt-2 text-center\">\r\n                    Recommended: 1200├ù514px (21:9 aspect ratio)\r\n                </p>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    // Empty state - dropzone style\r\n    return (\r\n        <div\r\n            onClick={() => inputRef.current?.click()}\r\n            className=\"relative aspect-[21/9] rounded-2xl border-2 border-dashed cursor-pointer transition-all duration-200 border-gray-300 dark:border-dark-border hover:border-primary dark:hover:border-primary-light\"\r\n        >\r\n            <input\r\n                ref={inputRef}\r\n                type=\"file\"\r\n                accept=\"image/*\"\r\n                onChange={handleFileChange}\r\n                className=\"hidden\"\r\n            />\r\n            <div className=\"absolute inset-0 flex flex-col items-center justify-center p-6 text-center\">\r\n                {uploading ? (\r\n                    <>\r\n                        <Loader2 className=\"w-10 h-10 text-primary animate-spin mb-3\" />\r\n                        <p className=\"text-sm font-medium text-text dark:text-dark-text\">Uploading...</p>\r\n                    </>\r\n                ) : (\r\n                    <>\r\n                        <div className=\"w-14 h-14 rounded-2xl bg-gray-100 dark:bg-dark-surface flex items-center justify-center mb-4\">\r\n                            <ImagePlus className=\"w-7 h-7 text-text-light dark:text-dark-text-muted\" />\r\n                        </div>\r\n                        <p className=\"text-sm font-medium text-text dark:text-dark-text mb-1\">\r\n                            Add a cover image\r\n                        </p>\r\n                        <p className=\"text-xs text-text-light dark:text-dark-text-muted\">\r\n                            Click to upload\r\n                        </p>\r\n                        <p className=\"text-xs text-text-muted mt-2\">\r\n                            PNG, JPG, GIF, WEBP ΓÇó Max 5MB\r\n                        </p>\r\n                    </>\r\n                )}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default CoverImageUpload\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\DraftRecoveryBanner.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":43,"column":63,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[1721,1722],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[1721,1722],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[1721,1722],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[1721,1722],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":43,"column":136,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[1794,1795],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[1794,1795],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[1794,1795],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[1794,1795],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { RefreshCw, X, Clock } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { DraftData, formatTimeSince } from '@/lib/hooks/useAutosave'\r\n\r\ninterface DraftRecoveryBannerProps {\r\n    draftData: DraftData\r\n    onRestore: () => void\r\n    onDiscard: () => void\r\n}\r\n\r\nexport function DraftRecoveryBanner({\r\n    draftData,\r\n    onRestore,\r\n    onDiscard,\r\n}: DraftRecoveryBannerProps) {\r\n    const [timeAgo, setTimeAgo] = useState('')\r\n\r\n    useEffect(() => {\r\n        const updateTime = () => {\r\n            setTimeAgo(formatTimeSince(new Date(draftData.lastSaved)))\r\n        }\r\n        updateTime()\r\n        const interval = setInterval(updateTime, 60000)\r\n        return () => clearInterval(interval)\r\n    }, [draftData.lastSaved])\r\n\r\n    return (\r\n        <div className=\"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-700/50 rounded-xl p-4 mb-6\">\r\n            <div className=\"flex items-start gap-4\">\r\n                <div className=\"flex-shrink-0 w-10 h-10 rounded-xl bg-amber-100 dark:bg-amber-800/30 flex items-center justify-center\">\r\n                    <RefreshCw className=\"w-5 h-5 text-amber-600 dark:text-amber-400\" />\r\n                </div>\r\n                <div className=\"flex-1 min-w-0\">\r\n                    <h3 className=\"text-sm font-semibold text-amber-900 dark:text-amber-200\">\r\n                        Unsaved draft found\r\n                    </h3>\r\n                    <p className=\"text-sm text-amber-700 dark:text-amber-300/80 mt-0.5\">\r\n                        {draftData.title ? (\r\n                            <>\r\n                                <span className=\"font-medium\">\"{draftData.title.slice(0, 50)}{draftData.title.length > 50 ? '...' : ''}\"</span>\r\n                                <span className=\"mx-1\">ΓÇó</span>\r\n                            </>\r\n                        ) : null}\r\n                        <span className=\"inline-flex items-center gap-1\">\r\n                            <Clock className=\"w-3 h-3\" />\r\n                            Saved {timeAgo}\r\n                        </span>\r\n                    </p>\r\n                </div>\r\n                <div className=\"flex items-center gap-2 flex-shrink-0\">\r\n                    <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        onClick={onDiscard}\r\n                        className=\"border-amber-300 dark:border-amber-600 text-amber-700 dark:text-amber-300 hover:bg-amber-100 dark:hover:bg-amber-800/30\"\r\n                    >\r\n                        <X className=\"w-4 h-4 mr-1\" />\r\n                        Discard\r\n                    </Button>\r\n                    <Button\r\n                        size=\"sm\"\r\n                        onClick={onRestore}\r\n                        className=\"bg-amber-600 hover:bg-amber-700 text-white\"\r\n                    >\r\n                        <RefreshCw className=\"w-4 h-4 mr-1\" />\r\n                        Restore\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface AutosaveIndicatorProps {\r\n    lastSaved: Date | null\r\n    isSaving?: boolean\r\n}\r\n\r\nexport function AutosaveIndicator({ lastSaved, isSaving }: AutosaveIndicatorProps) {\r\n    const [timeAgo, setTimeAgo] = useState('')\r\n\r\n    useEffect(() => {\r\n        if (!lastSaved) return\r\n        const updateTime = () => {\r\n            setTimeAgo(formatTimeSince(lastSaved))\r\n        }\r\n        updateTime()\r\n        const interval = setInterval(updateTime, 10000) // Update every 10s\r\n        return () => clearInterval(interval)\r\n    }, [lastSaved])\r\n\r\n    if (!lastSaved && !isSaving) return null\r\n\r\n    return (\r\n        <div className=\"flex items-center gap-2 text-xs text-text-light dark:text-dark-text-muted\">\r\n            {isSaving ? (\r\n                <>\r\n                    <div className=\"w-2 h-2 rounded-full bg-amber-400 animate-pulse\" />\r\n                    <span>Saving...</span>\r\n                </>\r\n            ) : lastSaved ? (\r\n                <>\r\n                    <div className=\"w-2 h-2 rounded-full bg-green-400\" />\r\n                    <span>Draft saved {timeAgo}</span>\r\n                </>\r\n            ) : null}\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\EditButton.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\EditButton.tsx:28:13\n  26 |     useEffect(() => {\n  27 |         if (!isAuthor) {\n> 28 |             setCanEdit(false)\n     |             ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  29 |             return\n  30 |         }\n  31 |","line":28,"column":13,"nodeType":null,"endLine":28,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport Link from 'next/link'\r\nimport { PenSquare, Clock, Lock } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport {\r\n    Tooltip,\r\n    TooltipContent,\r\n    TooltipProvider,\r\n    TooltipTrigger,\r\n} from '@/components/ui/tooltip'\r\n\r\ninterface EditButtonProps {\r\n    postId: string\r\n    postCreatedAt: string\r\n    isAuthor: boolean\r\n}\r\n\r\nconst EDIT_WINDOW_HOURS = 24\r\n\r\nexport function EditButton({ postId, postCreatedAt, isAuthor }: EditButtonProps) {\r\n    const [timeRemaining, setTimeRemaining] = useState<string | null>(null)\r\n    const [canEdit, setCanEdit] = useState(false)\r\n\r\n    useEffect(() => {\r\n        if (!isAuthor) {\r\n            setCanEdit(false)\r\n            return\r\n        }\r\n\r\n        function calculateTimeRemaining() {\r\n            const createdAt = new Date(postCreatedAt)\r\n            const editDeadline = new Date(createdAt.getTime() + EDIT_WINDOW_HOURS * 60 * 60 * 1000)\r\n            const now = new Date()\r\n            const diff = editDeadline.getTime() - now.getTime()\r\n\r\n            if (diff <= 0) {\r\n                setCanEdit(false)\r\n                setTimeRemaining(null)\r\n                return\r\n            }\r\n\r\n            setCanEdit(true)\r\n\r\n            const hours = Math.floor(diff / (1000 * 60 * 60))\r\n            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60))\r\n\r\n            if (hours > 0) {\r\n                setTimeRemaining(`${hours}h ${minutes}m remaining`)\r\n            } else {\r\n                setTimeRemaining(`${minutes}m remaining`)\r\n            }\r\n        }\r\n\r\n        calculateTimeRemaining()\r\n        const interval = setInterval(calculateTimeRemaining, 60000) // Update every minute\r\n\r\n        return () => clearInterval(interval)\r\n    }, [postCreatedAt, isAuthor])\r\n\r\n    if (!isAuthor) {\r\n        return null\r\n    }\r\n\r\n    if (!canEdit) {\r\n        return (\r\n            <TooltipProvider>\r\n                <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                        <Button variant=\"outline\" disabled className=\"gap-2 opacity-50 cursor-not-allowed\">\r\n                            <Lock className=\"w-4 h-4\" />\r\n                            Edit\r\n                        </Button>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent side=\"bottom\" className=\"max-w-xs text-center\">\r\n                        <p className=\"text-sm\">\r\n                            The 24-hour edit window has expired. Your post is now locked for transparency.\r\n                        </p>\r\n                        <p className=\"text-xs text-muted-foreground mt-1\">\r\n                            You can still view the version history.\r\n                        </p>\r\n                    </TooltipContent>\r\n                </Tooltip>\r\n            </TooltipProvider>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <TooltipProvider>\r\n            <Tooltip>\r\n                <TooltipTrigger asChild>\r\n                    <Link href={`/editor?id=${postId}`}>\r\n                        <Button className=\"gap-2\">\r\n                            <PenSquare className=\"w-4 h-4\" />\r\n                            Edit\r\n                            {timeRemaining && (\r\n                                <span className=\"flex items-center gap-1 text-xs opacity-80 ml-1\">\r\n                                    <Clock className=\"w-3 h-3\" />\r\n                                    {timeRemaining.split(' ')[0]}\r\n                                </span>\r\n                            )}\r\n                        </Button>\r\n                    </Link>\r\n                </TooltipTrigger>\r\n                <TooltipContent side=\"bottom\">\r\n                    <div className=\"text-center\">\r\n                        <p className=\"text-sm font-medium\">{timeRemaining}</p>\r\n                        <p className=\"text-xs text-muted-foreground\">to edit this post</p>\r\n                    </div>\r\n                </TooltipContent>\r\n            </Tooltip>\r\n        </TooltipProvider>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\EditProfileDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\EndorsementSection.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":440,"column":49,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[20079,20130],"text":"\r\n                                            Add &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[20079,20130],"text":"\r\n                                            Add &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[20079,20130],"text":"\r\n                                            Add &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[20079,20130],"text":"\r\n                                            Add &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":440,"column":88,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[20168,20224],"text":"&quot; as new skill\r\n                                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[20168,20224],"text":"&ldquo; as new skill\r\n                                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[20168,20224],"text":"&#34; as new skill\r\n                                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[20168,20224],"text":"&rdquo; as new skill\r\n                                        "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { SkillBadge } from './SkillBadge'\r\nimport { UserAvatar } from '@/components/ui/UserAvatar'\r\nimport { useToast } from '@/components/ui/toast'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Plus, ChevronDown, ChevronUp, Award, Users, Search } from 'lucide-react'\r\nimport { cn } from '@/lib/utils'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface Endorser {\r\n    id: string\r\n    name: string | null\r\n    avatar_url: string | null\r\n}\r\n\r\ninterface UserSkill {\r\n    skill_id: string\r\n    skill_name: string\r\n    skill_category: string\r\n    is_recognized: boolean\r\n    endorsement_count: number\r\n    endorsers: Endorser[]\r\n}\r\n\r\ninterface EndorsementSectionProps {\r\n    userId: string\r\n    isOwnProfile: boolean\r\n}\r\n\r\nconst SKILL_CATEGORIES = [\r\n    'Research Methods',\r\n    'Technical',\r\n    'Domain Knowledge',\r\n    'Work Field',\r\n    'Practical Expertise'\r\n]\r\n\r\nexport function EndorsementSection({ userId, isOwnProfile }: EndorsementSectionProps) {\r\n    const [skills, setSkills] = useState<UserSkill[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [currentUserId, setCurrentUserId] = useState<string | null>(null)\r\n    const [endorsedSkills, setEndorsedSkills] = useState<Set<string>>(new Set())\r\n    const [showAddSkill, setShowAddSkill] = useState(false)\r\n    const [expandedSkill, setExpandedSkill] = useState<string | null>(null)\r\n    const [newSkillName, setNewSkillName] = useState('')\r\n    const [newSkillCategory, setNewSkillCategory] = useState(SKILL_CATEGORIES[0])\r\n    const [availableSkills, setAvailableSkills] = useState<any[]>([])\r\n    const [searchQuery, setSearchQuery] = useState('')\r\n    const [addingSkill, setAddingSkill] = useState(false)\r\n    const [loadingSkills, setLoadingSkills] = useState(false)\r\n\r\n    const supabase = createClient()\r\n    const { showToast } = useToast()\r\n    const t = useTranslations('ProfileLabels')\r\n\r\n    // Load user skills and endorsements\r\n    useEffect(() => {\r\n        async function loadData() {\r\n            try {\r\n                // Get current user\r\n                const { data: { user } } = await supabase.auth.getUser()\r\n                setCurrentUserId(user?.id || null)\r\n\r\n                // Get user's skills with endorsements\r\n                const { data: userSkills, error } = await supabase\r\n                    .rpc('get_user_endorsements', { p_user_id: userId })\r\n\r\n                if (error && error.message) {\r\n                    console.warn('Endorsements RPC unavailable, using fallback:', error.message)\r\n                    // Fallback: load skills directly\r\n                    const { data: fallbackSkills } = await supabase\r\n                        .from('user_skills')\r\n                        .select(`\r\n                            skill_id,\r\n                            skills(id, name, category, is_recognized)\r\n                        `)\r\n                        .eq('user_id', userId)\r\n\r\n                    if (fallbackSkills) {\r\n                        setSkills(fallbackSkills.map((us: any) => ({\r\n                            skill_id: us.skill_id,\r\n                            skill_name: us.skills?.name || 'Unknown',\r\n                            skill_category: us.skills?.category || 'Other',\r\n                            is_recognized: us.skills?.is_recognized || false,\r\n                            endorsement_count: 0,\r\n                            endorsers: []\r\n                        })))\r\n                    }\r\n                } else if (userSkills) {\r\n                    setSkills(userSkills)\r\n                }\r\n\r\n                // Check which skills current user has endorsed\r\n                if (user && user.id !== userId) {\r\n                    const { data: myEndorsements } = await supabase\r\n                        .from('endorsements')\r\n                        .select('skill_id')\r\n                        .eq('endorser_id', user.id)\r\n                        .eq('endorsed_user_id', userId)\r\n\r\n                    if (myEndorsements) {\r\n                        setEndorsedSkills(new Set(myEndorsements.map(e => e.skill_id)))\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                console.error('Error:', error)\r\n            } finally {\r\n                setLoading(false)\r\n            }\r\n        }\r\n\r\n        loadData()\r\n    }, [userId, supabase])\r\n\r\n    // Load available skills for adding\r\n    useEffect(() => {\r\n        if (!showAddSkill) return\r\n\r\n        async function loadAvailableSkills() {\r\n            setLoadingSkills(true)\r\n            const { data } = await supabase\r\n                .from('skills')\r\n                .select('*')\r\n                .order('is_recognized', { ascending: false })\r\n                .order('name')\r\n\r\n            if (data) {\r\n                // Filter out skills user already has\r\n                const userSkillIds = new Set(skills.map(s => s.skill_id))\r\n                setAvailableSkills(data.filter(s => !userSkillIds.has(s.id)))\r\n            }\r\n            setLoadingSkills(false)\r\n        }\r\n\r\n        loadAvailableSkills()\r\n    }, [showAddSkill, skills, supabase])\r\n\r\n    const handleEndorse = async (skillId: string) => {\r\n        if (!currentUserId || currentUserId === userId) return\r\n\r\n        const hasEndorsed = endorsedSkills.has(skillId)\r\n\r\n        try {\r\n            if (hasEndorsed) {\r\n                // Remove endorsement\r\n                await supabase\r\n                    .from('endorsements')\r\n                    .delete()\r\n                    .eq('endorser_id', currentUserId)\r\n                    .eq('endorsed_user_id', userId)\r\n                    .eq('skill_id', skillId)\r\n\r\n                setEndorsedSkills(prev => {\r\n                    const next = new Set(prev)\r\n                    next.delete(skillId)\r\n                    return next\r\n                })\r\n                setSkills(prev => prev.map(s =>\r\n                    s.skill_id === skillId\r\n                        ? { ...s, endorsement_count: Math.max(0, s.endorsement_count - 1) }\r\n                        : s\r\n                ))\r\n                showToast('Endorsement removed', 'success')\r\n            } else {\r\n                // Add endorsement\r\n                await supabase\r\n                    .from('endorsements')\r\n                    .insert({\r\n                        endorser_id: currentUserId,\r\n                        endorsed_user_id: userId,\r\n                        skill_id: skillId\r\n                    })\r\n\r\n                setEndorsedSkills(prev => new Set([...prev, skillId]))\r\n                setSkills(prev => prev.map(s =>\r\n                    s.skill_id === skillId\r\n                        ? { ...s, endorsement_count: s.endorsement_count + 1 }\r\n                        : s\r\n                ))\r\n                showToast('Skill endorsed!', 'success')\r\n            }\r\n        } catch (error: any) {\r\n            showToast(error.message || 'Failed to update endorsement', 'error')\r\n        }\r\n    }\r\n\r\n    const handleAddSkill = async (skillId: string) => {\r\n        if (!currentUserId) return\r\n        setAddingSkill(true)\r\n\r\n        try {\r\n            await supabase\r\n                .from('user_skills')\r\n                .insert({\r\n                    user_id: userId,\r\n                    skill_id: skillId\r\n                })\r\n\r\n            // Reload skills\r\n            const skill = availableSkills.find(s => s.id === skillId)\r\n            if (skill) {\r\n                setSkills(prev => [...prev, {\r\n                    skill_id: skill.id,\r\n                    skill_name: skill.name,\r\n                    skill_category: skill.category,\r\n                    is_recognized: skill.is_recognized,\r\n                    endorsement_count: 0,\r\n                    endorsers: []\r\n                }])\r\n            }\r\n\r\n            setShowAddSkill(false)\r\n            setSearchQuery('')\r\n            showToast('Skill added to your profile', 'success')\r\n\r\n            // Notify ProfileCompletionCard to refresh\r\n            window.dispatchEvent(new CustomEvent('profile-updated'))\r\n        } catch (error: any) {\r\n            showToast(error.message || 'Failed to add skill', 'error')\r\n        } finally {\r\n            setAddingSkill(false)\r\n        }\r\n    }\r\n\r\n    const handleCreateAndAddSkill = async () => {\r\n        if (!currentUserId || !newSkillName.trim()) return\r\n        setAddingSkill(true)\r\n\r\n        try {\r\n            // Create skill using RPC function\r\n            const { data: skillId, error } = await supabase\r\n                .rpc('find_or_create_skill', {\r\n                    p_name: newSkillName.trim(),\r\n                    p_category: newSkillCategory,\r\n                    p_created_by: currentUserId\r\n                })\r\n\r\n            if (error) throw error\r\n\r\n            // Add to user's skills\r\n            await supabase\r\n                .from('user_skills')\r\n                .insert({\r\n                    user_id: userId,\r\n                    skill_id: skillId\r\n                })\r\n\r\n            setSkills(prev => [...prev, {\r\n                skill_id: skillId,\r\n                skill_name: newSkillName.trim(),\r\n                skill_category: newSkillCategory,\r\n                is_recognized: false,\r\n                endorsement_count: 0,\r\n                endorsers: []\r\n            }])\r\n\r\n            setShowAddSkill(false)\r\n            setNewSkillName('')\r\n            showToast('Custom skill added', 'success')\r\n\r\n            // Notify ProfileCompletionCard to refresh\r\n            window.dispatchEvent(new CustomEvent('profile-updated'))\r\n        } catch (error: any) {\r\n            showToast(error.message || 'Failed to create skill', 'error')\r\n        } finally {\r\n            setAddingSkill(false)\r\n        }\r\n    }\r\n\r\n    const handleRemoveSkill = async (skillId: string) => {\r\n        if (!currentUserId) return\r\n\r\n        try {\r\n            await supabase\r\n                .from('user_skills')\r\n                .delete()\r\n                .eq('user_id', userId)\r\n                .eq('skill_id', skillId)\r\n\r\n            setSkills(prev => prev.filter(s => s.skill_id !== skillId))\r\n            showToast('Skill removed', 'success')\r\n        } catch (error: any) {\r\n            showToast(error.message || 'Failed to remove skill', 'error')\r\n        }\r\n    }\r\n\r\n    // Group skills by category\r\n    const skillsByCategory = skills.reduce<Record<string, UserSkill[]>>((acc, skill) => {\r\n        const cat = skill.skill_category\r\n        if (!acc[cat]) acc[cat] = []\r\n        acc[cat].push(skill)\r\n        return acc\r\n    }, {})\r\n\r\n    // Filter available skills by search - show all when query is empty or partial match\r\n    const searchTerm = (searchQuery || newSkillName).toLowerCase().trim()\r\n    const filteredAvailableSkills = searchTerm\r\n        ? availableSkills.filter(s => s.name.toLowerCase().includes(searchTerm))\r\n        : availableSkills\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-6\">\r\n                <div className=\"animate-pulse space-y-4\">\r\n                    <div className=\"h-6 bg-gray-200 dark:bg-dark-border rounded w-1/3\"></div>\r\n                    <div className=\"flex gap-2 flex-wrap\">\r\n                        {[1, 2, 3, 4].map(i => (\r\n                            <div key={i} className=\"h-8 w-24 bg-gray-200 dark:bg-dark-border rounded-full\"></div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-6\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n                <div className=\"flex items-center gap-2\">\r\n                    <Award className=\"w-5 h-5 text-primary\" />\r\n                    <h3 className=\"text-lg font-semibold text-text dark:text-dark-text\">\r\n                        {t('skillsEndorsements')}\r\n                    </h3>\r\n                    {skills.length > 0 && (\r\n                        <span className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                            ({skills.reduce((sum, s) => sum + s.endorsement_count, 0)} endorsements)\r\n                        </span>\r\n                    )}\r\n                </div>\r\n                {isOwnProfile && (\r\n                    <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        onClick={() => setShowAddSkill(!showAddSkill)}\r\n                    >\r\n                        <Plus className=\"w-4 h-4 mr-1\" />\r\n                        {t('addSkill')}\r\n                    </Button>\r\n                )}\r\n            </div>\r\n\r\n            {/* Add Skill Panel - Unified Autocomplete Design */}\r\n            {showAddSkill && isOwnProfile && (\r\n                <div className=\"mb-6 p-4 bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border shadow-sm\">\r\n                    <div className=\"space-y-3\">\r\n                        {/* Unified Search/Add Input */}\r\n                        <div className=\"relative\">\r\n                            <div className=\"relative\">\r\n                                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 dark:text-gray-500\" />\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={searchQuery || newSkillName}\r\n                                    onChange={(e) => {\r\n                                        setSearchQuery(e.target.value)\r\n                                        setNewSkillName(e.target.value)\r\n                                    }}\r\n                                    onKeyDown={(e) => {\r\n                                        if (e.key === 'Enter' && (searchQuery || newSkillName).trim()) {\r\n                                            e.preventDefault()\r\n                                            // If there are matching skills, add the first one\r\n                                            if (filteredAvailableSkills.length > 0) {\r\n                                                handleAddSkill(filteredAvailableSkills[0].id)\r\n                                            } else {\r\n                                                // No matches, create custom skill\r\n                                                handleCreateAndAddSkill()\r\n                                            }\r\n                                        }\r\n                                        if (e.key === 'Escape') {\r\n                                            setShowAddSkill(false)\r\n                                            setSearchQuery('')\r\n                                            setNewSkillName('')\r\n                                        }\r\n                                    }}\r\n                                    placeholder=\"Type a skill name...\"\r\n                                    autoFocus\r\n                                    className=\"w-full h-10 pl-10 pr-4 rounded-lg border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Autocomplete Dropdown - Shows immediately */}\r\n                            <div className=\"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-dark-surface rounded-lg border border-gray-200 dark:border-dark-border shadow-lg overflow-hidden z-10 max-h-64 overflow-y-auto\">\r\n                                {loadingSkills ? (\r\n                                    <div className=\"px-3 py-4 text-center text-sm text-gray-500 dark:text-gray-400\">\r\n                                        Loading skills...\r\n                                    </div>\r\n                                ) : filteredAvailableSkills.length > 0 ? (\r\n                                    <>\r\n                                        {filteredAvailableSkills.slice(0, 8).map((skill, index) => (\r\n                                            <button\r\n                                                key={skill.id}\r\n                                                onClick={() => handleAddSkill(skill.id)}\r\n                                                disabled={addingSkill}\r\n                                                className={cn(\r\n                                                    \"w-full flex items-center justify-between px-3 py-2.5 text-left transition-colors\",\r\n                                                    index === 0\r\n                                                        ? \"bg-primary/5 dark:bg-primary/10 border-l-2 border-primary\"\r\n                                                        : \"hover:bg-gray-50 dark:hover:bg-dark-bg\"\r\n                                                )}\r\n                                            >\r\n                                                <span className=\"flex items-center gap-2\">\r\n                                                    <Award className={cn(\r\n                                                        \"w-4 h-4\",\r\n                                                        skill.is_recognized\r\n                                                            ? \"text-primary\"\r\n                                                            : \"text-gray-400 dark:text-gray-500\"\r\n                                                    )} />\r\n                                                    <span className=\"font-medium text-text dark:text-dark-text\">\r\n                                                        {skill.name}\r\n                                                    </span>\r\n                                                </span>\r\n                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-dark-bg px-2 py-0.5 rounded\">\r\n                                                    {skill.category}\r\n                                                </span>\r\n                                            </button>\r\n                                        ))}\r\n                                        {filteredAvailableSkills.length > 8 && (\r\n                                            <div className=\"px-3 py-2 text-xs text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-dark-bg text-center\">\r\n                                                +{filteredAvailableSkills.length - 8} more results\r\n                                            </div>\r\n                                        )}\r\n                                    </>\r\n                                ) : (\r\n                                    /* No matches - show create option */\r\n                                    <div className=\"p-3\">\r\n                                        <div className=\"flex items-center justify-between\">\r\n                                            <span className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                                                No matching skills found\r\n                                            </span>\r\n                                        </div>\r\n                                        <button\r\n                                            onClick={handleCreateAndAddSkill}\r\n                                            disabled={addingSkill || !(searchQuery || newSkillName).trim()}\r\n                                            className=\"w-full mt-2 flex items-center justify-center gap-2 px-3 py-2.5 bg-primary hover:bg-primary/90 text-white rounded-lg font-medium text-sm transition-colors disabled:opacity-50\"\r\n                                        >\r\n                                            <Plus className=\"w-4 h-4\" />\r\n                                            Add \"{(searchQuery || newSkillName).trim()}\" as new skill\r\n                                        </button>\r\n                                        <div className=\"mt-2 flex items-center gap-2\">\r\n                                            <span className=\"text-xs text-gray-500 dark:text-gray-400\">Category:</span>\r\n                                            <select\r\n                                                value={newSkillCategory}\r\n                                                onChange={(e) => setNewSkillCategory(e.target.value)}\r\n                                                className=\"flex-1 h-8 text-xs rounded-md border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg px-2\"\r\n                                            >\r\n                                                {SKILL_CATEGORIES.map(cat => (\r\n                                                    <option key={cat} value={cat}>{cat}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Helper Text */}\r\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1\">\r\n                            <span className=\"inline-block w-4 h-4 bg-gray-100 dark:bg-dark-border rounded text-center text-[10px] leading-4 font-mono\">Γå╡</span>\r\n                            Press Enter to add ΓÇó Esc to cancel\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Skills by Category */}\r\n            {skills.length === 0 ? (\r\n                <p className=\"text-text-light dark:text-dark-text-muted text-sm\">\r\n                    {isOwnProfile\r\n                        ? 'Add skills to your profile so others can endorse you.'\r\n                        : 'No skills added yet.'}\r\n                </p>\r\n            ) : (\r\n                <div className=\"space-y-4\">\r\n                    {Object.entries(skillsByCategory).map(([category, catSkills]) => (\r\n                        <div key={category}>\r\n                            <h4 className=\"text-xs font-medium text-text-light dark:text-dark-text-muted uppercase tracking-wide mb-2\">\r\n                                {t(category.toLowerCase().replace(' ', '') as any) || category}\r\n                            </h4>\r\n                            <div className=\"flex flex-wrap gap-2\">\r\n                                {catSkills.map(skill => (\r\n                                    <div key={skill.skill_id} className=\"relative group\">\r\n                                        <SkillBadge\r\n                                            skillId={skill.skill_id}\r\n                                            name={skill.skill_name}\r\n                                            category={skill.skill_category}\r\n                                            isRecognized={skill.is_recognized}\r\n                                            endorsementCount={skill.endorsement_count}\r\n                                            hasEndorsed={endorsedSkills.has(skill.skill_id)}\r\n                                            onEndorse={currentUserId ? () => handleEndorse(skill.skill_id) : undefined}\r\n                                            isOwnProfile={isOwnProfile}\r\n                                        />\r\n                                        {/* Expand endorsers */}\r\n                                        {skill.endorsement_count > 0 && (\r\n                                            <button\r\n                                                onClick={() => setExpandedSkill(\r\n                                                    expandedSkill === skill.skill_id ? null : skill.skill_id\r\n                                                )}\r\n                                                className=\"absolute -bottom-1 -right-1 w-5 h-5 rounded-full bg-white dark:bg-dark-surface border border-gray-200 dark:border-dark-border flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity\"\r\n                                            >\r\n                                                {expandedSkill === skill.skill_id\r\n                                                    ? <ChevronUp className=\"w-3 h-3\" />\r\n                                                    : <ChevronDown className=\"w-3 h-3\" />\r\n                                                }\r\n                                            </button>\r\n                                        )}\r\n                                        {/* Remove button for own profile */}\r\n                                        {isOwnProfile && (\r\n                                            <button\r\n                                                onClick={() => handleRemoveSkill(skill.skill_id)}\r\n                                                className=\"absolute -top-1 -right-1 w-4 h-4 rounded-full bg-red-500 text-white text-xs flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity\"\r\n                                            >\r\n                                                ├ù\r\n                                            </button>\r\n                                        )}\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                            {/* Expanded endorsers list */}\r\n                            {catSkills.map(skill => (\r\n                                expandedSkill === skill.skill_id && skill.endorsers.length > 0 && (\r\n                                    <div key={`${skill.skill_id}-endorsers`} className=\"mt-3 p-3 bg-gray-50 dark:bg-dark-surface-hover rounded-lg\">\r\n                                        <div className=\"flex items-center gap-2 mb-2\">\r\n                                            <Users className=\"w-4 h-4 text-text-light dark:text-dark-text-muted\" />\r\n                                            <span className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                                                Endorsed by:\r\n                                            </span>\r\n                                        </div>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            {skill.endorsers.map((endorser: Endorser) => (\r\n                                                <div\r\n                                                    key={endorser.id}\r\n                                                    className=\"flex items-center gap-2 px-2 py-1 bg-white dark:bg-dark-surface rounded-full border border-gray-200 dark:border-dark-border\"\r\n                                                >\r\n                                                    <UserAvatar\r\n                                                        name={endorser.name}\r\n                                                        avatarUrl={endorser.avatar_url}\r\n                                                        size=\"sm\"\r\n                                                    />\r\n                                                    <span className=\"text-sm text-text dark:text-dark-text\">\r\n                                                        {endorser.name || 'Anonymous'}\r\n                                                    </span>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                )\r\n                            ))}\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\EpistemicOnboarding.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\EpistemicRecommendations.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\EventActions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\EventCard.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":151,"column":25,"nodeType":"JSXOpeningElement","endLine":155,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport Link from 'next/link'\r\nimport { Calendar, MapPin, Users, Clock, AlertTriangle, Trash2, X } from 'lucide-react'\r\nimport { format } from 'date-fns'\r\nimport { TagChip } from './TagChip'\r\nimport { getAvatarGradient, getInitials } from '@/lib/utils'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { useRouter } from 'next/navigation'\r\nimport { useState } from 'react'\r\nimport { User } from '@supabase/supabase-js'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface EventMetadata {\r\n    start_time: string\r\n    end_time?: string\r\n    location: string\r\n    link?: string\r\n    status?: 'scheduled' | 'cancelled' | 'postponed'\r\n}\r\n\r\ninterface EventPost {\r\n    id: string\r\n    title: string\r\n    content: string\r\n    created_at: string\r\n    author_id?: string\r\n    author?: { name?: string | null, email?: string | null } | null\r\n    tags?: string[]\r\n    metadata: EventMetadata\r\n    rsvp_count?: number\r\n    approval_status?: 'pending' | 'approved' | 'rejected'\r\n    cover_image_url?: string | null\r\n}\r\n\r\ninterface EventCardProps {\r\n    event: EventPost\r\n    currentUser?: User | null\r\n}\r\n\r\nexport function EventCard({ event, currentUser }: EventCardProps) {\r\n    const router = useRouter()\r\n    const t = useTranslations('Common')\r\n    const tEvents = useTranslations('Events')\r\n    const [isDeleting, setIsDeleting] = useState(false)\r\n    const [showConfirmation, setShowConfirmation] = useState(false)\r\n\r\n    const startDate = new Date(event.metadata.start_time)\r\n    const endDate = event.metadata.end_time ? new Date(event.metadata.end_time) : null\r\n    const status = event.metadata.status || 'scheduled'\r\n    const isAuthor = currentUser?.id === event.author_id\r\n\r\n    const handleDeleteClick = (e: React.MouseEvent) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n        setShowConfirmation(true)\r\n    }\r\n\r\n    const handleCancelDelete = (e: React.MouseEvent) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n        setShowConfirmation(false)\r\n    }\r\n\r\n    const handleConfirmDelete = async (e: React.MouseEvent) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n\r\n        setIsDeleting(true)\r\n        const supabase = createClient()\r\n\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('posts')\r\n                .delete()\r\n                .eq('id', event.id)\r\n                .select()\r\n\r\n            if (error) {\r\n                console.error('Error deleting event:', error)\r\n                alert('Failed to delete event: ' + error.message)\r\n            } else if (!data || data.length === 0) {\r\n                alert('Could not delete event. You may not have permission.')\r\n            } else {\r\n                router.refresh()\r\n            }\r\n        } catch (error: any) {\r\n            console.error('Error:', error)\r\n            alert('An error occurred: ' + (error.message || 'Unknown error'))\r\n        } finally {\r\n            setIsDeleting(false)\r\n            setShowConfirmation(false)\r\n        }\r\n    }\r\n\r\n    if (isDeleting) {\r\n        return (\r\n            <div className=\"card h-[200px] flex items-center justify-center bg-gray-50 dark:bg-dark-surface/50 opacity-50\">\r\n                <div className=\"flex flex-col items-center gap-2\">\r\n                    <div className=\"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin\" />\r\n                    <span className=\"text-sm text-text-light\">{t('deleting')}</span>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"card hover:border-primary/50 transition-colors group flex flex-col md:flex-row overflow-hidden relative\">\r\n            {/* Delete Button / Confirmation for Author */}\r\n            {isAuthor && (\r\n                <div className=\"absolute top-2 right-2 z-20\">\r\n                    {showConfirmation ? (\r\n                        <div className=\"flex items-center gap-1 bg-white dark:bg-dark-surface rounded-full shadow-md border border-gray-200 dark:border-dark-border p-1\">\r\n                            <button\r\n                                onClick={handleCancelDelete}\r\n                                className=\"p-1.5 text-text-light hover:text-text dark:text-dark-text-muted dark:hover:text-dark-text rounded-full hover:bg-gray-100 dark:hover:bg-dark-border transition-colors\"\r\n                                title={t('cancel')}\r\n                            >\r\n                                <X className=\"w-4 h-4\" />\r\n                            </button>\r\n                            <button\r\n                                onClick={handleConfirmDelete}\r\n                                className=\"px-2.5 py-1 text-xs font-medium bg-red-600 text-white rounded-full hover:bg-red-700 transition-colors flex items-center gap-1\"\r\n                            >\r\n                                <Trash2 className=\"w-3 h-3\" />\r\n                                {t('delete')}\r\n                            </button>\r\n                        </div>\r\n                    ) : (\r\n                        <button\r\n                            onClick={handleDeleteClick}\r\n                            className=\"p-2 text-text-light hover:text-red-600 dark:text-dark-text-muted dark:hover:text-red-400 bg-white/80 dark:bg-dark-surface/80 rounded-full shadow-sm border border-gray-100 dark:border-dark-border hover:border-red-200 dark:hover:border-red-800 transition-colors\"\r\n                            title={tEvents('deleteEvent')}\r\n                        >\r\n                            <Trash2 className=\"w-4 h-4\" />\r\n                        </button>\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            {/* Date Badge with optional background image */}\r\n            <div className={`\r\n                min-w-[120px] p-6 flex flex-col items-center justify-center text-center border-b md:border-b-0 md:border-r border-gray-100 dark:border-dark-border relative overflow-hidden\r\n                ${status === 'cancelled' ? 'bg-red-50 dark:bg-red-900/10' :\r\n                    status === 'postponed' ? 'bg-amber-50 dark:bg-amber-900/10' :\r\n                        'bg-primary/5 dark:bg-primary/10'}\r\n            `}>\r\n                {/* Background image with overlay */}\r\n                {event.cover_image_url && (\r\n                    <>\r\n                        <img\r\n                            src={event.cover_image_url}\r\n                            alt=\"\"\r\n                            className=\"absolute inset-0 w-full h-full object-cover opacity-40\"\r\n                        />\r\n                        <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-black/30 to-black/10\" />\r\n                    </>\r\n                )}\r\n                <span className={`relative z-10 text-sm font-bold uppercase tracking-wider ${status === 'cancelled' ? 'text-red-600 dark:text-red-400' :\r\n                    status === 'postponed' ? 'text-amber-600 dark:text-amber-400' :\r\n                        event.cover_image_url ? 'text-white' : 'text-primary'\r\n                    }`}>\r\n                    {status === 'scheduled' ? format(startDate, 'MMM') : status}\r\n                </span>\r\n                <span className={`relative z-10 text-3xl font-bold my-1 ${event.cover_image_url ? 'text-white drop-shadow-md' : 'text-text dark:text-dark-text'}`}>\r\n                    {format(startDate, 'd')}\r\n                </span>\r\n                <span className={`relative z-10 text-sm ${event.cover_image_url ? 'text-white/80' : 'text-text-light dark:text-dark-text-muted'}`}>\r\n                    {format(startDate, 'yyyy')}\r\n                </span>\r\n            </div>\r\n\r\n            <div className=\"p-6 flex-1 min-w-0\">\r\n                <div className=\"flex flex-col gap-4 h-full justify-between\">\r\n                    <div>\r\n                        <div className=\"flex items-start justify-between gap-4 mb-2\">\r\n                            <Link href={`/events/${event.id}`} className=\"group-hover:text-primary transition-colors\">\r\n                                <h3 className={`text-xl font-bold line-clamp-2 ${status === 'cancelled' ? 'text-text-light dark:text-dark-text-muted line-through' : 'text-text dark:text-dark-text'}`}>\r\n                                    {event.title}\r\n                                </h3>\r\n                            </Link>\r\n                            <div className=\"flex gap-2\">\r\n                                {event.approval_status === 'rejected' && (\r\n                                    <span className=\"flex-shrink-0 inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-800\">\r\n                                        <AlertTriangle className=\"w-3 h-3\" />\r\n                                        {tEvents('rejected')}\r\n                                    </span>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex flex-wrap gap-4 text-sm text-text-light dark:text-dark-text-muted mb-4\">\r\n                            <div className=\"flex items-center gap-1.5\">\r\n                                <Clock className=\"w-4 h-4\" />\r\n                                <span>\r\n                                    {format(startDate, 'h:mm a')}\r\n                                    {endDate && ` - ${format(endDate, 'h:mm a')}`}\r\n                                </span>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-1.5\">\r\n                                <MapPin className=\"w-4 h-4\" />\r\n                                <span className=\"truncate max-w-[200px]\">{event.metadata.location}</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <p className=\"text-text-light dark:text-dark-text-muted line-clamp-2 mb-4 text-sm\">\r\n                            {event.content}\r\n                        </p>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center justify-between mt-auto pt-4 border-t border-gray-100 dark:border-dark-border\">\r\n                        <div className=\"flex flex-wrap gap-2\">\r\n                            {event.tags?.slice(0, 3).map(tag => (\r\n                                <TagChip key={tag} tag={tag} size=\"sm\" />\r\n                            ))}\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center gap-1.5 text-sm font-medium text-text dark:text-dark-text\">\r\n                            <Users className=\"w-4 h-4 text-primary\" />\r\n                            <span>{event.rsvp_count || 0} {t('attending')}</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Author & Footer */}\r\n                    <div className=\"flex items-center justify-between mt-4 pt-4 border-t border-gray-100 dark:border-dark-border\">\r\n                        {event.author && (\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <div className={`w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-medium text-white ${getAvatarGradient(event.author_id)}`}>\r\n                                    {getInitials(event.author.name || undefined, event.author.email || undefined)}\r\n                                </div>\r\n                                <span className=\"text-sm text-text-light dark:text-dark-text-muted truncate max-w-[150px]\">\r\n                                    {event.author.name || event.author.email?.split('@')[0]}\r\n                                </span>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ExportButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\FeaturedPost.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\FollowButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\Footer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ForkButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\GroupActions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\GroupCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\GroupChat.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\HeroEditorial.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ImageCropModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ImageUpload.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":142,"column":29,"nodeType":"JSXOpeningElement","endLine":146,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useRef } from 'react'\r\nimport { Upload, Loader2, Image as ImageIcon } from 'lucide-react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { Button } from '@/components/ui/button'\r\nimport { useToast } from '@/components/ui/toast'\r\nimport { ImageCropModal } from './ImageCropModal'\r\n\r\ninterface ImageUploadProps {\r\n    bucket: 'avatars' | 'post_images'\r\n    path?: string // Optional subpath\r\n    onUploadComplete: (url: string) => void\r\n    currentImage?: string | null\r\n    className?: string\r\n    enableCrop?: boolean\r\n    cropShape?: 'round' | 'rect'\r\n    aspectRatio?: number\r\n}\r\n\r\nexport function ImageUpload({\r\n    bucket,\r\n    path = '',\r\n    onUploadComplete,\r\n    currentImage,\r\n    className = '',\r\n    enableCrop = true,\r\n    cropShape = 'round',\r\n    aspectRatio = 1\r\n}: ImageUploadProps) {\r\n    const [uploading, setUploading] = useState(false)\r\n    const [preview, setPreview] = useState<string | null>(currentImage || null)\r\n    const [cropModalOpen, setCropModalOpen] = useState(false)\r\n    const [selectedImage, setSelectedImage] = useState<string | null>(null)\r\n    const fileInputRef = useRef<HTMLInputElement>(null)\r\n    const { showToast } = useToast()\r\n    const supabase = createClient()\r\n\r\n    const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        if (!e.target.files || e.target.files.length === 0) {\r\n            return\r\n        }\r\n\r\n        const file = e.target.files[0]\r\n\r\n        // Validate file type\r\n        if (!file.type.startsWith('image/')) {\r\n            showToast('Please select an image file', 'error')\r\n            return\r\n        }\r\n\r\n        // Create object URL for cropping\r\n        const objectUrl = URL.createObjectURL(file)\r\n\r\n        if (enableCrop) {\r\n            // Open crop modal\r\n            setSelectedImage(objectUrl)\r\n            setCropModalOpen(true)\r\n        } else {\r\n            // Upload directly without cropping\r\n            await uploadImage(file)\r\n        }\r\n\r\n        // Reset input\r\n        if (fileInputRef.current) {\r\n            fileInputRef.current.value = ''\r\n        }\r\n    }\r\n\r\n    const uploadImage = async (file: File | Blob) => {\r\n        const fileExt = file instanceof File ? file.name.split('.').pop() : 'jpg'\r\n        const fileName = `${path ? path + '/' : ''}${Math.random().toString(36).substring(2)}.${fileExt}`\r\n        const filePath = fileName\r\n\r\n        setUploading(true)\r\n\r\n        try {\r\n            const { error: uploadError } = await supabase.storage\r\n                .from(bucket)\r\n                .upload(filePath, file)\r\n\r\n            if (uploadError) {\r\n                throw uploadError\r\n            }\r\n\r\n            const { data: { publicUrl } } = supabase.storage\r\n                .from(bucket)\r\n                .getPublicUrl(filePath)\r\n\r\n            setPreview(publicUrl)\r\n            onUploadComplete(publicUrl)\r\n            showToast('Image uploaded successfully', 'success')\r\n        } catch (error: any) {\r\n            console.error('Error uploading image:', error)\r\n            showToast('Error uploading image', 'error')\r\n            setPreview(currentImage || null)\r\n        } finally {\r\n            setUploading(false)\r\n        }\r\n    }\r\n\r\n    const handleCropComplete = async (croppedBlob: Blob) => {\r\n        // Upload the cropped image\r\n        await uploadImage(croppedBlob)\r\n\r\n        // Clean up\r\n        if (selectedImage) {\r\n            URL.revokeObjectURL(selectedImage)\r\n            setSelectedImage(null)\r\n        }\r\n    }\r\n\r\n    const handleCropModalClose = () => {\r\n        setCropModalOpen(false)\r\n        if (selectedImage) {\r\n            URL.revokeObjectURL(selectedImage)\r\n            setSelectedImage(null)\r\n        }\r\n    }\r\n\r\n    const handleRemove = () => {\r\n        setPreview(null)\r\n        onUploadComplete('')\r\n        if (fileInputRef.current) {\r\n            fileInputRef.current.value = ''\r\n        }\r\n    }\r\n\r\n    const previewStyle = cropShape === 'round'\r\n        ? \"w-32 h-32 rounded-full\"\r\n        : \"w-full aspect-video rounded-xl\"\r\n\r\n    return (\r\n        <>\r\n            <div className={`flex flex-col items-center gap-4 ${className}`}>\r\n                <div\r\n                    className={`relative group cursor-pointer overflow-hidden border-2 border-gray-200 dark:border-dark-border bg-gray-100 dark:bg-dark-surface flex items-center justify-center transition-colors hover:border-primary dark:hover:border-primary ${previewStyle}`}\r\n                    onClick={() => fileInputRef.current?.click()}\r\n                >\r\n                    {preview ? (\r\n                        <>\r\n                            <img\r\n                                src={preview}\r\n                                alt=\"Upload preview\"\r\n                                className=\"w-full h-full object-cover object-center\"\r\n                            />\r\n                            <div className=\"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                                <Upload className=\"w-6 h-6 text-white\" />\r\n                            </div>\r\n                        </>\r\n                    ) : (\r\n                        <ImageIcon className=\"w-8 h-8 text-gray-400\" />\r\n                    )}\r\n\r\n                    {uploading && (\r\n                        <div className=\"absolute inset-0 flex items-center justify-center bg-white/80 dark:bg-dark-bg/80\">\r\n                            <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <div className=\"flex gap-2 justify-center\">\r\n                    <Button\r\n                        type=\"button\"\r\n                        variant=\"default\"\r\n                        size=\"sm\"\r\n                        onClick={() => fileInputRef.current?.click()}\r\n                        disabled={uploading}\r\n                        className=\"bg-primary text-white hover:bg-primary-dark\"\r\n                    >\r\n                        {preview ? 'Change Image' : 'Upload Image'}\r\n                    </Button>\r\n                    {preview && (\r\n                        <Button\r\n                            type=\"button\"\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={(e) => {\r\n                                e.stopPropagation()\r\n                                handleRemove()\r\n                            }}\r\n                            disabled={uploading}\r\n                            className=\"border-red-300 text-red-600 hover:bg-red-50 dark:border-red-800 dark:text-red-400 dark:hover:bg-red-900/30\"\r\n                        >\r\n                            Remove\r\n                        </Button>\r\n                    )}\r\n                </div>\r\n\r\n                <input\r\n                    ref={fileInputRef}\r\n                    type=\"file\"\r\n                    accept=\"image/*\"\r\n                    onChange={handleFileSelect}\r\n                    className=\"hidden\"\r\n                />\r\n            </div>\r\n\r\n            {/* Crop Modal */}\r\n            {selectedImage && (\r\n                <ImageCropModal\r\n                    open={cropModalOpen}\r\n                    onClose={handleCropModalClose}\r\n                    imageSrc={selectedImage}\r\n                    onCropComplete={handleCropComplete}\r\n                    aspectRatio={aspectRatio}\r\n                    cropShape={cropShape}\r\n                />\r\n            )}\r\n        </>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\InstallPWA.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\InstallPWA.tsx:34:13\n  32 |         // Check if already installed\n  33 |         if (window.matchMedia('(display-mode: standalone)').matches) {\n> 34 |             setShowBanner(false)\n     |             ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  35 |         }\n  36 |\n  37 |         return () => {","line":34,"column":13,"nodeType":null,"endLine":34,"endColumn":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { Download, X } from 'lucide-react'\r\n\r\ninterface BeforeInstallPromptEvent extends Event {\r\n    prompt: () => Promise<void>\r\n    userChoice: Promise<{ outcome: 'accepted' | 'dismissed' }>\r\n}\r\n\r\n/**\r\n * PWA Install Prompt Component\r\n * Shows a banner to install the app when the browser supports it\r\n */\r\nexport function InstallPWA() {\r\n    const [deferredPrompt, setDeferredPrompt] = useState<BeforeInstallPromptEvent | null>(null)\r\n    const [showBanner, setShowBanner] = useState(false)\r\n\r\n    useEffect(() => {\r\n        // Check if user previously dismissed\r\n        const dismissed = localStorage.getItem('pwa-install-dismissed')\r\n        if (dismissed) return\r\n\r\n        const handleBeforeInstall = (e: Event) => {\r\n            e.preventDefault()\r\n            setDeferredPrompt(e as BeforeInstallPromptEvent)\r\n            setShowBanner(true)\r\n        }\r\n\r\n        window.addEventListener('beforeinstallprompt', handleBeforeInstall)\r\n\r\n        // Check if already installed\r\n        if (window.matchMedia('(display-mode: standalone)').matches) {\r\n            setShowBanner(false)\r\n        }\r\n\r\n        return () => {\r\n            window.removeEventListener('beforeinstallprompt', handleBeforeInstall)\r\n        }\r\n    }, [])\r\n\r\n    const handleInstall = async () => {\r\n        if (!deferredPrompt) return\r\n\r\n        await deferredPrompt.prompt()\r\n        const { outcome } = await deferredPrompt.userChoice\r\n\r\n        if (outcome === 'accepted') {\r\n            setShowBanner(false)\r\n        }\r\n        setDeferredPrompt(null)\r\n    }\r\n\r\n    const handleDismiss = () => {\r\n        setShowBanner(false)\r\n        localStorage.setItem('pwa-install-dismissed', 'true')\r\n    }\r\n\r\n    if (!showBanner) return null\r\n\r\n    return (\r\n        <div className=\"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:max-w-sm z-50 animate-in slide-in-from-bottom-4\">\r\n            <div className=\"bg-dark-surface border border-dark-border rounded-xl p-4 shadow-lg\">\r\n                <div className=\"flex items-start gap-3\">\r\n                    <div className=\"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0\">\r\n                        <Download className=\"w-5 h-5 text-primary\" />\r\n                    </div>\r\n                    <div className=\"flex-1 min-w-0\">\r\n                        <h3 className=\"text-sm font-medium text-gray-100\">\r\n                            Install SyriaHub\r\n                        </h3>\r\n                        <p className=\"text-xs text-gray-400 mt-0.5\">\r\n                            Add to your home screen for quick access and offline reading\r\n                        </p>\r\n                    </div>\r\n                    <button\r\n                        onClick={handleDismiss}\r\n                        className=\"text-gray-500 hover:text-gray-300 transition-colors\"\r\n                        aria-label=\"Dismiss\"\r\n                    >\r\n                        <X className=\"w-4 h-4\" />\r\n                    </button>\r\n                </div>\r\n                <div className=\"flex gap-2 mt-3\">\r\n                    <button\r\n                        onClick={handleInstall}\r\n                        className=\"flex-1 px-3 py-2 bg-primary text-white text-sm font-medium rounded-lg hover:bg-primary-dark transition-colors\"\r\n                    >\r\n                        Install\r\n                    </button>\r\n                    <button\r\n                        onClick={handleDismiss}\r\n                        className=\"px-3 py-2 text-gray-400 text-sm hover:text-gray-200 transition-colors\"\r\n                    >\r\n                        Not now\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\InviteManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\InviteMemberDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\JuryPanel.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchCases'. Either include it or remove the dependency array.","line":28,"column":8,"nodeType":"ArrayExpression","endLine":28,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchCases]","fix":{"range":[1037,1039],"text":"[fetchCases]"}}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":77,"column":55,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[2656,2706],"text":"You don&apos;t have any jury assignments at the moment."},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[2656,2706],"text":"You don&lsquo;t have any jury assignments at the moment."},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[2656,2706],"text":"You don&#39;t have any jury assignments at the moment."},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[2656,2706],"text":"You don&rsquo;t have any jury assignments at the moment."},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":240,"column":35,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[8997,9068],"text":"\r\n                            Author&apos;s Appeal\r\n                        "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[8997,9068],"text":"\r\n                            Author&lsquo;s Appeal\r\n                        "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[8997,9068],"text":"\r\n                            Author&#39;s Appeal\r\n                        "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[8997,9068],"text":"\r\n                            Author&rsquo;s Appeal\r\n                        "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect, useMemo } from 'react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { useToast } from '@/components/ui/toast'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from '@/components/ui/dialog'\r\nimport {\r\n    Scale, Clock, Users, CheckCircle, XCircle,\r\n    MinusCircle, AlertTriangle, Loader2, ChevronRight\r\n} from 'lucide-react'\r\nimport type { JuryCase, JuryVoteValue } from '@/types/advanced'\r\n\r\ninterface JuryPanelProps {\r\n    userId: string\r\n}\r\n\r\nexport function JuryPanel({ userId }: JuryPanelProps) {\r\n    const [cases, setCases] = useState<JuryCase[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [selectedCase, setSelectedCase] = useState<JuryCase | null>(null)\r\n    const [voteDialogOpen, setVoteDialogOpen] = useState(false)\r\n    const supabase = useMemo(() => createClient(), [])\r\n    const { showToast } = useToast()\r\n\r\n    useEffect(() => {\r\n        fetchCases()\r\n    }, [])\r\n\r\n    async function fetchCases() {\r\n        try {\r\n            const response = await fetch('/api/jury?status=active')\r\n            const data = await response.json()\r\n\r\n            if (data.cases) {\r\n                setCases(data.cases)\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching jury cases:', error)\r\n            showToast('Failed to load jury cases', 'error')\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    function getTimeRemaining(deadline: string): string {\r\n        const now = new Date()\r\n        const end = new Date(deadline)\r\n        const diff = end.getTime() - now.getTime()\r\n\r\n        if (diff <= 0) return 'Expired'\r\n\r\n        const hours = Math.floor(diff / (1000 * 60 * 60))\r\n        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60))\r\n\r\n        if (hours > 24) {\r\n            const days = Math.floor(hours / 24)\r\n            return `${days}d ${hours % 24}h remaining`\r\n        }\r\n\r\n        return `${hours}h ${minutes}m remaining`\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center py-12\">\r\n                <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    if (cases.length === 0) {\r\n        return (\r\n            <div className=\"text-center py-12 bg-background-alt/50 rounded-xl\">\r\n                <Scale className=\"w-12 h-12 mx-auto mb-4 text-text-light/50\" />\r\n                <h3 className=\"text-lg font-medium mb-2\">No Active Jury Cases</h3>\r\n                <p className=\"text-text-light\">You don't have any jury assignments at the moment.</p>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-4\">\r\n            <div className=\"flex items-center justify-between mb-6\">\r\n                <h2 className=\"text-xl font-semibold flex items-center gap-2\">\r\n                    <Scale className=\"w-5 h-5\" />\r\n                    Jury Duty\r\n                </h2>\r\n                <span className=\"text-sm text-text-light\">\r\n                    {cases.length} active case{cases.length !== 1 ? 's' : ''}\r\n                </span>\r\n            </div>\r\n\r\n            {cases.map((juryCase) => (\r\n                <JuryCaseCard\r\n                    key={juryCase.id}\r\n                    juryCase={juryCase}\r\n                    timeRemaining={getTimeRemaining(juryCase.deadline)}\r\n                    onVote={() => {\r\n                        setSelectedCase(juryCase)\r\n                        setVoteDialogOpen(true)\r\n                    }}\r\n                />\r\n            ))}\r\n\r\n            {selectedCase && (\r\n                <VoteDialog\r\n                    open={voteDialogOpen}\r\n                    onClose={() => setVoteDialogOpen(false)}\r\n                    juryCase={selectedCase}\r\n                    onVoteSubmitted={() => {\r\n                        setVoteDialogOpen(false)\r\n                        fetchCases()\r\n                    }}\r\n                />\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface JuryCaseCardProps {\r\n    juryCase: JuryCase\r\n    timeRemaining: string\r\n    onVote: () => void\r\n}\r\n\r\nfunction JuryCaseCard({ juryCase, timeRemaining, onVote }: JuryCaseCardProps) {\r\n    const appeal = juryCase.appeal\r\n    const isUrgent = timeRemaining.includes('h') && !timeRemaining.includes('d')\r\n\r\n    return (\r\n        <div className=\"bg-white dark:bg-dark-card rounded-xl border border-gray-200 dark:border-dark-border p-5 hover:shadow-lg transition-shadow\">\r\n            <div className=\"flex items-start justify-between gap-4\">\r\n                <div className=\"flex-1 min-w-0\">\r\n                    {/* Post title */}\r\n                    <h3 className=\"font-medium text-lg mb-2 truncate\">\r\n                        {appeal?.post?.title || 'Appeal Case'}\r\n                    </h3>\r\n\r\n                    {/* Appeal reason preview */}\r\n                    <p className=\"text-sm text-text-light dark:text-dark-text-muted line-clamp-2 mb-3\">\r\n                        <span className=\"font-medium\">Appeal reason: </span>\r\n                        {appeal?.dispute_reason}\r\n                    </p>\r\n\r\n                    {/* Stats */}\r\n                    <div className=\"flex items-center gap-4 text-sm\">\r\n                        <span className=\"flex items-center gap-1 text-text-light\">\r\n                            <Users className=\"w-4 h-4\" />\r\n                            {juryCase.total_votes}/{juryCase.required_votes} votes\r\n                        </span>\r\n                        <span className={`flex items-center gap-1 ${isUrgent ? 'text-orange-600' : 'text-text-light'}`}>\r\n                            <Clock className=\"w-4 h-4\" />\r\n                            {timeRemaining}\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n\r\n                <Button onClick={onVote} className=\"shrink-0 gap-2\">\r\n                    Cast Vote\r\n                    <ChevronRight className=\"w-4 h-4\" />\r\n                </Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface VoteDialogProps {\r\n    open: boolean\r\n    onClose: () => void\r\n    juryCase: JuryCase\r\n    onVoteSubmitted: () => void\r\n}\r\n\r\nfunction VoteDialog({ open, onClose, juryCase, onVoteSubmitted }: VoteDialogProps) {\r\n    const [vote, setVote] = useState<JuryVoteValue | null>(null)\r\n    const [reasoning, setReasoning] = useState('')\r\n    const [submitting, setSubmitting] = useState(false)\r\n    const { showToast } = useToast()\r\n\r\n    async function handleSubmit() {\r\n        if (!vote || reasoning.length < 20) {\r\n            showToast('Please select a vote and provide reasoning (min 20 chars)', 'error')\r\n            return\r\n        }\r\n\r\n        setSubmitting(true)\r\n        try {\r\n            const response = await fetch('/api/jury', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    deliberation_id: juryCase.id,\r\n                    vote,\r\n                    reasoning\r\n                })\r\n            })\r\n\r\n            const data = await response.json()\r\n\r\n            if (!response.ok) {\r\n                throw new Error(data.error || 'Failed to submit vote')\r\n            }\r\n\r\n            showToast(data.message || 'Vote submitted successfully', 'success')\r\n            onVoteSubmitted()\r\n        } catch (error: any) {\r\n            showToast(error.message || 'Failed to submit vote', 'error')\r\n        } finally {\r\n            setSubmitting(false)\r\n        }\r\n    }\r\n\r\n    const appeal = juryCase.appeal\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onClose}>\r\n            <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n                <DialogHeader>\r\n                    <DialogTitle className=\"flex items-center gap-2\">\r\n                        <Scale className=\"w-5 h-5 text-primary\" />\r\n                        Cast Your Vote\r\n                    </DialogTitle>\r\n                </DialogHeader>\r\n\r\n                <div className=\"space-y-6 py-4\">\r\n                    {/* Case Details */}\r\n                    <div className=\"bg-background-alt dark:bg-dark-bg rounded-lg p-4\">\r\n                        <h4 className=\"font-medium mb-2\">Flagged Content</h4>\r\n                        <p className=\"font-semibold\">{appeal?.post?.title}</p>\r\n                        <p className=\"text-sm text-text-light mt-1 line-clamp-3\">\r\n                            {typeof appeal?.post?.content === 'string'\r\n                                ? appeal.post.content.substring(0, 200) + '...'\r\n                                : ''}\r\n                        </p>\r\n                    </div>\r\n\r\n                    <div className=\"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-4 border border-orange-200 dark:border-orange-800\">\r\n                        <h4 className=\"font-medium mb-2 text-orange-800 dark:text-orange-300\">\r\n                            Author's Appeal\r\n                        </h4>\r\n                        <p className=\"text-sm\">{appeal?.dispute_reason}</p>\r\n                    </div>\r\n\r\n                    {/* Vote Options */}\r\n                    <div>\r\n                        <h4 className=\"font-medium mb-3\">Your Decision</h4>\r\n                        <div className=\"grid grid-cols-3 gap-3\">\r\n                            <VoteOption\r\n                                value=\"uphold\"\r\n                                label=\"Uphold Flag\"\r\n                                description=\"Content should remain flagged\"\r\n                                icon={<XCircle className=\"w-5 h-5\" />}\r\n                                selected={vote === 'uphold'}\r\n                                onClick={() => setVote('uphold')}\r\n                                color=\"red\"\r\n                            />\r\n                            <VoteOption\r\n                                value=\"overturn\"\r\n                                label=\"Overturn\"\r\n                                description=\"Restore the content\"\r\n                                icon={<CheckCircle className=\"w-5 h-5\" />}\r\n                                selected={vote === 'overturn'}\r\n                                onClick={() => setVote('overturn')}\r\n                                color=\"green\"\r\n                            />\r\n                            <VoteOption\r\n                                value=\"abstain\"\r\n                                label=\"Abstain\"\r\n                                description=\"Cannot decide\"\r\n                                icon={<MinusCircle className=\"w-5 h-5\" />}\r\n                                selected={vote === 'abstain'}\r\n                                onClick={() => setVote('abstain')}\r\n                                color=\"gray\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Reasoning */}\r\n                    <div>\r\n                        <label className=\"block font-medium mb-2\">\r\n                            Explain Your Decision <span className=\"text-red-500\">*</span>\r\n                        </label>\r\n                        <textarea\r\n                            value={reasoning}\r\n                            onChange={(e) => setReasoning(e.target.value)}\r\n                            placeholder=\"Provide your reasoning for this decision (minimum 20 characters)...\"\r\n                            className=\"w-full h-32 px-3 py-2 rounded-lg border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg resize-none\"\r\n                        />\r\n                        <p className=\"text-xs text-text-light mt-1\">\r\n                            {reasoning.length}/20 minimum characters\r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* Warning */}\r\n                    <div className=\"flex items-start gap-2 text-sm text-amber-700 dark:text-amber-400 bg-amber-50 dark:bg-amber-900/20 p-3 rounded-lg\">\r\n                        <AlertTriangle className=\"w-4 h-4 shrink-0 mt-0.5\" />\r\n                        <p>\r\n                            Your vote is anonymous until the deliberation concludes.\r\n                            Once submitted, you cannot change your vote.\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <DialogFooter>\r\n                    <Button variant=\"outline\" onClick={onClose} disabled={submitting}>\r\n                        Cancel\r\n                    </Button>\r\n                    <Button\r\n                        onClick={handleSubmit}\r\n                        disabled={!vote || reasoning.length < 20 || submitting}\r\n                        className=\"gap-2\"\r\n                    >\r\n                        {submitting ? (\r\n                            <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                        ) : (\r\n                            <Scale className=\"w-4 h-4\" />\r\n                        )}\r\n                        Submit Vote\r\n                    </Button>\r\n                </DialogFooter>\r\n            </DialogContent>\r\n        </Dialog>\r\n    )\r\n}\r\n\r\ninterface VoteOptionProps {\r\n    value: JuryVoteValue\r\n    label: string\r\n    description: string\r\n    icon: React.ReactNode\r\n    selected: boolean\r\n    onClick: () => void\r\n    color: 'red' | 'green' | 'gray'\r\n}\r\n\r\nfunction VoteOption({ label, description, icon, selected, onClick, color }: VoteOptionProps) {\r\n    const colorClasses = {\r\n        red: selected\r\n            ? 'border-red-500 bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-300'\r\n            : 'border-gray-200 dark:border-dark-border hover:border-red-300',\r\n        green: selected\r\n            ? 'border-green-500 bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-300'\r\n            : 'border-gray-200 dark:border-dark-border hover:border-green-300',\r\n        gray: selected\r\n            ? 'border-gray-500 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300'\r\n            : 'border-gray-200 dark:border-dark-border hover:border-gray-400'\r\n    }\r\n\r\n    return (\r\n        <button\r\n            onClick={onClick}\r\n            className={`p-4 rounded-lg border-2 text-center transition-all ${colorClasses[color]}`}\r\n        >\r\n            <div className=\"flex justify-center mb-2\">{icon}</div>\r\n            <div className=\"font-medium text-sm\">{label}</div>\r\n            <div className=\"text-xs text-text-light mt-1\">{description}</div>\r\n        </button>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\KnowledgeGraph.tsx","messages":[{"ruleId":"react-hooks/preserve-manual-memoization","severity":2,"message":"Compilation Skipped: Existing memoization could not be preserved\n\nReact Compiler has skipped optimizing this component because the existing manual memoization could not be preserved. The inferred dependencies did not match the manually specified dependencies, which could cause the value to change more or less frequently than expected. The inferred dependency was `edges`, but the source dependencies were [draggedNode, dragOffset, getNodeAtPosition, zoomLevel]. Inferred different dependency than source.\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\KnowledgeGraph.tsx:290:41\n  288 |     }, [getNodeAtPosition, positions, zoomLevel])\n  289 |\n> 290 |     const handleMouseMove = useCallback((e: React.MouseEvent<HTMLCanvasElement>) => {\n      |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 291 |         const rect = e.currentTarget.getBoundingClientRect()\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 292 |         const x = e.clientX - rect.left\n      ΓÇª\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 345 |         }\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 346 |     }, [draggedNode, dragOffset, getNodeAtPosition, zoomLevel])\n      | ^^^^^^ Could not preserve existing manual memoization\n  347 |\n  348 |     const handleMouseUp = useCallback(() => {\n  349 |         setDraggedNode(null)","line":290,"column":41,"nodeType":null,"endLine":346,"endColumn":6},{"ruleId":"react-hooks/preserve-manual-memoization","severity":2,"message":"Compilation Skipped: Existing memoization could not be preserved\n\nReact Compiler has skipped optimizing this component because the existing manual memoization could not be preserved. The inferred dependencies did not match the manually specified dependencies, which could cause the value to change more or less frequently than expected. The inferred dependency was `positions`, but the source dependencies were [draggedNode, dragOffset, getNodeAtPosition, zoomLevel]. Inferred different dependency than source.\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\KnowledgeGraph.tsx:290:41\n  288 |     }, [getNodeAtPosition, positions, zoomLevel])\n  289 |\n> 290 |     const handleMouseMove = useCallback((e: React.MouseEvent<HTMLCanvasElement>) => {\n      |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 291 |         const rect = e.currentTarget.getBoundingClientRect()\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 292 |         const x = e.clientX - rect.left\n      ΓÇª\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 345 |         }\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 346 |     }, [draggedNode, dragOffset, getNodeAtPosition, zoomLevel])\n      | ^^^^^^ Could not preserve existing manual memoization\n  347 |\n  348 |     const handleMouseUp = useCallback(() => {\n  349 |         setDraggedNode(null)","line":290,"column":41,"nodeType":null,"endLine":346,"endColumn":6},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'edges' and 'positions'. Either include them or remove the dependency array.","line":346,"column":8,"nodeType":"ArrayExpression","endLine":346,"endColumn":63,"suggestions":[{"desc":"Update the dependencies array to be: [draggedNode, zoomLevel, dragOffset.x, dragOffset.y, getNodeAtPosition, edges, positions]","fix":{"range":[13501,13556],"text":"[draggedNode, zoomLevel, dragOffset.x, dragOffset.y, getNodeAtPosition, edges, positions]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has an unnecessary dependency: 'positions'. Either exclude it or remove the dependency array.","line":369,"column":8,"nodeType":"ArrayExpression","endLine":369,"endColumn":38,"suggestions":[{"desc":"Update the dependencies array to be: [getNodeAtPosition]","fix":{"range":[14271,14301],"text":"[getNodeAtPosition]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useEffect, useState, useRef, useMemo, useCallback } from 'react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { useTheme } from 'next-themes'\r\nimport {\r\n    Loader2,\r\n    Maximize2,\r\n    RotateCcw,\r\n    ZoomIn,\r\n    ZoomOut,\r\n    X\r\n} from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog'\r\n\r\n// Types\r\ninterface KnowledgeGraphProps {\r\n    centerPostId: string\r\n}\r\n\r\ninterface GraphNode {\r\n    id: string\r\n    title: string\r\n    group: 'center' | 'fork' | 'citation' | 'related' | 'author'\r\n    tag: string\r\n    authorName?: string\r\n}\r\n\r\ninterface GraphEdge {\r\n    source: string\r\n    target: string\r\n    type: 'fork' | 'citation' | 'shared_tag' | 'shared_author'\r\n}\r\n\r\ntype RelationType = 'fork' | 'citation' | 'shared_tag' | 'shared_author'\r\n\r\n// Design System Colors\r\nconst THEME_COLORS = {\r\n    primary: '#1A3D40',\r\n    primaryLight: '#2A5558',\r\n    secondary: '#4AA3A5',\r\n    accent: '#C9A227',         // Golden amber like reference\r\n    citation: '#C41E3A',       // Heritage Red for citations\r\n    textLight: '#5A6A72',\r\n    darkBg: '#0F1419',         // Darker background like reference\r\n    darkSurface: '#1A2028',\r\n    lightBg: '#FAFAFA',\r\n    lightSurface: '#FFFFFF',\r\n    textDark: '#2A3A42',\r\n    textDarkMode: '#E8EDEE'\r\n}\r\n\r\n// Node colors by relationship type\r\nconst NODE_COLORS: Record<string, { bg: string, border: string, text: string }> = {\r\n    center: { bg: THEME_COLORS.secondary, border: THEME_COLORS.primaryLight, text: '#FFFFFF' },\r\n    fork: { bg: THEME_COLORS.accent, border: '#B8911F', text: '#1A1A1A' },\r\n    citation: { bg: THEME_COLORS.citation, border: '#A31830', text: '#FFFFFF' },\r\n    related: { bg: THEME_COLORS.primaryLight, border: THEME_COLORS.primary, text: '#FFFFFF' },\r\n    author: { bg: '#6366F1', border: '#4F46E5', text: '#FFFFFF' }\r\n}\r\n\r\nconst RELATION_LABELS: Record<RelationType, string> = {\r\n    fork: 'Fork',\r\n    citation: 'Cites This',\r\n    shared_tag: 'Related Topic',\r\n    shared_author: 'Same Author'\r\n}\r\n\r\n// Edge descriptions for hover tooltips\r\nconst EDGE_DESCRIPTIONS: Record<RelationType, string> = {\r\n    fork: 'This work was derived from or built upon the original',\r\n    citation: 'This work references or cites the original',\r\n    shared_tag: 'These works share common topics or themes',\r\n    shared_author: 'These works are by the same author'\r\n}\r\n\r\n// Helper component for dialog canvas - fully self-contained with its own state\r\nfunction DialogGraphCanvas({\r\n    nodes,\r\n    edges,\r\n    calculatePositions,\r\n    expanded\r\n}: {\r\n    nodes: GraphNode[]\r\n    edges: GraphEdge[]\r\n    calculatePositions: (width: number, height: number) => Map<string, { x: number, y: number }>\r\n    expanded: boolean\r\n}) {\r\n    const containerRef = useRef<HTMLDivElement>(null)\r\n    const canvasRef = useRef<HTMLCanvasElement>(null)\r\n    const [positions, setPositions] = useState<Map<string, { x: number, y: number }>>(new Map())\r\n    const [zoomLevel, setZoomLevel] = useState(0.9)\r\n    const [draggedNode, setDraggedNode] = useState<string | null>(null)\r\n    const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 })\r\n    const [hoveredNode, setHoveredNode] = useState<GraphNode | null>(null)\r\n    const [selectedNode, setSelectedNode] = useState<GraphNode | null>(null) // For click-to-show-info panel\r\n    const [hoveredEdge, setHoveredEdge] = useState<GraphEdge | null>(null)\r\n    const hasDragged = useRef(false)\r\n\r\n    // Initialize positions when dialog opens\r\n    useEffect(() => {\r\n        if (expanded && containerRef.current && nodes.length > 0) {\r\n            const timer = setTimeout(() => {\r\n                if (containerRef.current) {\r\n                    const rect = containerRef.current.getBoundingClientRect()\r\n                    const newPositions = calculatePositions(rect.width, rect.height)\r\n                    setPositions(newPositions)\r\n                }\r\n            }, 50)\r\n            return () => clearTimeout(timer)\r\n        }\r\n    }, [expanded, nodes, calculatePositions])\r\n\r\n    // Draw function for dialog\r\n    const drawDialogGraph = useCallback(() => {\r\n        if (!canvasRef.current || !containerRef.current || positions.size === 0) return\r\n\r\n        const canvas = canvasRef.current\r\n        const rect = containerRef.current.getBoundingClientRect()\r\n        const width = rect.width\r\n        const height = rect.height\r\n        const ctx = canvas.getContext('2d')\r\n        if (!ctx) return\r\n\r\n        const dpr = window.devicePixelRatio || 1\r\n        canvas.width = width * dpr\r\n        canvas.height = height * dpr\r\n        canvas.style.width = `${width}px`\r\n        canvas.style.height = `${height}px`\r\n        ctx.scale(dpr, dpr)\r\n\r\n        // Clear\r\n        ctx.fillStyle = THEME_COLORS.darkBg\r\n        ctx.fillRect(0, 0, width, height)\r\n\r\n        // Apply zoom\r\n        ctx.save()\r\n        const centerX = width / 2\r\n        const centerY = height / 2\r\n        ctx.translate(centerX, centerY)\r\n        ctx.scale(zoomLevel, zoomLevel)\r\n        ctx.translate(-centerX, -centerY)\r\n\r\n        // Draw edges with semantic styling\r\n        edges.forEach(edge => {\r\n            const sourcePos = positions.get(edge.source)\r\n            const targetPos = positions.get(edge.target)\r\n            if (!sourcePos || !targetPos) return\r\n\r\n            const midX = (sourcePos.x + targetPos.x) / 2\r\n            const midY = (sourcePos.y + targetPos.y) / 2\r\n            const dx = targetPos.x - sourcePos.x\r\n            const dy = targetPos.y - sourcePos.y\r\n            const dist = Math.sqrt(dx * dx + dy * dy)\r\n            const curvature = dist * 0.15\r\n            const perpX = -dy / dist * curvature\r\n            const perpY = dx / dist * curvature\r\n\r\n            const edgeColor = edge.type === 'citation' ? THEME_COLORS.citation :\r\n                edge.type === 'fork' ? THEME_COLORS.accent :\r\n                    edge.type === 'shared_author' ? '#6366F1' : THEME_COLORS.secondary\r\n\r\n            const isHovered = hoveredEdge?.source === edge.source && hoveredEdge?.target === edge.target\r\n\r\n            // Apply glow effect when hovered\r\n            if (isHovered) {\r\n                ctx.shadowColor = edgeColor\r\n                ctx.shadowBlur = 12\r\n            }\r\n\r\n            ctx.beginPath()\r\n            ctx.moveTo(sourcePos.x, sourcePos.y)\r\n            ctx.quadraticCurveTo(midX + perpX, midY + perpY, targetPos.x, targetPos.y)\r\n\r\n            // Solid for forks (derived work), dashed for citations\r\n            if (edge.type === 'citation' || edge.type === 'shared_tag') {\r\n                ctx.setLineDash([6, 4])\r\n            } else {\r\n                ctx.setLineDash([])\r\n            }\r\n\r\n            // Thicker when hovered\r\n            ctx.lineWidth = isHovered ? 3 : 2\r\n            ctx.strokeStyle = isHovered ? edgeColor : `${edgeColor}60`\r\n            ctx.stroke()\r\n\r\n            // Reset\r\n            ctx.setLineDash([])\r\n            ctx.shadowColor = 'transparent'\r\n            ctx.shadowBlur = 0\r\n        })\r\n\r\n        // Draw nodes\r\n        nodes.forEach(node => {\r\n            const pos = positions.get(node.id)\r\n            if (!pos) return\r\n\r\n            const colors = NODE_COLORS[node.group]\r\n            const isCenter = node.group === 'center'\r\n            const isHovered = hoveredNode?.id === node.id\r\n            const nodeWidth = isCenter ? 110 : 90\r\n            const nodeHeight = isCenter ? 44 : 36\r\n            const radius = 6\r\n\r\n            if (isHovered || isCenter) {\r\n                ctx.shadowColor = `${colors.bg}40`\r\n                ctx.shadowBlur = 15\r\n                ctx.shadowOffsetY = 4\r\n            }\r\n\r\n            ctx.beginPath()\r\n            ctx.roundRect(pos.x - nodeWidth / 2, pos.y - nodeHeight / 2, nodeWidth, nodeHeight, radius)\r\n            ctx.fillStyle = colors.bg\r\n            ctx.fill()\r\n            ctx.strokeStyle = colors.border\r\n            ctx.lineWidth = isHovered ? 3 : 2\r\n            ctx.stroke()\r\n\r\n            ctx.shadowColor = 'transparent'\r\n            ctx.shadowBlur = 0\r\n            ctx.shadowOffsetY = 0\r\n\r\n            ctx.fillStyle = colors.text\r\n            ctx.font = `${isCenter ? '600' : '500'} ${isCenter ? 12 : 11}px Inter, system-ui, sans-serif`\r\n            ctx.textAlign = 'center'\r\n            ctx.textBaseline = 'middle'\r\n            const title = node.title.length > 12 ? node.title.substring(0, 11) + 'ΓÇª' : node.title\r\n            ctx.fillText(title, pos.x, pos.y - (isCenter ? 5 : 3))\r\n\r\n            ctx.font = '500 9px Inter, system-ui, sans-serif'\r\n            ctx.fillStyle = `${colors.text}99`\r\n            const tag = node.tag.length > 12 ? node.tag.substring(0, 11) + 'ΓÇª' : node.tag\r\n            ctx.fillText(tag, pos.x, pos.y + (isCenter ? 10 : 8))\r\n        })\r\n\r\n        ctx.restore()\r\n    }, [nodes, edges, positions, zoomLevel, hoveredNode, hoveredEdge])\r\n\r\n    // Redraw when positions/zoom change\r\n    useEffect(() => {\r\n        drawDialogGraph()\r\n    }, [drawDialogGraph])\r\n\r\n    // Get node at position (adjusted for zoom)\r\n    const getNodeAtPosition = useCallback((x: number, y: number, rect: DOMRect): GraphNode | null => {\r\n        if (positions.size === 0) return null\r\n        const centerX = rect.width / 2\r\n        const centerY = rect.height / 2\r\n        // Adjust for zoom - transform screen coords back to canvas coords\r\n        const adjustedX = centerX + (x - centerX) / zoomLevel\r\n        const adjustedY = centerY + (y - centerY) / zoomLevel\r\n\r\n        for (const node of nodes) {\r\n            const pos = positions.get(node.id)\r\n            if (!pos) continue\r\n            const isCenter = node.group === 'center'\r\n            const nodeWidth = isCenter ? 110 : 90\r\n            const nodeHeight = isCenter ? 44 : 36\r\n\r\n            // Check if click is within node bounds\r\n            if (adjustedX >= pos.x - nodeWidth / 2 && adjustedX <= pos.x + nodeWidth / 2 &&\r\n                adjustedY >= pos.y - nodeHeight / 2 && adjustedY <= pos.y + nodeHeight / 2) {\r\n                return node\r\n            }\r\n        }\r\n        return null\r\n    }, [nodes, positions, zoomLevel])\r\n\r\n    const handleMouseDown = useCallback((e: React.MouseEvent<HTMLCanvasElement>) => {\r\n        const rect = e.currentTarget.getBoundingClientRect()\r\n        const x = e.clientX - rect.left\r\n        const y = e.clientY - rect.top\r\n        hasDragged.current = false\r\n        const node = getNodeAtPosition(x, y, rect)\r\n        if (node) {\r\n            const pos = positions.get(node.id)\r\n            if (pos) {\r\n                // Adjust for zoom\r\n                const centerX = rect.width / 2\r\n                const centerY = rect.height / 2\r\n                const adjustedX = centerX + (x - centerX) / zoomLevel\r\n                const adjustedY = centerY + (y - centerY) / zoomLevel\r\n                setDraggedNode(node.id)\r\n                setDragOffset({ x: adjustedX - pos.x, y: adjustedY - pos.y })\r\n            }\r\n        }\r\n    }, [getNodeAtPosition, positions, zoomLevel])\r\n\r\n    const handleMouseMove = useCallback((e: React.MouseEvent<HTMLCanvasElement>) => {\r\n        const rect = e.currentTarget.getBoundingClientRect()\r\n        const x = e.clientX - rect.left\r\n        const y = e.clientY - rect.top\r\n\r\n        if (draggedNode) {\r\n            hasDragged.current = true\r\n            const centerX = rect.width / 2\r\n            const centerY = rect.height / 2\r\n            const adjustedX = centerX + (x - centerX) / zoomLevel\r\n            const adjustedY = centerY + (y - centerY) / zoomLevel\r\n            const padding = 70\r\n            const newX = Math.max(padding, Math.min(rect.width - padding, adjustedX - dragOffset.x))\r\n            const newY = Math.max(padding, Math.min(rect.height - padding, adjustedY - dragOffset.y))\r\n\r\n            setPositions(prev => {\r\n                const next = new Map(prev)\r\n                next.set(draggedNode, { x: newX, y: newY })\r\n                return next\r\n            })\r\n        } else {\r\n            // Check for node hover first\r\n            const node = getNodeAtPosition(x, y, rect)\r\n            setHoveredNode(node)\r\n\r\n            // Only check for edge hover if not hovering a node\r\n            if (!node && containerRef.current) {\r\n                const centerX = rect.width / 2\r\n                const centerY = rect.height / 2\r\n                const adjustedX = centerX + (x - centerX) / zoomLevel\r\n                const adjustedY = centerY + (y - centerY) / zoomLevel\r\n\r\n                // Find if hovering near an edge\r\n                let foundEdge: GraphEdge | null = null\r\n                for (const edge of edges) {\r\n                    const sourcePos = positions.get(edge.source)\r\n                    const targetPos = positions.get(edge.target)\r\n                    if (!sourcePos || !targetPos) continue\r\n\r\n                    // Check distance to line (simplified - check distance to midpoint)\r\n                    const midX = (sourcePos.x + targetPos.x) / 2\r\n                    const midY = (sourcePos.y + targetPos.y) / 2\r\n                    const dist = Math.sqrt((adjustedX - midX) ** 2 + (adjustedY - midY) ** 2)\r\n\r\n                    if (dist < 30) {\r\n                        foundEdge = edge\r\n                        break\r\n                    }\r\n                }\r\n                setHoveredEdge(foundEdge)\r\n            } else {\r\n                setHoveredEdge(null)\r\n            }\r\n\r\n            e.currentTarget.style.cursor = node ? 'pointer' : 'default'\r\n        }\r\n    }, [draggedNode, dragOffset, getNodeAtPosition, zoomLevel])\r\n\r\n    const handleMouseUp = useCallback(() => {\r\n        setDraggedNode(null)\r\n    }, [])\r\n\r\n    const handleClick = useCallback((e: React.MouseEvent<HTMLCanvasElement>) => {\r\n        if (hasDragged.current) {\r\n            hasDragged.current = false\r\n            return\r\n        }\r\n        const rect = e.currentTarget.getBoundingClientRect()\r\n        const x = e.clientX - rect.left\r\n        const y = e.clientY - rect.top\r\n        const node = getNodeAtPosition(x, y, rect)\r\n\r\n        // Click to select node (shows info panel)\r\n        if (node) {\r\n            setSelectedNode(node)\r\n        } else {\r\n            // Click on empty space clears selection\r\n            setSelectedNode(null)\r\n        }\r\n    }, [getNodeAtPosition, positions])\r\n\r\n    const resetLayout = useCallback(() => {\r\n        if (containerRef.current) {\r\n            const rect = containerRef.current.getBoundingClientRect()\r\n            setPositions(calculatePositions(rect.width, rect.height))\r\n        }\r\n        setZoomLevel(0.9)\r\n    }, [calculatePositions])\r\n\r\n    return (\r\n        <div ref={containerRef} className=\"absolute inset-0\">\r\n            <canvas\r\n                ref={canvasRef}\r\n                className=\"absolute inset-0\"\r\n                onMouseDown={handleMouseDown}\r\n                onMouseMove={handleMouseMove}\r\n                onMouseUp={handleMouseUp}\r\n                onMouseLeave={handleMouseUp}\r\n                onClick={handleClick}\r\n            />\r\n\r\n            {/* Info Panel - Always visible */}\r\n            <div className=\"absolute top-3 left-3 z-10 bg-[#1A2028]/95 backdrop-blur-md rounded-lg border border-dark-border p-4 shadow-lg w-[280px]\">\r\n                {/* Header */}\r\n                <div className=\"text-[10px] text-dark-text-muted uppercase tracking-wider mb-3 pb-2 border-b border-dark-border\">\r\n                    Node Details\r\n                </div>\r\n\r\n                {selectedNode ? (\r\n                    <>\r\n                        {/* Relationship Badge */}\r\n                        <div className=\"flex items-center justify-between mb-3\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <div className=\"w-3 h-3 rounded\" style={{ backgroundColor: NODE_COLORS[selectedNode.group].bg }} />\r\n                                <span className=\"text-xs font-medium text-dark-text uppercase tracking-wide\">\r\n                                    {RELATION_LABELS[selectedNode.group as RelationType] || selectedNode.group}\r\n                                </span>\r\n                            </div>\r\n                            <button\r\n                                onClick={() => setSelectedNode(null)}\r\n                                className=\"text-dark-text-muted hover:text-dark-text transition-colors p-1 hover:bg-dark-border/30 rounded\"\r\n                            >\r\n                                <X className=\"w-3.5 h-3.5\" />\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Title */}\r\n                        <div className=\"text-base font-semibold text-dark-text mb-2 leading-tight\">\r\n                            {selectedNode.title}\r\n                        </div>\r\n\r\n                        {/* Author */}\r\n                        {selectedNode.authorName && (\r\n                            <div className=\"flex items-center gap-2 text-sm text-dark-text-muted mb-2\">\r\n                                <span className=\"text-dark-text-muted/60\">By</span>\r\n                                <span className=\"text-dark-text\">{selectedNode.authorName}</span>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Tag */}\r\n                        <div className=\"inline-block bg-dark-border/40 text-xs text-dark-text-muted px-2 py-1 rounded mb-3\">\r\n                            #{selectedNode.tag}\r\n                        </div>\r\n\r\n                        {/* Relationship Explanation */}\r\n                        <div className=\"bg-dark-border/20 rounded p-2 mb-3\">\r\n                            <div className=\"text-[10px] text-dark-text-muted uppercase tracking-wider mb-1\">Connection</div>\r\n                            <div className=\"text-xs text-dark-text\">\r\n                                {selectedNode.group === 'center' && \"This is the current post you're viewing\"}\r\n                                {selectedNode.group === 'fork' && \"This work was derived from or built upon the original\"}\r\n                                {selectedNode.group === 'citation' && \"This work references or cites the original\"}\r\n                                {selectedNode.group === 'related' && \"Shares common topics or themes\"}\r\n                                {selectedNode.group === 'author' && \"Written by the same author\"}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Action Button */}\r\n                        {selectedNode.group !== 'center' && (\r\n                            <Button\r\n                                onClick={() => window.location.href = `/post/${selectedNode.id}`}\r\n                                className=\"w-full bg-secondary hover:bg-secondary/80 text-white text-sm h-9 font-medium\"\r\n                            >\r\n                                View Post ΓåÆ\r\n                            </Button>\r\n                        )}\r\n                        {selectedNode.group === 'center' && (\r\n                            <div className=\"text-center text-xs text-secondary py-2\">\r\n                                Currently viewing this post\r\n                            </div>\r\n                        )}\r\n                    </>\r\n                ) : hoveredEdge ? (\r\n                    <>\r\n                        {/* Edge Hover Info */}\r\n                        <div className=\"flex items-center gap-2 mb-3\">\r\n                            <div className=\"w-8 h-0.5\" style={{\r\n                                backgroundColor: hoveredEdge.type === 'citation' ? THEME_COLORS.citation :\r\n                                    hoveredEdge.type === 'fork' ? THEME_COLORS.accent : THEME_COLORS.secondary,\r\n                            }} />\r\n                            <span className=\"text-sm font-medium text-dark-text uppercase tracking-wide\">\r\n                                {RELATION_LABELS[hoveredEdge.type]}\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"text-sm text-dark-text\">\r\n                            {EDGE_DESCRIPTIONS[hoveredEdge.type]}\r\n                        </div>\r\n                    </>\r\n                ) : (\r\n                    <>\r\n                        {/* Empty State - Instructions */}\r\n                        <div className=\"text-center py-4\">\r\n                            <div className=\"text-4xl mb-3 opacity-40\">≡ƒöì</div>\r\n                            <div className=\"text-sm text-dark-text mb-2\">Select a Node</div>\r\n                            <div className=\"text-xs text-dark-text-muted leading-relaxed\">\r\n                                Click on any node to see details about how it connects to this work\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Quick Stats */}\r\n                        <div className=\"border-t border-dark-border pt-3 mt-3\">\r\n                            <div className=\"text-[10px] text-dark-text-muted uppercase tracking-wider mb-2\">Graph Overview</div>\r\n                            <div className=\"grid grid-cols-2 gap-2 text-xs\">\r\n                                <div className=\"bg-dark-border/30 rounded p-2 text-center\">\r\n                                    <div className=\"text-lg font-bold text-dark-text\">{nodes.length}</div>\r\n                                    <div className=\"text-dark-text-muted\">Nodes</div>\r\n                                </div>\r\n                                <div className=\"bg-dark-border/30 rounded p-2 text-center\">\r\n                                    <div className=\"text-lg font-bold text-dark-text\">{edges.length}</div>\r\n                                    <div className=\"text-dark-text-muted\">Connections</div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </>\r\n                )}\r\n            </div>\r\n\r\n            {/* Controls */}\r\n            <div className=\"absolute bottom-4 left-1/2 -translate-x-1/2 z-10 flex items-center gap-1 bg-[#1A2028]/95 backdrop-blur-md rounded-full border border-dark-border p-1.5 shadow-lg\">\r\n                <Button variant=\"ghost\" size=\"icon\" onClick={() => setZoomLevel(z => Math.min(z * 1.2, 2))} className=\"h-8 w-8 rounded-full text-dark-text-muted hover:text-dark-text hover:bg-dark-border/50\" title=\"Zoom in\">\r\n                    <ZoomIn className=\"w-4 h-4\" />\r\n                </Button>\r\n                <Button variant=\"ghost\" size=\"icon\" onClick={() => setZoomLevel(z => Math.max(z / 1.2, 0.4))} className=\"h-8 w-8 rounded-full text-dark-text-muted hover:text-dark-text hover:bg-dark-border/50\" title=\"Zoom out\">\r\n                    <ZoomOut className=\"w-4 h-4\" />\r\n                </Button>\r\n                <div className=\"h-4 w-px bg-dark-border mx-1\" />\r\n                <Button variant=\"ghost\" size=\"icon\" onClick={resetLayout} className=\"h-8 w-8 rounded-full text-dark-text-muted hover:text-dark-text hover:bg-dark-border/50\" title=\"Reset layout\">\r\n                    <RotateCcw className=\"w-4 h-4\" />\r\n                </Button>\r\n            </div>\r\n\r\n            {/* Legend */}\r\n            <div className=\"absolute top-3 right-3 z-10 bg-[#1A2028]/90 backdrop-blur-md rounded-lg border border-dark-border p-3 shadow-sm\">\r\n                <div className=\"text-[10px] text-dark-text-muted uppercase tracking-wide mb-2\">Node Types</div>\r\n                <div className=\"flex flex-wrap gap-3 text-xs mb-3\">\r\n                    {Object.entries(NODE_COLORS).slice(0, 4).map(([key, colors]) => (\r\n                        <div key={key} className=\"flex items-center gap-1.5\">\r\n                            <div className=\"w-3 h-3 rounded\" style={{ backgroundColor: colors.bg }} />\r\n                            <span className=\"text-dark-text-muted capitalize\">{key === 'related' ? 'Topic' : key}</span>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n                <div className=\"text-[10px] text-dark-text-muted uppercase tracking-wide mb-2\">Edge Types</div>\r\n                <div className=\"flex flex-col gap-1.5 text-xs\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"w-5 h-0.5 bg-dark-text-muted\" />\r\n                        <span className=\"text-dark-text-muted\">Solid = Derived (Fork)</span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"w-5 h-0 border-t-2 border-dashed border-dark-text-muted\" />\r\n                        <span className=\"text-dark-text-muted\">Dashed = Citation</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Purpose Hint */}\r\n            <div className=\"absolute bottom-16 left-1/2 -translate-x-1/2 z-10 text-xs text-dark-text-muted/70 text-center\">\r\n                Explore how this work connects, diverges, or is contested\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport function KnowledgeGraph({ centerPostId }: KnowledgeGraphProps) {\r\n    const [nodes, setNodes] = useState<GraphNode[]>([])\r\n    const [edges, setEdges] = useState<GraphEdge[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [expanded, setExpanded] = useState(false)\r\n    const [hoveredNode, setHoveredNode] = useState<GraphNode | null>(null)\r\n    const [tooltipPos, setTooltipPos] = useState({ x: 0, y: 0 })\r\n\r\n    const containerRef = useRef<HTMLDivElement>(null)\r\n    const canvasRef = useRef<HTMLCanvasElement>(null)\r\n    const dialogCanvasRef = useRef<HTMLCanvasElement>(null)\r\n\r\n    const supabase = useMemo(() => createClient(), [])\r\n    const { resolvedTheme } = useTheme()\r\n    const isDark = resolvedTheme === 'dark'\r\n\r\n    // Node positions (will be calculated once and stored)\r\n    const [nodePositions, setNodePositions] = useState<Map<string, { x: number, y: number }>>(new Map())\r\n    const [dialogPositions, setDialogPositions] = useState<Map<string, { x: number, y: number }>>(new Map())\r\n    const [draggedNode, setDraggedNode] = useState<string | null>(null)\r\n    const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 })\r\n    const [zoomLevel, setZoomLevel] = useState(0.85) // Start slightly zoomed out\r\n    const [dialogZoomLevel, setDialogZoomLevel] = useState(0.85)\r\n    const hasDragged = useRef(false) // Track if actual dragging occurred\r\n    const dialogContainerRef = useRef<HTMLDivElement>(null)\r\n\r\n    // Fetch graph data\r\n    const fetchGraphData = useCallback(async () => {\r\n        try {\r\n            const { data: centerPost } = await supabase\r\n                .from('posts')\r\n                .select('id, title, forked_from_id, tags, author_id, users:author_id(name)')\r\n                .eq('id', centerPostId)\r\n                .single()\r\n\r\n            if (!centerPost) return\r\n\r\n            const newNodes: GraphNode[] = []\r\n            const newEdges: GraphEdge[] = []\r\n            const nodeIds = new Set<string>()\r\n\r\n            const addNode = (post: any, group: GraphNode['group']) => {\r\n                if (nodeIds.has(post.id)) return\r\n                nodeIds.add(post.id)\r\n                newNodes.push({\r\n                    id: post.id,\r\n                    title: post.title || 'Untitled',\r\n                    group,\r\n                    tag: post.tags?.[0] || 'Research',\r\n                    authorName: post.users?.name || 'Unknown'\r\n                })\r\n            }\r\n\r\n            // Center node\r\n            addNode({ ...centerPost, users: (centerPost as any).users }, 'center')\r\n\r\n            // Parent fork\r\n            if (centerPost.forked_from_id) {\r\n                const { data: parent } = await supabase\r\n                    .from('posts')\r\n                    .select('id, title, tags, author_id, users:author_id(name)')\r\n                    .eq('id', centerPost.forked_from_id)\r\n                    .single()\r\n                if (parent) {\r\n                    addNode(parent, 'fork')\r\n                    newEdges.push({ source: parent.id, target: centerPost.id, type: 'fork' })\r\n                }\r\n            }\r\n\r\n            // Child forks\r\n            const { data: forks } = await supabase\r\n                .from('posts')\r\n                .select('id, title, tags, author_id, users:author_id(name)')\r\n                .eq('forked_from_id', centerPostId)\r\n                .eq('status', 'published')\r\n                .limit(4)\r\n\r\n            forks?.forEach(fork => {\r\n                addNode(fork, 'fork')\r\n                newEdges.push({ source: centerPost.id, target: fork.id, type: 'fork' })\r\n            })\r\n\r\n            // Citations\r\n            const { data: citations } = await supabase\r\n                .from('citations')\r\n                .select('source_post_id, posts!citations_source_post_id_fkey(id, title, tags, author_id, users:author_id(name))')\r\n                .eq('target_post_id', centerPostId)\r\n                .limit(4)\r\n\r\n            citations?.forEach((citation: any) => {\r\n                if (citation.posts) {\r\n                    addNode(citation.posts, 'citation')\r\n                    newEdges.push({ source: citation.posts.id, target: centerPost.id, type: 'citation' })\r\n                }\r\n            })\r\n\r\n            // Related by tag\r\n            const primaryTag = centerPost.tags?.[0]\r\n            if (primaryTag) {\r\n                const { data: shared } = await supabase\r\n                    .from('posts')\r\n                    .select('id, title, tags, author_id, users:author_id(name)')\r\n                    .contains('tags', [primaryTag])\r\n                    .neq('id', centerPostId)\r\n                    .eq('status', 'published')\r\n                    .limit(3)\r\n\r\n                shared?.forEach(post => {\r\n                    if (!nodeIds.has(post.id)) {\r\n                        addNode(post, 'related')\r\n                        newEdges.push({ source: centerPost.id, target: post.id, type: 'shared_tag' })\r\n                    }\r\n                })\r\n            }\r\n\r\n            // Same author\r\n            if (centerPost.author_id) {\r\n                const { data: authorPosts } = await supabase\r\n                    .from('posts')\r\n                    .select('id, title, tags, author_id, users:author_id(name)')\r\n                    .eq('author_id', centerPost.author_id)\r\n                    .neq('id', centerPostId)\r\n                    .eq('status', 'published')\r\n                    .limit(3)\r\n\r\n                authorPosts?.forEach(post => {\r\n                    if (!nodeIds.has(post.id)) {\r\n                        addNode(post, 'author')\r\n                        newEdges.push({ source: centerPost.id, target: post.id, type: 'shared_author' })\r\n                    }\r\n                })\r\n            }\r\n\r\n            setNodes(newNodes)\r\n            setEdges(newEdges)\r\n        } catch (err) {\r\n            console.error('Error fetching graph data:', err)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }, [centerPostId, supabase])\r\n\r\n    useEffect(() => { fetchGraphData() }, [fetchGraphData])\r\n\r\n    // Calculate initial positions in a clean layout\r\n    const calculatePositions = useCallback((width: number, height: number) => {\r\n        const positions = new Map<string, { x: number, y: number }>()\r\n        const centerX = width / 2\r\n        const centerY = height / 2\r\n\r\n        // Group nodes by type\r\n        const centerNode = nodes.find(n => n.group === 'center')\r\n        const forkNodes = nodes.filter(n => n.group === 'fork')\r\n        const citationNodes = nodes.filter(n => n.group === 'citation')\r\n        const relatedNodes = nodes.filter(n => n.group === 'related')\r\n        const authorNodes = nodes.filter(n => n.group === 'author')\r\n\r\n        // Center node\r\n        if (centerNode) {\r\n            positions.set(centerNode.id, { x: centerX, y: centerY })\r\n        }\r\n\r\n        // Arrange other nodes in concentric arcs\r\n        const arrangeInArc = (nodeList: GraphNode[], radius: number, startAngle: number, sweep: number) => {\r\n            const count = nodeList.length\r\n            if (count === 0) return\r\n            const angleStep = sweep / Math.max(count - 1, 1)\r\n            nodeList.forEach((node, i) => {\r\n                const angle = startAngle + (count === 1 ? sweep / 2 : i * angleStep)\r\n                positions.set(node.id, {\r\n                    x: centerX + Math.cos(angle) * radius,\r\n                    y: centerY + Math.sin(angle) * radius\r\n                })\r\n            })\r\n        }\r\n\r\n        // Distribute by type in different directions - even wider spacing\r\n        const radius1 = Math.min(width, height) * 0.42\r\n        const radius2 = Math.min(width, height) * 0.48\r\n\r\n        arrangeInArc(forkNodes, radius1, -Math.PI * 0.85, Math.PI * 0.6)     // Top-left arc (wider sweep)\r\n        arrangeInArc(citationNodes, radius1, Math.PI * 0.15, Math.PI * 0.6)  // Bottom-right arc\r\n        arrangeInArc(relatedNodes, radius2, -Math.PI * 0.1, Math.PI * 0.25)  // Right side\r\n        arrangeInArc(authorNodes, radius2, Math.PI * 0.9, Math.PI * 0.25)    // Left side\r\n\r\n        return positions\r\n    }, [nodes])\r\n\r\n    // Initialize positions when nodes change\r\n    useEffect(() => {\r\n        if (nodes.length > 0 && containerRef.current) {\r\n            const rect = containerRef.current.getBoundingClientRect()\r\n            const positions = calculatePositions(rect.width, rect.height)\r\n            setNodePositions(positions)\r\n        }\r\n    }, [nodes, calculatePositions])\r\n\r\n    // Draw the graph on canvas\r\n    const drawGraph = useCallback((canvas: HTMLCanvasElement | null, width: number, height: number) => {\r\n        if (!canvas || nodePositions.size === 0) return\r\n\r\n        const ctx = canvas.getContext('2d')\r\n        if (!ctx) return\r\n\r\n        // Set canvas size with device pixel ratio for sharp rendering\r\n        const dpr = window.devicePixelRatio || 1\r\n        canvas.width = width * dpr\r\n        canvas.height = height * dpr\r\n        canvas.style.width = `${width}px`\r\n        canvas.style.height = `${height}px`\r\n        ctx.scale(dpr, dpr)\r\n\r\n        // Clear - always use dark background\r\n        ctx.fillStyle = THEME_COLORS.darkBg\r\n        ctx.fillRect(0, 0, width, height)\r\n\r\n        // Apply zoom transform\r\n        ctx.save()\r\n        const centerX = width / 2\r\n        const centerY = height / 2\r\n        ctx.translate(centerX, centerY)\r\n        ctx.scale(zoomLevel, zoomLevel)\r\n        ctx.translate(-centerX, -centerY)\r\n\r\n        // Draw edges first (behind nodes) with semantic styling\r\n        edges.forEach(edge => {\r\n            const sourcePos = nodePositions.get(edge.source)\r\n            const targetPos = nodePositions.get(edge.target)\r\n            if (!sourcePos || !targetPos) return\r\n\r\n            // Calculate control points for bezier curve\r\n            const midX = (sourcePos.x + targetPos.x) / 2\r\n            const midY = (sourcePos.y + targetPos.y) / 2\r\n            const dx = targetPos.x - sourcePos.x\r\n            const dy = targetPos.y - sourcePos.y\r\n            const dist = Math.sqrt(dx * dx + dy * dy)\r\n\r\n            // Perpendicular offset for curve\r\n            const curvature = dist * 0.15\r\n            const perpX = -dy / dist * curvature\r\n            const perpY = dx / dist * curvature\r\n\r\n            // Solid for forks (derived work), dashed for citations\r\n            if (edge.type === 'citation' || edge.type === 'shared_tag') {\r\n                ctx.setLineDash([5, 3])\r\n            } else {\r\n                ctx.setLineDash([])\r\n            }\r\n\r\n            ctx.beginPath()\r\n            ctx.moveTo(sourcePos.x, sourcePos.y)\r\n            ctx.quadraticCurveTo(midX + perpX, midY + perpY, targetPos.x, targetPos.y)\r\n\r\n            // Edge color based on type\r\n            const edgeColor = edge.type === 'citation' ? THEME_COLORS.citation :\r\n                edge.type === 'fork' ? THEME_COLORS.accent :\r\n                    edge.type === 'shared_author' ? '#6366F1' :\r\n                        THEME_COLORS.secondary\r\n\r\n            ctx.lineWidth = 2\r\n            ctx.strokeStyle = `${edgeColor}60`\r\n            ctx.stroke()\r\n\r\n            // Reset line dash\r\n            ctx.setLineDash([])\r\n        })\r\n\r\n        // Draw nodes\r\n        nodes.forEach(node => {\r\n            const pos = nodePositions.get(node.id)\r\n            if (!pos) return\r\n\r\n            const colors = NODE_COLORS[node.group]\r\n            const isCenter = node.group === 'center'\r\n            const isHovered = hoveredNode?.id === node.id\r\n\r\n            // Node dimensions - narrower nodes\r\n            const nodeWidth = isCenter ? 110 : 90\r\n            const nodeHeight = isCenter ? 44 : 36\r\n            const radius = 6\r\n\r\n            // Shadow\r\n            if (isHovered || isCenter) {\r\n                ctx.shadowColor = `${colors.bg}40`\r\n                ctx.shadowBlur = 15\r\n                ctx.shadowOffsetY = 4\r\n            }\r\n\r\n            // Draw rounded rectangle\r\n            ctx.beginPath()\r\n            ctx.roundRect(pos.x - nodeWidth / 2, pos.y - nodeHeight / 2, nodeWidth, nodeHeight, radius)\r\n            ctx.fillStyle = colors.bg\r\n            ctx.fill()\r\n            ctx.strokeStyle = colors.border\r\n            ctx.lineWidth = isHovered ? 3 : 2\r\n            ctx.stroke()\r\n\r\n            // Reset shadow\r\n            ctx.shadowColor = 'transparent'\r\n            ctx.shadowBlur = 0\r\n            ctx.shadowOffsetY = 0\r\n\r\n            // Title text\r\n            ctx.fillStyle = colors.text\r\n            ctx.font = `${isCenter ? '600' : '500'} ${isCenter ? 12 : 11}px Inter, system-ui, sans-serif`\r\n            ctx.textAlign = 'center'\r\n            ctx.textBaseline = 'middle'\r\n\r\n            const title = node.title.length > 12 ? node.title.substring(0, 11) + 'ΓÇª' : node.title\r\n            ctx.fillText(title, pos.x, pos.y - (isCenter ? 5 : 3))\r\n\r\n            // Tag badge\r\n            ctx.font = '500 9px Inter, system-ui, sans-serif'\r\n            ctx.fillStyle = `${colors.text}99`\r\n            const tag = node.tag.length > 12 ? node.tag.substring(0, 11) + 'ΓÇª' : node.tag\r\n            ctx.fillText(tag, pos.x, pos.y + (isCenter ? 10 : 8))\r\n        })\r\n\r\n        // Restore context after zoom transform\r\n        ctx.restore()\r\n\r\n    }, [nodes, edges, nodePositions, hoveredNode, zoomLevel])\r\n\r\n    // Redraw on position or zoom changes\r\n    useEffect(() => {\r\n        if (canvasRef.current && containerRef.current) {\r\n            const rect = containerRef.current.getBoundingClientRect()\r\n            drawGraph(canvasRef.current, rect.width, rect.height)\r\n        }\r\n    }, [nodePositions, drawGraph, hoveredNode, zoomLevel])\r\n\r\n    // Handle mouse events for dragging and hovering\r\n    const getNodeAtPosition = useCallback((x: number, y: number): GraphNode | null => {\r\n        for (const node of nodes) {\r\n            const pos = nodePositions.get(node.id)\r\n            if (!pos) continue\r\n            const isCenter = node.group === 'center'\r\n            const nodeWidth = isCenter ? 110 : 90\r\n            const nodeHeight = isCenter ? 44 : 36\r\n\r\n            if (x >= pos.x - nodeWidth / 2 && x <= pos.x + nodeWidth / 2 &&\r\n                y >= pos.y - nodeHeight / 2 && y <= pos.y + nodeHeight / 2) {\r\n                return node\r\n            }\r\n        }\r\n        return null\r\n    }, [nodes, nodePositions])\r\n\r\n    const handleMouseDown = useCallback((e: React.MouseEvent<HTMLCanvasElement>) => {\r\n        const rect = e.currentTarget.getBoundingClientRect()\r\n        const x = e.clientX - rect.left\r\n        const y = e.clientY - rect.top\r\n        const node = getNodeAtPosition(x, y)\r\n\r\n        hasDragged.current = false // Reset on mousedown\r\n\r\n        if (node) {\r\n            const pos = nodePositions.get(node.id)\r\n            if (pos) {\r\n                setDraggedNode(node.id)\r\n                setDragOffset({ x: x - pos.x, y: y - pos.y })\r\n            }\r\n        }\r\n    }, [getNodeAtPosition, nodePositions])\r\n\r\n    const handleMouseMove = useCallback((e: React.MouseEvent<HTMLCanvasElement>) => {\r\n        const rect = e.currentTarget.getBoundingClientRect()\r\n        const x = e.clientX - rect.left\r\n        const y = e.clientY - rect.top\r\n\r\n        if (draggedNode) {\r\n            hasDragged.current = true // Mark that we actually dragged\r\n\r\n            // Bounded dragging - keep nodes within container\r\n            const padding = 70\r\n            const newX = Math.max(padding, Math.min(rect.width - padding, x - dragOffset.x))\r\n            const newY = Math.max(padding, Math.min(rect.height - padding, y - dragOffset.y))\r\n\r\n            setNodePositions(prev => {\r\n                const next = new Map(prev)\r\n                next.set(draggedNode, { x: newX, y: newY })\r\n                return next\r\n            })\r\n        } else {\r\n            // Hover detection\r\n            const node = getNodeAtPosition(x, y)\r\n            setHoveredNode(node)\r\n            setTooltipPos({ x: e.clientX, y: e.clientY })\r\n\r\n            // Change cursor\r\n            e.currentTarget.style.cursor = node ? 'pointer' : 'default'\r\n        }\r\n    }, [draggedNode, dragOffset, getNodeAtPosition])\r\n\r\n    const handleMouseUp = useCallback(() => {\r\n        setDraggedNode(null)\r\n    }, [])\r\n\r\n    const handleClick = useCallback((e: React.MouseEvent<HTMLCanvasElement>) => {\r\n        // Don't navigate if we actually dragged\r\n        if (hasDragged.current) {\r\n            hasDragged.current = false\r\n            return\r\n        }\r\n\r\n        const rect = e.currentTarget.getBoundingClientRect()\r\n        const x = e.clientX - rect.left\r\n        const y = e.clientY - rect.top\r\n        const node = getNodeAtPosition(x, y)\r\n\r\n        if (node && node.group !== 'center') {\r\n            window.location.href = `/post/${node.id}`\r\n        }\r\n    }, [getNodeAtPosition])\r\n\r\n    const resetLayout = useCallback(() => {\r\n        if (containerRef.current) {\r\n            const rect = containerRef.current.getBoundingClientRect()\r\n            const positions = calculatePositions(rect.width, rect.height)\r\n            setNodePositions(positions)\r\n        }\r\n        setZoomLevel(0.85)\r\n    }, [calculatePositions])\r\n\r\n    const zoomIn = useCallback(() => {\r\n        setZoomLevel(prev => Math.min(prev * 1.2, 2))\r\n    }, [])\r\n\r\n    const zoomOut = useCallback(() => {\r\n        setZoomLevel(prev => Math.max(prev / 1.2, 0.4))\r\n    }, [])\r\n\r\n    // Handle resize\r\n    useEffect(() => {\r\n        const handleResize = () => {\r\n            if (containerRef.current && canvasRef.current) {\r\n                const rect = containerRef.current.getBoundingClientRect()\r\n                drawGraph(canvasRef.current, rect.width, rect.height)\r\n            }\r\n        }\r\n\r\n        const observer = new ResizeObserver(handleResize)\r\n        if (containerRef.current) {\r\n            observer.observe(containerRef.current)\r\n        }\r\n\r\n        return () => observer.disconnect()\r\n    }, [drawGraph])\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"relative border border-dark-border rounded-xl overflow-hidden bg-[#0F1419] h-[400px] w-full flex items-center justify-center\">\r\n                <Loader2 className=\"w-8 h-8 animate-spin text-secondary\" />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    if (nodes.length <= 1) {\r\n        return (\r\n            <div className=\"relative border border-dark-border rounded-xl overflow-hidden bg-[#0F1419] h-[200px] w-full flex items-center justify-center\">\r\n                <p className=\"text-dark-text-muted text-sm\">No connections found for this post</p>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div\r\n                ref={containerRef}\r\n                className=\"relative border border-dark-border rounded-xl overflow-hidden bg-[#0F1419] h-[400px] w-full\"\r\n            >\r\n                <canvas\r\n                    ref={canvasRef}\r\n                    className=\"absolute inset-0\"\r\n                    onMouseDown={handleMouseDown}\r\n                    onMouseMove={handleMouseMove}\r\n                    onMouseUp={handleMouseUp}\r\n                    onMouseLeave={handleMouseUp}\r\n                    onClick={handleClick}\r\n                />\r\n\r\n                {/* Controls */}\r\n                <div className=\"absolute bottom-4 left-1/2 -translate-x-1/2 z-10 flex items-center gap-1 bg-[#1A2028]/95 backdrop-blur-md rounded-full border border-dark-border p-1.5 shadow-lg\">\r\n                    <Button variant=\"ghost\" size=\"icon\" onClick={zoomIn} className=\"h-8 w-8 rounded-full text-dark-text-muted hover:text-dark-text hover:bg-dark-border/50\" title=\"Zoom in\">\r\n                        <ZoomIn className=\"w-4 h-4\" />\r\n                    </Button>\r\n                    <Button variant=\"ghost\" size=\"icon\" onClick={zoomOut} className=\"h-8 w-8 rounded-full text-dark-text-muted hover:text-dark-text hover:bg-dark-border/50\" title=\"Zoom out\">\r\n                        <ZoomOut className=\"w-4 h-4\" />\r\n                    </Button>\r\n                    <div className=\"h-4 w-px bg-dark-border mx-1\" />\r\n                    <Button variant=\"ghost\" size=\"icon\" onClick={resetLayout} className=\"h-8 w-8 rounded-full text-dark-text-muted hover:text-dark-text hover:bg-dark-border/50\" title=\"Reset layout\">\r\n                        <RotateCcw className=\"w-4 h-4\" />\r\n                    </Button>\r\n                    <div className=\"h-4 w-px bg-dark-border mx-1\" />\r\n                    <Button variant=\"ghost\" size=\"icon\" onClick={() => setExpanded(true)} className=\"h-8 w-8 rounded-full text-dark-text-muted hover:text-dark-text hover:bg-dark-border/50\" title=\"Expand\">\r\n                        <Maximize2 className=\"w-4 h-4\" />\r\n                    </Button>\r\n                </div>\r\n\r\n                {/* Legend */}\r\n                <div className=\"absolute top-3 right-3 z-10 bg-[#1A2028]/90 backdrop-blur-md rounded-lg border border-dark-border p-2 shadow-sm\">\r\n                    <div className=\"flex flex-wrap gap-2 text-[10px]\">\r\n                        {Object.entries(NODE_COLORS).slice(0, 4).map(([key, colors]) => (\r\n                            <div key={key} className=\"flex items-center gap-1\">\r\n                                <div className=\"w-2.5 h-2.5 rounded\" style={{ backgroundColor: colors.bg }} />\r\n                                <span className=\"text-dark-text-muted capitalize\">\r\n                                    {key === 'related' ? 'Topic' : key}\r\n                                </span>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Tooltip */}\r\n                {hoveredNode && hoveredNode.group !== 'center' && (\r\n                    <div\r\n                        className=\"fixed z-50 pointer-events-none\"\r\n                        style={{ left: tooltipPos.x + 10, top: tooltipPos.y + 10 }}\r\n                    >\r\n                        <div className=\"bg-white dark:bg-dark-surface border border-gray-200 dark:border-dark-border rounded-lg shadow-xl p-3 min-w-[180px]\">\r\n                            <div className=\"text-xs font-medium text-text-muted dark:text-dark-text-muted mb-1\">\r\n                                {RELATION_LABELS[edges.find(e => e.source === hoveredNode.id || e.target === hoveredNode.id)?.type || 'shared_tag']}\r\n                            </div>\r\n                            <div className=\"font-semibold text-sm text-text dark:text-dark-text\">\r\n                                {hoveredNode.title}\r\n                            </div>\r\n                            {hoveredNode.authorName && (\r\n                                <div className=\"text-xs text-text-light dark:text-dark-text-muted mt-1\">\r\n                                    by {hoveredNode.authorName}\r\n                                </div>\r\n                            )}\r\n                            <div className=\"text-xs text-secondary dark:text-secondary-light mt-1\">\r\n                                Click to view ΓåÆ\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Expanded Dialog */}\r\n            <Dialog open={expanded} onOpenChange={setExpanded}>\r\n                <DialogContent className=\"max-w-[95vw] w-[95vw] h-[90vh] flex flex-col p-0 gap-0 bg-[#0F1419] overflow-hidden\">\r\n                    <DialogHeader className=\"p-4 border-b border-dark-border flex-shrink-0\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <DialogTitle className=\"text-dark-text\">Knowledge Graph Explorer</DialogTitle>\r\n                        </div>\r\n                    </DialogHeader>\r\n                    <div className=\"flex-1 relative overflow-hidden bg-[#0F1419]\">\r\n                        <DialogGraphCanvas\r\n                            nodes={nodes}\r\n                            edges={edges}\r\n                            calculatePositions={calculatePositions}\r\n                            expanded={expanded}\r\n                        />\r\n                    </div>\r\n                </DialogContent>\r\n            </Dialog>\r\n        </>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\LanguageSwitcher.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\LanguageSwitcher.tsx:23:9\n  21 |\n  22 |     useEffect(() => {\n> 23 |         setMounted(true);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  24 |     }, []);\n  25 |\n  26 |     const handleLocaleChange = (newLocale: string) => {","line":23,"column":9,"nodeType":null,"endLine":23,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useLocale, useTranslations } from 'next-intl';\r\nimport { usePathname, useRouter } from '@/navigation';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Globe } from 'lucide-react';\r\nimport {\r\n    DropdownMenu,\r\n    DropdownMenuContent,\r\n    DropdownMenuItem,\r\n    DropdownMenuTrigger,\r\n} from '@/components/ui/dropdown-menu';\r\n\r\nexport function LanguageSwitcher() {\r\n    const t = useTranslations('Common');\r\n    const locale = useLocale();\r\n    const router = useRouter();\r\n    const pathname = usePathname();\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n    }, []);\r\n\r\n    const handleLocaleChange = (newLocale: string) => {\r\n        router.replace(pathname, { locale: newLocale });\r\n    };\r\n\r\n    // Prevent hydration mismatch by not rendering dropdown until client-side\r\n    if (!mounted) {\r\n        return (\r\n            <Button variant=\"ghost\" size=\"icon\" aria-label={t('languageSwitcher')}>\r\n                <Globe className=\"h-5 w-5\" />\r\n            </Button>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <DropdownMenu>\r\n            <DropdownMenuTrigger asChild>\r\n                <Button variant=\"ghost\" size=\"icon\" aria-label={t('languageSwitcher')}>\r\n                    <Globe className=\"h-5 w-5\" />\r\n                </Button>\r\n            </DropdownMenuTrigger>\r\n            <DropdownMenuContent align=\"end\">\r\n                <DropdownMenuItem onClick={() => handleLocaleChange('en')} disabled={locale === 'en'}>\r\n                    {t('english')}\r\n                </DropdownMenuItem>\r\n                <DropdownMenuItem onClick={() => handleLocaleChange('ar')} disabled={locale === 'ar'}>\r\n                    {t('arabic')}\r\n                </DropdownMenuItem>\r\n            </DropdownMenuContent>\r\n        </DropdownMenu>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\LinkedResourcesSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\MagazineCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ModerationTriage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchReports'. Either include it or remove the dependency array.","line":105,"column":8,"nodeType":"ArrayExpression","endLine":105,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchReports]","fix":{"range":[3471,3473],"text":"[fetchReports]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'severityConfig'. Either include it or remove the dependency array.","line":159,"column":8,"nodeType":"ArrayExpression","endLine":159,"endColumn":41,"suggestions":[{"desc":"Update the dependencies array to be: [reports, filterSeverity, sortBy, severityConfig]","fix":{"range":[5289,5322],"text":"[reports, filterSeverity, sortBy, severityConfig]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect, useMemo } from 'react'\r\nimport Link from 'next/link'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport {\r\n    AlertTriangle,\r\n    Clock,\r\n    CheckCircle2,\r\n    XCircle,\r\n    Filter,\r\n    ArrowUpDown,\r\n    Eye,\r\n    MessageSquare,\r\n    Flag,\r\n    ChevronDown,\r\n    ExternalLink\r\n} from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { formatDistanceToNow } from 'date-fns'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ntype Severity = 'low' | 'medium' | 'critical'\r\ntype SortOption = 'severity' | 'time' | 'type'\r\n\r\ninterface Report {\r\n    id: string\r\n    post_id: string\r\n    reason: string\r\n    details: string | null\r\n    status: 'pending' | 'reviewing' | 'resolved' | 'dismissed'\r\n    severity?: Severity\r\n    confidence_score?: number\r\n    created_at: string\r\n    reporter_id: string\r\n    post?: {\r\n        id: string\r\n        title: string\r\n        author_id: string\r\n    }\r\n    reporter?: {\r\n        name: string\r\n        email: string\r\n    }\r\n}\r\n\r\ninterface ModerationTriageProps {\r\n    onReportAction?: (reportId: string, action: 'resolve' | 'dismiss') => void\r\n}\r\n\r\n/**\r\n * Calculate severity based on report reason and optional AI confidence score\r\n */\r\nfunction calculateSeverity(reason: string, confidenceScore?: number): Severity {\r\n    const criticalReasons = ['hate_speech', 'harassment', 'violence', 'illegal_content', 'spam']\r\n    const mediumReasons = ['misinformation', 'plagiarism', 'inappropriate', 'off_topic']\r\n\r\n    // If we have AI confidence score, use thresholds\r\n    if (confidenceScore !== undefined) {\r\n        if (confidenceScore >= 0.7) return 'critical'\r\n        if (confidenceScore >= 0.4) return 'medium'\r\n        return 'low'\r\n    }\r\n\r\n    // Fallback to reason-based categorization\r\n    if (criticalReasons.includes(reason)) return 'critical'\r\n    if (mediumReasons.includes(reason)) return 'medium'\r\n    return 'low'\r\n}\r\n\r\nexport function ModerationTriage({ onReportAction }: ModerationTriageProps) {\r\n    const t = useTranslations('ModerationTriage')\r\n    const tCommon = useTranslations('Common')\r\n    const [reports, setReports] = useState<Report[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [sortBy, setSortBy] = useState<SortOption>('severity')\r\n    const [filterSeverity, setFilterSeverity] = useState<Severity | 'all'>('all')\r\n    const [selectedReports, setSelectedReports] = useState<Set<string>>(new Set())\r\n    const [processing, setProcessing] = useState(false)\r\n    const supabase = useMemo(() => createClient(), [])\r\n\r\n    const severityConfig = {\r\n        critical: {\r\n            label: t('severity.critical'),\r\n            color: 'bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 border-red-200 dark:border-red-800',\r\n            dotColor: 'bg-red-500',\r\n            sortOrder: 0\r\n        },\r\n        medium: {\r\n            label: t('severity.medium'),\r\n            color: 'bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-amber-300 border-yellow-200 dark:border-yellow-800',\r\n            dotColor: 'bg-yellow-500',\r\n            sortOrder: 1\r\n        },\r\n        low: {\r\n            label: t('severity.low'),\r\n            color: 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-emerald-300 border-green-200 dark:border-green-800',\r\n            dotColor: 'bg-green-500',\r\n            sortOrder: 2\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        fetchReports()\r\n    }, [])\r\n\r\n    async function fetchReports() {\r\n        setLoading(true)\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('reports')\r\n                .select(`\r\n          *,\r\n          post:posts(id, title, author_id),\r\n          reporter:users!reports_reporter_id_fkey(name, email)\r\n        `)\r\n                .in('status', ['pending', 'reviewing'])\r\n                .order('created_at', { ascending: false })\r\n\r\n            if (error) throw error\r\n\r\n            // Enrich reports with calculated severity\r\n            const enrichedReports = (data || []).map(report => ({\r\n                ...report,\r\n                severity: calculateSeverity(report.reason, report.confidence_score)\r\n            }))\r\n\r\n            setReports(enrichedReports)\r\n        } catch (error) {\r\n            console.error('Error fetching reports:', error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    // Sort and filter reports\r\n    const processedReports = useMemo(() => {\r\n        let filtered = reports\r\n\r\n        // Apply severity filter\r\n        if (filterSeverity !== 'all') {\r\n            filtered = filtered.filter(r => r.severity === filterSeverity)\r\n        }\r\n\r\n        // Apply sorting\r\n        return [...filtered].sort((a, b) => {\r\n            switch (sortBy) {\r\n                case 'severity':\r\n                    return (severityConfig[a.severity || 'low'].sortOrder) -\r\n                        (severityConfig[b.severity || 'low'].sortOrder)\r\n                case 'time':\r\n                    return new Date(b.created_at).getTime() - new Date(a.created_at).getTime()\r\n                case 'type':\r\n                    return a.reason.localeCompare(b.reason)\r\n                default:\r\n                    return 0\r\n            }\r\n        })\r\n    }, [reports, sortBy, filterSeverity])\r\n\r\n    // Severity counts\r\n    const severityCounts = useMemo(() => ({\r\n        critical: reports.filter(r => r.severity === 'critical').length,\r\n        medium: reports.filter(r => r.severity === 'medium').length,\r\n        low: reports.filter(r => r.severity === 'low').length\r\n    }), [reports])\r\n\r\n    async function handleAction(reportId: string, action: 'resolve' | 'dismiss') {\r\n        try {\r\n            const newStatus = action === 'resolve' ? 'resolved' : 'dismissed'\r\n\r\n            const { error } = await supabase\r\n                .from('reports')\r\n                .update({ status: newStatus })\r\n                .eq('id', reportId)\r\n\r\n            if (error) throw error\r\n\r\n            setReports(prev => prev.filter(r => r.id !== reportId))\r\n            selectedReports.delete(reportId)\r\n            setSelectedReports(new Set(selectedReports))\r\n\r\n            onReportAction?.(reportId, action)\r\n        } catch (error) {\r\n            console.error('Error updating report:', error)\r\n        }\r\n    }\r\n\r\n    async function handleBulkAction(action: 'resolve' | 'dismiss') {\r\n        if (selectedReports.size === 0) return\r\n        setProcessing(true)\r\n\r\n        try {\r\n            const newStatus = action === 'resolve' ? 'resolved' : 'dismissed'\r\n\r\n            const { error } = await supabase\r\n                .from('reports')\r\n                .update({ status: newStatus })\r\n                .in('id', Array.from(selectedReports))\r\n\r\n            if (error) throw error\r\n\r\n            setReports(prev => prev.filter(r => !selectedReports.has(r.id)))\r\n            setSelectedReports(new Set())\r\n        } catch (error) {\r\n            console.error('Error bulk updating reports:', error)\r\n        } finally {\r\n            setProcessing(false)\r\n        }\r\n    }\r\n\r\n    function toggleSelect(reportId: string) {\r\n        const newSelected = new Set(selectedReports)\r\n        if (newSelected.has(reportId)) {\r\n            newSelected.delete(reportId)\r\n        } else {\r\n            newSelected.add(reportId)\r\n        }\r\n        setSelectedReports(newSelected)\r\n    }\r\n\r\n    function selectAll() {\r\n        if (selectedReports.size === processedReports.length) {\r\n            setSelectedReports(new Set())\r\n        } else {\r\n            setSelectedReports(new Set(processedReports.map(r => r.id)))\r\n        }\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"space-y-4\">\r\n                {[1, 2, 3].map(i => (\r\n                    <div key={i} className=\"h-24 rounded-xl bg-gray-100 dark:bg-dark-surface animate-pulse\" />\r\n                ))}\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Severity Summary */}\r\n            <div className=\"grid grid-cols-3 gap-4\">\r\n                {(['critical', 'medium', 'low'] as Severity[]).map(severity => (\r\n                    <button\r\n                        key={severity}\r\n                        onClick={() => setFilterSeverity(filterSeverity === severity ? 'all' : severity)}\r\n                        className={`p-4 rounded-xl border transition-all ${filterSeverity === severity\r\n                            ? severityConfig[severity].color + ' ring-2 ring-offset-2 dark:ring-offset-dark-bg ring-current'\r\n                            : 'bg-white dark:bg-dark-surface border-gray-200 dark:border-dark-border hover:border-gray-300 text-text dark:text-gray-400'\r\n                            }`}\r\n                    >\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <span className=\"text-2xl font-bold\">{severityCounts[severity]}</span>\r\n                            <div className={`w-3 h-3 rounded-full ${severityConfig[severity].dotColor}`} />\r\n                        </div>\r\n                        <span className=\"text-sm font-medium mt-1 block text-text-light dark:text-gray-300\">{severityConfig[severity].label}</span>\r\n                    </button>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Controls */}\r\n            <div className=\"flex items-center justify-between gap-4\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <div className=\"relative\">\r\n                        <select\r\n                            value={sortBy}\r\n                            onChange={(e) => setSortBy(e.target.value as SortOption)}\r\n                            className=\"appearance-none pl-3 pr-8 py-2 rounded-lg border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-surface text-sm text-text dark:text-gray-300 focus:outline-none focus:ring-2 focus:ring-primary\"\r\n                        >\r\n                            <option value=\"severity\">{t('sortBy.severity')}</option>\r\n                            <option value=\"time\">{t('sortBy.time')}</option>\r\n                            <option value=\"type\">{t('sortBy.type')}</option>\r\n                        </select>\r\n                        <ArrowUpDown className=\"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-text-light pointer-events-none\" />\r\n                    </div>\r\n\r\n                    {selectedReports.size > 0 && (\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Button\r\n                                size=\"sm\"\r\n                                variant=\"outline\"\r\n                                onClick={() => handleBulkAction('resolve')}\r\n                                disabled={processing}\r\n                                className=\"gap-1\"\r\n                            >\r\n                                <CheckCircle2 className=\"w-4 h-4\" />\r\n                                {t('actions.resolve')} ({selectedReports.size})\r\n                            </Button>\r\n                            <Button\r\n                                size=\"sm\"\r\n                                variant=\"outline\"\r\n                                onClick={() => handleBulkAction('dismiss')}\r\n                                disabled={processing}\r\n                                className=\"gap-1\"\r\n                            >\r\n                                <XCircle className=\"w-4 h-4\" />\r\n                                {t('actions.dismiss')} ({selectedReports.size})\r\n                            </Button>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <button\r\n                    onClick={selectAll}\r\n                    className=\"text-sm text-text-light dark:text-gray-400 hover:text-primary dark:hover:text-primary-light hover:underline\"\r\n                >\r\n                    {selectedReports.size === processedReports.length ? t('deselectAll') : t('selectAll')}\r\n                </button>\r\n            </div>\r\n\r\n            {/* Reports List */}\r\n            {processedReports.length === 0 ? (\r\n                <div className=\"text-center py-12 text-text-light dark:text-dark-text-muted\">\r\n                    <CheckCircle2 className=\"w-12 h-12 mx-auto mb-4 opacity-50\" />\r\n                    <p>{t('noReports')}</p>\r\n                </div>\r\n            ) : (\r\n                <div className=\"space-y-3\">\r\n                    {processedReports.map(report => (\r\n                        <div\r\n                            key={report.id}\r\n                            className={`p-4 rounded-xl border transition-all ${selectedReports.has(report.id)\r\n                                ? 'border-primary bg-primary/5'\r\n                                : 'border-gray-200 dark:border-dark-border bg-white dark:bg-dark-surface'\r\n                                }`}\r\n                        >\r\n                            <div className=\"flex items-start gap-4\">\r\n                                {/* Checkbox */}\r\n                                <input\r\n                                    type=\"checkbox\"\r\n                                    checked={selectedReports.has(report.id)}\r\n                                    onChange={() => toggleSelect(report.id)}\r\n                                    className=\"mt-1 w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary\"\r\n                                />\r\n\r\n                                {/* Severity Indicator */}\r\n                                <div className={`flex-shrink-0 px-2.5 py-1 rounded-full text-xs font-medium ${severityConfig[report.severity || 'low'].color\r\n                                    }`}>\r\n                                    {severityConfig[report.severity || 'low'].label}\r\n                                    {report.confidence_score !== undefined && (\r\n                                        <span className=\"ml-1 opacity-75\">\r\n                                            ({Math.round(report.confidence_score * 100)}%)\r\n                                        </span>\r\n                                    )}\r\n                                </div>\r\n\r\n                                {/* Report Content */}\r\n                                <div className=\"flex-1 min-w-0\">\r\n                                    <div className=\"flex items-start justify-between gap-4\">\r\n                                        <div>\r\n                                            <h4 className=\"font-medium text-text dark:text-dark-text\">\r\n                                                {report.post?.title || tCommon('deletedPost')}\r\n                                            </h4>\r\n                                            <p className=\"text-sm text-text-light dark:text-dark-text-muted mt-1\">\r\n                                                <span className=\"font-medium capitalize\">{report.reason.replace('_', ' ')}</span>\r\n                                                {report.details && ` ΓÇö \"${report.details}\"`}\r\n                                            </p>\r\n                                        </div>\r\n                                        <span className=\"text-xs text-text-light dark:text-dark-text-muted flex-shrink-0\">\r\n                                            {formatDistanceToNow(new Date(report.created_at), { addSuffix: true })}\r\n                                        </span>\r\n                                    </div>\r\n\r\n                                    {/* Reporter Info */}\r\n                                    <p className=\"text-xs text-text-light dark:text-dark-text-muted mt-2\">\r\n                                        {t('reportedBy', { name: report.reporter?.name || report.reporter?.email?.split('@')[0] || tCommon('anonymous') })}\r\n                                    </p>\r\n\r\n                                    {/* Actions */}\r\n                                    <div className=\"flex items-center gap-2 mt-3\">\r\n                                        <Link href={`/post/${report.post_id}`} target=\"_blank\">\r\n                                            <Button size=\"sm\" variant=\"outline\" className=\"gap-1\">\r\n                                                <Eye className=\"w-3.5 h-3.5\" />\r\n                                                {t('viewPost')}\r\n                                            </Button>\r\n                                        </Link>\r\n                                        <Button\r\n                                            size=\"sm\"\r\n                                            variant=\"outline\"\r\n                                            onClick={() => handleAction(report.id, 'resolve')}\r\n                                            className=\"gap-1 text-green-600 hover:text-green-700 hover:bg-green-50\"\r\n                                        >\r\n                                            <CheckCircle2 className=\"w-3.5 h-3.5\" />\r\n                                            {t('actions.resolve')}\r\n                                        </Button>\r\n                                        <Button\r\n                                            size=\"sm\"\r\n                                            variant=\"outline\"\r\n                                            onClick={() => handleAction(report.id, 'dismiss')}\r\n                                            className=\"gap-1 text-gray-600 hover:text-gray-700\"\r\n                                        >\r\n                                            <XCircle className=\"w-3.5 h-3.5\" />\r\n                                            {t('actions.dismiss')}\r\n                                        </Button>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\Navbar.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\Navbar.tsx:59:5\n  57 |   // Prevent hydration mismatch\n  58 |   useEffect(() => {\n> 59 |     setMounted(true)\n     |     ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  60 |   }, [])\n  61 |\n  62 |   // Extract locale from pathname (first segment after /)","line":59,"column":5,"nodeType":null,"endLine":59,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { Link, usePathname } from '@/navigation'\r\nimport { useRouter } from 'next/navigation'\r\nimport { Menu, X, Moon, Sun, PenSquare, User, Settings, LogOut, ChevronDown, Bookmark, Shield, FlaskConical, BarChart3, Trophy } from 'lucide-react'\r\nimport { useTranslations } from 'next-intl'\r\nimport { LanguageSwitcher } from './LanguageSwitcher'\r\nimport { NotificationBell } from './NotificationBell'\r\nimport { SearchBar } from './SearchBar'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { useTheme } from '@/contexts/PreferencesContext'\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuLabel,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n} from \"@/components/ui/dropdown-menu\"\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { FeedbackButton } from \"@/components/feedback\"\r\n\r\ninterface NavbarProps {\r\n  user?: {\r\n    id: string\r\n    email?: string\r\n    user_metadata?: {\r\n      avatar_url?: string\r\n      full_name?: string\r\n      name?: string\r\n    }\r\n  } | null\r\n}\r\n\r\nconst NavLink = ({ href, children }: { href: string, children: React.ReactNode }) => (\r\n  <Link\r\n    href={href}\r\n    className=\"px-3 py-2 text-sm font-medium text-text-light dark:text-dark-text-muted hover:text-primary dark:hover:text-accent-light transition-colors\"\r\n  >\r\n    {children}\r\n  </Link>\r\n)\r\n\r\nexport function Navbar({ user }: NavbarProps) {\r\n  const t = useTranslations('Navigation')\r\n  const tCommon = useTranslations('Common')\r\n  const pathname = usePathname()\r\n  const router = useRouter()\r\n  const [isMenuOpen, setIsMenuOpen] = useState(false)\r\n  const [userAvatarUrl, setUserAvatarUrl] = useState<string | null>(user?.user_metadata?.avatar_url || null)\r\n  const [userRole, setUserRole] = useState<string | null>(null)\r\n  const [mounted, setMounted] = useState(false)\r\n  const { theme, setTheme, isDark } = useTheme()\r\n\r\n  // Prevent hydration mismatch\r\n  useEffect(() => {\r\n    setMounted(true)\r\n  }, [])\r\n\r\n  // Extract locale from pathname (first segment after /)\r\n  const locale = typeof window !== 'undefined' ? window.location.pathname.split('/')[1] || 'en' : 'en'\r\n\r\n  // Fetch avatar_url and role from users table\r\n  useEffect(() => {\r\n    const fetchUserData = async () => {\r\n      if (user?.id) {\r\n        const supabase = createClient()\r\n        const { data } = await supabase\r\n          .from('users')\r\n          .select('avatar_url, role')\r\n          .eq('id', user.id)\r\n          .single()\r\n\r\n        if (data) {\r\n          if (data.avatar_url && !userAvatarUrl) {\r\n            setUserAvatarUrl(data.avatar_url)\r\n          }\r\n          if (data.role) {\r\n            setUserRole(data.role)\r\n          }\r\n        }\r\n      }\r\n    }\r\n    fetchUserData()\r\n  }, [user?.id, userAvatarUrl])\r\n\r\n  const handleSignOut = async () => {\r\n    const supabase = createClient()\r\n    await supabase.auth.signOut()\r\n    router.push('/')\r\n    router.refresh()\r\n  }\r\n\r\n  // Safe access to user name/avatar since the user object structure might vary\r\n  // depending on whether it comes from auth.getUser() or a custom query\r\n  const userName = user?.user_metadata?.full_name || user?.user_metadata?.name || user?.email?.split('@')[0] || 'User'\r\n  const userAvatar = userAvatarUrl || user?.user_metadata?.avatar_url\r\n  const isAdminOrModerator = userRole === 'admin' || userRole === 'moderator'\r\n\r\n  // Toggle between light/dark/system - cycles: light -> dark -> system -> light\r\n  const toggleDarkMode = () => {\r\n    if (theme === 'light') {\r\n      setTheme('dark')\r\n    } else if (theme === 'dark') {\r\n      setTheme('system')\r\n    } else {\r\n      setTheme('light')\r\n    }\r\n  }\r\n\r\n  const toggleMenu = () => {\r\n    setIsMenuOpen(!isMenuOpen)\r\n  }\r\n\r\n  return (\r\n    <nav className=\"sticky top-0 z-50 bg-white/80 dark:bg-dark-surface/80 backdrop-blur-md border-b border-gray-200 dark:border-dark-border\">\r\n      <div className=\"container-custom\">\r\n        <div className=\"flex items-center justify-between h-16\">\r\n          {/* Logo */}\r\n          <Link\r\n            href=\"/\"\r\n            className=\"flex items-center space-x-2 group focus-ring rounded-lg px-2 py-1 -ml-2 shrink-0\"\r\n            aria-label={tCommon('appTitle')}\r\n          >\r\n            <div className=\"w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-lg flex items-center justify-center shadow-sm group-hover:shadow-md transition-all\">\r\n              <span className=\"text-white font-display font-bold text-lg\">S</span>\r\n            </div>\r\n            <span className=\"font-display font-bold text-xl text-primary dark:text-dark-text group-hover:text-secondary dark:group-hover:text-secondary-light transition-colors\">\r\n              {tCommon('appTitle')}\r\n            </span>\r\n          </Link>\r\n\r\n          {/* Desktop Navigation */}\r\n          <div className=\"hidden md:flex items-center gap-4 flex-1 min-w-0 justify-end\">\r\n            {/* Nav links - can shrink/hide on smaller screens */}\r\n            <div className=\"hidden lg:flex items-center gap-1 shrink min-w-0\">\r\n              <NavLink href=\"/feed\">{t('feed')}</NavLink>\r\n              <NavLink href=\"/explore\">{t('explore')}</NavLink>\r\n              <NavLink href=\"/resources\">{t('resources')}</NavLink>\r\n              <NavLink href=\"/events\">{t('events')}</NavLink>\r\n            </div>\r\n\r\n            <div className=\"hidden lg:block h-6 w-px bg-gray-200 dark:bg-dark-border shrink-0\" />\r\n\r\n            {/* Action items - never shrink */}\r\n            <div className=\"flex items-center gap-3 shrink-0\">\r\n              <SearchBar />\r\n\r\n              <LanguageSwitcher />\r\n\r\n              <button\r\n                onClick={toggleDarkMode}\r\n                className=\"p-2 text-text-light dark:text-dark-text-muted hover:text-primary dark:hover:text-accent-light hover:bg-gray-100 dark:hover:bg-dark-border rounded-full transition-all focus-ring\"\r\n                aria-label={mounted && isDark ? 'Switch to light mode' : 'Switch to dark mode'}\r\n              >\r\n                {mounted && isDark ? <Sun className=\"w-4 h-4\" /> : <Moon className=\"w-4 h-4\" />}\r\n              </button>\r\n\r\n              {user ? (\r\n                <>\r\n                  <NotificationBell />\r\n\r\n                  <Link href=\"/research-lab\" className=\"shrink-0\">\r\n                    <Button variant=\"outline\" size=\"sm\" className=\"gap-2 font-medium whitespace-nowrap\">\r\n                      <FlaskConical className=\"w-4 h-4\" />\r\n                      {t('researchLab')}\r\n                    </Button>\r\n                  </Link>\r\n\r\n                  <Link href=\"/editor\" className=\"shrink-0\">\r\n                    <Button size=\"sm\" className=\"gap-2 font-medium shadow-sm\">\r\n                      <PenSquare className=\"w-4 h-4\" />\r\n                      {t('write')}\r\n                    </Button>\r\n                  </Link>\r\n\r\n                  <DropdownMenu>\r\n                    <DropdownMenuTrigger asChild>\r\n                      <button className=\"flex items-center gap-2 ml-2 focus-ring rounded-full shrink-0\" suppressHydrationWarning>\r\n                        <Avatar className=\"w-8 h-8 border border-gray-200 dark:border-dark-border transition-transform hover:scale-105\">\r\n                          <AvatarImage src={userAvatar} alt={userName} />\r\n                          <AvatarFallback className=\"bg-primary/10 text-primary text-xs font-bold\">\r\n                            {userName.substring(0, 2).toUpperCase()}\r\n                          </AvatarFallback>\r\n                        </Avatar>\r\n                      </button>\r\n                    </DropdownMenuTrigger>\r\n                    <DropdownMenuContent align=\"end\" className=\"w-56\">\r\n                      <DropdownMenuLabel>\r\n                        <div className=\"flex flex-col space-y-1\">\r\n                          <p className=\"text-sm font-medium leading-none\">{userName}</p>\r\n                          <p className=\"text-xs leading-none text-muted-foreground truncate\">\r\n                            {user.email}\r\n                          </p>\r\n                        </div>\r\n                      </DropdownMenuLabel>\r\n                      <DropdownMenuSeparator />\r\n                      <DropdownMenuItem asChild>\r\n                        <Link href={`/profile/${user.id}`} className=\"cursor-pointer w-full flex items-center\">\r\n                          <User className=\"mr-2 h-4 w-4\" />\r\n                          <span>{t('profile')}</span>\r\n                        </Link>\r\n                      </DropdownMenuItem>\r\n                      <DropdownMenuItem asChild>\r\n                        <Link href=\"/saved\" className=\"cursor-pointer w-full flex items-center\">\r\n                          <Bookmark className=\"mr-2 h-4 w-4\" />\r\n                          <span>{t('saved')}</span>\r\n                        </Link>\r\n                      </DropdownMenuItem>\r\n                      <DropdownMenuItem asChild>\r\n                        <Link href=\"/analytics\" className=\"cursor-pointer w-full flex items-center\">\r\n                          <BarChart3 className=\"mr-2 h-4 w-4\" />\r\n                          <span>{t('analytics')}</span>\r\n                        </Link>\r\n                      </DropdownMenuItem>\r\n                      <DropdownMenuItem asChild>\r\n                        <Link href=\"/achievements\" className=\"cursor-pointer w-full flex items-center\">\r\n                          <Trophy className=\"mr-2 h-4 w-4\" />\r\n                          <span>{t('achievements')}</span>\r\n                        </Link>\r\n                      </DropdownMenuItem>\r\n                      <DropdownMenuItem asChild>\r\n                        <Link href=\"/settings\" className=\"cursor-pointer w-full flex items-center\">\r\n                          <Settings className=\"mr-2 h-4 w-4\" />\r\n                          <span>{t('settings')}</span>\r\n                        </Link>\r\n                      </DropdownMenuItem>\r\n                      {isAdminOrModerator && (\r\n                        <>\r\n                          <DropdownMenuSeparator />\r\n                          <DropdownMenuItem asChild>\r\n                            <Link href=\"/admin\" className=\"cursor-pointer w-full flex items-center\">\r\n                              <Shield className=\"mr-2 h-4 w-4\" />\r\n                              <span>{t('admin')}</span>\r\n                            </Link>\r\n                          </DropdownMenuItem>\r\n                        </>\r\n                      )}\r\n                      <DropdownMenuSeparator />\r\n                      <DropdownMenuItem onClick={handleSignOut} className=\"cursor-pointer text-accent dark:text-accent-light\">\r\n                        <LogOut className=\"mr-2 h-4 w-4\" />\r\n                        <span>{t('logout')}</span>\r\n                      </DropdownMenuItem>\r\n                    </DropdownMenuContent>\r\n                  </DropdownMenu>\r\n                </>\r\n              ) : (\r\n                <div className=\"flex items-center gap-2 ml-2\">\r\n                  <Link href=\"/auth/login\">\r\n                    <Button variant=\"ghost\" size=\"sm\" className=\"font-medium\">\r\n                      {t('login')}\r\n                    </Button>\r\n                  </Link>\r\n                  <Link href=\"/auth/signup\">\r\n                    <Button size=\"sm\" className=\"font-medium\">\r\n                      {tCommon('primaryCta')}\r\n                    </Button>\r\n                  </Link>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Mobile Menu Button */}\r\n          <div className=\"flex items-center gap-2 md:hidden\">\r\n            <LanguageSwitcher />\r\n            <button\r\n              onClick={toggleMenu}\r\n              className=\"p-2 text-text dark:text-dark-text hover:bg-gray-100 dark:hover:bg-dark-border rounded-lg transition-all focus-ring\"\r\n              aria-label={isMenuOpen ? 'Close menu' : 'Open menu'}\r\n              aria-expanded={isMenuOpen}\r\n            >\r\n              {isMenuOpen ? <X className=\"w-6 h-6\" /> : <Menu className=\"w-6 h-6\" />}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Mobile Menu */}\r\n        {isMenuOpen && (\r\n          <div className=\"md:hidden py-4 space-y-2 border-t border-gray-200 dark:border-dark-border animate-in slide-in-from-top-2 duration-200\">\r\n            <Link\r\n              href=\"/feed\"\r\n              className=\"block px-4 py-3 text-text dark:text-dark-text hover:bg-gray-50 dark:hover:bg-dark-surface rounded-lg transition-all font-medium\"\r\n              onClick={() => setIsMenuOpen(false)}\r\n            >\r\n              {t('feed')}\r\n            </Link>\r\n            <Link\r\n              href=\"/explore\"\r\n              className=\"block px-4 py-3 text-text dark:text-dark-text hover:bg-gray-50 dark:hover:bg-dark-surface rounded-lg transition-all font-medium\"\r\n              onClick={() => setIsMenuOpen(false)}\r\n            >\r\n              {t('explore')}\r\n            </Link>\r\n            <Link\r\n              href=\"/resources\"\r\n              className=\"block px-4 py-3 text-text dark:text-dark-text hover:bg-gray-50 dark:hover:bg-dark-surface rounded-lg transition-all font-medium\"\r\n              onClick={() => setIsMenuOpen(false)}\r\n            >\r\n              {t('resources')}\r\n            </Link>\r\n            <Link\r\n              href=\"/research-lab\"\r\n              className=\"flex items-center gap-2 px-4 py-3 text-text dark:text-dark-text hover:bg-gray-50 dark:hover:bg-dark-surface rounded-lg transition-all font-medium\"\r\n              onClick={() => setIsMenuOpen(false)}\r\n            >\r\n              <FlaskConical className=\"w-4 h-4\" />\r\n              {t('researchLab')}\r\n            </Link>\r\n            <Link\r\n              href=\"/events\"\r\n              className=\"block px-4 py-3 text-text dark:text-dark-text hover:bg-gray-50 dark:hover:bg-dark-surface rounded-lg transition-all font-medium\"\r\n              onClick={() => setIsMenuOpen(false)}\r\n            >\r\n              {t('events')}\r\n            </Link>\r\n\r\n            <div className=\"border-t border-gray-100 dark:border-dark-border my-2 pt-2\">\r\n              {user ? (\r\n                <>\r\n                  <div className=\"px-4 py-2 flex items-center gap-3\">\r\n                    <Avatar className=\"w-10 h-10 border border-gray-200 dark:border-dark-border\">\r\n                      <AvatarImage src={userAvatar} alt={userName} />\r\n                      <AvatarFallback className=\"bg-primary/10 text-primary\">\r\n                        {userName.substring(0, 2).toUpperCase()}\r\n                      </AvatarFallback>\r\n                    </Avatar>\r\n                    <div>\r\n                      <p className=\"font-medium text-sm text-text dark:text-dark-text\">{userName}</p>\r\n                      <p className=\"text-xs text-text-light dark:text-dark-text-muted truncate max-w-[200px]\">{user.email}</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <Link\r\n                    href=\"/editor\"\r\n                    className=\"flex items-center gap-2 px-4 py-3 text-primary dark:text-accent-light font-medium\"\r\n                    onClick={() => setIsMenuOpen(false)}\r\n                  >\r\n                    <PenSquare className=\"w-4 h-4\" />\r\n                    {t('write')}\r\n                  </Link>\r\n\r\n                  <Link\r\n                    href={`/profile/${user.id}`}\r\n                    className=\"flex items-center gap-2 px-4 py-3 text-text dark:text-dark-text hover:bg-gray-50 dark:hover:bg-dark-surface rounded-lg transition-all font-medium\"\r\n                    onClick={() => setIsMenuOpen(false)}\r\n                  >\r\n                    <User className=\"w-4 h-4\" />\r\n                    {t('profile')}\r\n                  </Link>\r\n\r\n                  {isAdminOrModerator && (\r\n                    <Link\r\n                      href=\"/admin\"\r\n                      className=\"flex items-center gap-2 px-4 py-3 text-text dark:text-dark-text hover:bg-gray-50 dark:hover:bg-dark-surface rounded-lg transition-all font-medium\"\r\n                      onClick={() => setIsMenuOpen(false)}\r\n                    >\r\n                      <Shield className=\"w-4 h-4\" />\r\n                      {t('admin')}\r\n                    </Link>\r\n                  )}\r\n                  <button\r\n                    onClick={handleSignOut}\r\n                    className=\"w-full flex items-center gap-2 px-4 py-3 text-accent dark:text-accent-light hover:bg-accent/10 dark:hover:bg-accent/10 rounded-lg transition-all font-medium\"\r\n                  >\r\n                    <LogOut className=\"w-4 h-4\" />\r\n                    {t('logout')}\r\n                  </button>\r\n                </>\r\n              ) : (\r\n                <div className=\"p-4 space-y-3\">\r\n                  <Link\r\n                    href=\"/auth/login\"\r\n                    className=\"block w-full text-center py-2.5 text-text dark:text-dark-text border border-gray-200 dark:border-dark-border rounded-lg font-medium hover:bg-gray-50 dark:hover:bg-dark-surface transition-colors\"\r\n                    onClick={() => setIsMenuOpen(false)}\r\n                  >\r\n                    {t('login')}\r\n                  </Link>\r\n                  <Link\r\n                    href=\"/auth/signup\"\r\n                    className=\"block w-full text-center py-2.5 bg-primary text-white rounded-lg font-medium hover:bg-primary-dark transition-colors shadow-sm\"\r\n                    onClick={() => setIsMenuOpen(false)}\r\n                  >\r\n                    {tCommon('primaryCta')}\r\n                  </Link>\r\n                </div>\r\n              )}\r\n\r\n              <div className=\"px-4 py-2 flex items-center justify-between\">\r\n                <span className=\"text-sm text-text-light dark:text-dark-text-muted\">Theme</span>\r\n                <button\r\n                  onClick={toggleDarkMode}\r\n                  className=\"p-2 text-text dark:text-dark-text hover:bg-gray-100 dark:hover:bg-dark-border rounded-lg transition-all\"\r\n                >\r\n                  {mounted && isDark ? <Sun className=\"w-5 h-5\" /> : <Moon className=\"w-5 h-5\" />}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Global Floating Feedback Button */}\r\n      <FeedbackButton />\r\n    </nav>\r\n  )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\NotificationBell.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchUnreadCount` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\NotificationBell.tsx:16:9\n  14 |\n  15 |     useEffect(() => {\n> 16 |         fetchUnreadCount()\n     |         ^^^^^^^^^^^^^^^^ `fetchUnreadCount` accessed before it is declared\n  17 |\n  18 |         // Subscribe to new notifications\n  19 |         const channel = supabase\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\NotificationBell.tsx:80:5\n  78 |     }, [])\n  79 |\n> 80 |     const fetchUnreadCount = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |         const { data: { user } } = await supabase.auth.getUser()\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 82 |         if (!user) return\n     ΓÇª\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 90 |         setUnreadCount(count || 0)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 91 |     }\n     | ^^^^^^ `fetchUnreadCount` is declared here\n  92 |\n  93 |     // Close dropdown when clicking outside\n  94 |     useEffect(() => {","line":16,"column":9,"nodeType":null,"endLine":16,"endColumn":25},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchUnreadCount' and 'supabase'. Either include them or remove the dependency array.","line":38,"column":8,"nodeType":"ArrayExpression","endLine":38,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchUnreadCount, supabase]","fix":{"range":[1227,1229],"text":"[fetchUnreadCount, supabase]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'supabase'. Either include it or remove the dependency array.","line":78,"column":8,"nodeType":"ArrayExpression","endLine":78,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [supabase]","fix":{"range":[2493,2495],"text":"[supabase]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect, useRef } from 'react'\r\nimport { Bell } from 'lucide-react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { NotificationList } from './NotificationList'\r\nimport { cn } from '@/lib/utils'\r\n\r\nexport function NotificationBell() {\r\n    const [isOpen, setIsOpen] = useState(false)\r\n    const [unreadCount, setUnreadCount] = useState(0)\r\n    const dropdownRef = useRef<HTMLDivElement>(null)\r\n    const supabase = createClient()\r\n\r\n    useEffect(() => {\r\n        fetchUnreadCount()\r\n\r\n        // Subscribe to new notifications\r\n        const channel = supabase\r\n            .channel('notifications')\r\n            .on(\r\n                'postgres_changes',\r\n                {\r\n                    event: 'INSERT',\r\n                    schema: 'public',\r\n                    table: 'notifications',\r\n                    filter: `user_id=eq.${(supabase.auth.getUser() as any).id}` // This might be tricky if user not loaded yet\r\n                },\r\n                () => {\r\n                    setUnreadCount(prev => prev + 1)\r\n                }\r\n            )\r\n            .subscribe()\r\n\r\n        return () => {\r\n            supabase.removeChannel(channel)\r\n        }\r\n    }, [])\r\n\r\n    // Better subscription setup that waits for user\r\n    useEffect(() => {\r\n        const setupSubscription = async () => {\r\n            const { data: { user } } = await supabase.auth.getUser()\r\n            if (!user) return\r\n\r\n            // Initial fetch\r\n            const { count } = await supabase\r\n                .from('notifications')\r\n                .select('*', { count: 'exact', head: true })\r\n                .eq('user_id', user.id)\r\n                .eq('is_read', false)\r\n\r\n            setUnreadCount(count || 0)\r\n\r\n            // Subscribe\r\n            const channel = supabase\r\n                .channel(`notifications:${user.id}`)\r\n                .on(\r\n                    'postgres_changes',\r\n                    {\r\n                        event: 'INSERT',\r\n                        schema: 'public',\r\n                        table: 'notifications',\r\n                        filter: `user_id=eq.${user.id}`\r\n                    },\r\n                    (payload) => {\r\n                        setUnreadCount(prev => prev + 1)\r\n                    }\r\n                )\r\n                .subscribe()\r\n\r\n            return () => {\r\n                supabase.removeChannel(channel)\r\n            }\r\n        }\r\n\r\n        setupSubscription()\r\n    }, [])\r\n\r\n    const fetchUnreadCount = async () => {\r\n        const { data: { user } } = await supabase.auth.getUser()\r\n        if (!user) return\r\n\r\n        const { count } = await supabase\r\n            .from('notifications')\r\n            .select('*', { count: 'exact', head: true })\r\n            .eq('user_id', user.id)\r\n            .eq('is_read', false)\r\n\r\n        setUnreadCount(count || 0)\r\n    }\r\n\r\n    // Close dropdown when clicking outside\r\n    useEffect(() => {\r\n        const handleClickOutside = (event: MouseEvent) => {\r\n            if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\r\n                setIsOpen(false)\r\n            }\r\n        }\r\n\r\n        document.addEventListener('mousedown', handleClickOutside)\r\n        return () => {\r\n            document.removeEventListener('mousedown', handleClickOutside)\r\n        }\r\n    }, [])\r\n\r\n    const toggleDropdown = () => {\r\n        setIsOpen(!isOpen)\r\n        if (!isOpen) {\r\n            // Optionally mark as read when opening, but usually better to do it on click or explicit action\r\n            // For now, we just open the list\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"relative\" ref={dropdownRef}>\r\n            <button\r\n                onClick={toggleDropdown}\r\n                className={cn(\r\n                    \"relative p-2 rounded-full transition-all duration-200\",\r\n                    \"hover:bg-gray-100 dark:hover:bg-dark-border\",\r\n                    \"text-text-light dark:text-dark-text-muted\",\r\n                    \"focus:outline-none focus-visible:ring-2 focus-visible:ring-primary\",\r\n                    isOpen && \"bg-gray-100 dark:bg-dark-border\"\r\n                )}\r\n                aria-label=\"Notifications\"\r\n            >\r\n                <Bell className={cn(\"w-5 h-5\", unreadCount > 0 && \"animate-bounce-subtle\")} />\r\n                {unreadCount > 0 && (\r\n                    <span className={cn(\r\n                        \"absolute top-0.5 right-0.5 min-w-[18px] h-[18px]\",\r\n                        \"flex items-center justify-center\",\r\n                        \"text-[10px] font-bold text-white\",\r\n                        \"bg-accent rounded-full\",\r\n                        \"border-2 border-white dark:border-dark-bg\",\r\n                        \"animate-notification-pulse\"\r\n                    )}>\r\n                        {unreadCount > 9 ? '9+' : unreadCount}\r\n                    </span>\r\n                )}\r\n            </button>\r\n\r\n            {isOpen && (\r\n                <div className=\"absolute right-0 mt-2 w-80 sm:w-96 z-50 animate-dropdown-enter\">\r\n                    <NotificationList onClose={() => setIsOpen(false)} />\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\NotificationCenter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\NotificationList.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchNotifications` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\NotificationList.tsx:34:9\n  32 |\n  33 |     useEffect(() => {\n> 34 |         fetchNotifications()\n     |         ^^^^^^^^^^^^^^^^^^ `fetchNotifications` accessed before it is declared\n  35 |     }, [])\n  36 |\n  37 |     const fetchNotifications = async () => {\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\NotificationList.tsx:37:5\n  35 |     }, [])\n  36 |\n> 37 |     const fetchNotifications = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 38 |         const { data } = await supabase\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 39 |             .from('notifications')\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 40 |             .select('*')\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 41 |             .order('created_at', { ascending: false })\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 42 |             .limit(20)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 43 |\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 44 |         if (data) setNotifications(data as Notification[])\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 45 |         setLoading(false)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 46 |     }\n     | ^^^^^^ `fetchNotifications` is declared here\n  47 |\n  48 |     const markAsRead = async (id: string, e?: React.MouseEvent) => {\n  49 |         if (e) {","line":34,"column":9,"nodeType":null,"endLine":34,"endColumn":27},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchNotifications'. Either include it or remove the dependency array.","line":35,"column":8,"nodeType":"ArrayExpression","endLine":35,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchNotifications]","fix":{"range":[1148,1150],"text":"[fetchNotifications]"}}]},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/notifications/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":202,"column":17,"nodeType":"JSXOpeningElement","endLine":206,"endColumn":18},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/notifications/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":202,"column":17,"nodeType":"JSXOpeningElement","endLine":206,"endColumn":18},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/notifications/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":202,"column":17,"nodeType":"JSXOpeningElement","endLine":206,"endColumn":18},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/notifications/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":202,"column":17,"nodeType":"JSXOpeningElement","endLine":206,"endColumn":18},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/notifications/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":202,"column":17,"nodeType":"JSXOpeningElement","endLine":206,"endColumn":18},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/notifications/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":202,"column":17,"nodeType":"JSXOpeningElement","endLine":206,"endColumn":18},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/notifications/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":202,"column":17,"nodeType":"JSXOpeningElement","endLine":206,"endColumn":18},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/notifications/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":202,"column":17,"nodeType":"JSXOpeningElement","endLine":206,"endColumn":18},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/notifications/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":202,"column":17,"nodeType":"JSXOpeningElement","endLine":206,"endColumn":18},{"ruleId":"@next/next/no-html-link-for-pages","severity":1,"message":"Do not use an `<a>` element to navigate to `/notifications/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":202,"column":17,"nodeType":"JSXOpeningElement","endLine":206,"endColumn":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { Bell, Check, MessageSquare, Award, CheckCircle } from 'lucide-react'\r\nimport { formatDistanceToNow } from 'date-fns'\r\nimport { cn } from '@/lib/utils'\r\nimport { NotificationSkeleton } from '@/components/ui/skeleton'\r\nimport { NoNotificationsIllustration } from '@/components/ui/EmptyState'\r\n\r\ninterface Notification {\r\n    id: string\r\n    type: 'badge' | 'solution' | 'reply' | 'mention' | 'system'\r\n    title: string\r\n    message: string\r\n    url: string | null\r\n    is_read: boolean\r\n    created_at: string\r\n}\r\n\r\ninterface NotificationListProps {\r\n    onClose?: () => void\r\n}\r\n\r\nexport function NotificationList({ onClose }: NotificationListProps) {\r\n    const [notifications, setNotifications] = useState<Notification[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [hoveredId, setHoveredId] = useState<string | null>(null)\r\n    const supabase = createClient()\r\n    const router = useRouter()\r\n\r\n    useEffect(() => {\r\n        fetchNotifications()\r\n    }, [])\r\n\r\n    const fetchNotifications = async () => {\r\n        const { data } = await supabase\r\n            .from('notifications')\r\n            .select('*')\r\n            .order('created_at', { ascending: false })\r\n            .limit(20)\r\n\r\n        if (data) setNotifications(data as Notification[])\r\n        setLoading(false)\r\n    }\r\n\r\n    const markAsRead = async (id: string, e?: React.MouseEvent) => {\r\n        if (e) {\r\n            e.stopPropagation()\r\n        }\r\n        await supabase\r\n            .from('notifications')\r\n            .update({ is_read: true })\r\n            .eq('id', id)\r\n\r\n        setNotifications(prev => prev.map(n =>\r\n            n.id === id ? { ...n, is_read: true } : n\r\n        ))\r\n    }\r\n\r\n    const markAllAsRead = async () => {\r\n        await supabase\r\n            .from('notifications')\r\n            .update({ is_read: true })\r\n            .eq('is_read', false)\r\n\r\n        setNotifications(prev => prev.map(n => ({ ...n, is_read: true })))\r\n    }\r\n\r\n    const handleNotificationClick = async (notification: Notification) => {\r\n        if (!notification.is_read) {\r\n            await markAsRead(notification.id)\r\n        }\r\n        if (onClose) onClose()\r\n        if (notification.url) {\r\n            router.push(notification.url)\r\n        }\r\n    }\r\n\r\n    const getIcon = (type: string) => {\r\n        switch (type) {\r\n            case 'badge': return <Award className=\"w-5 h-5 text-yellow-500\" />\r\n            case 'solution': return <CheckCircle className=\"w-5 h-5 text-green-500\" />\r\n            case 'reply': return <MessageSquare className=\"w-5 h-5 text-blue-500\" />\r\n            default: return <Bell className=\"w-5 h-5 text-gray-500 dark:text-gray-400\" />\r\n        }\r\n    }\r\n\r\n    // Loading state with skeletons\r\n    if (loading) {\r\n        return (\r\n            <div className=\"w-full max-w-sm bg-white dark:bg-dark-surface rounded-xl shadow-xl border border-gray-200 dark:border-dark-border overflow-hidden animate-fade-in-up\">\r\n                <div className=\"p-4 border-b border-gray-200 dark:border-dark-border bg-gray-50/50 dark:bg-dark-bg/50\">\r\n                    <div className=\"h-5 w-24 skeleton rounded\" />\r\n                </div>\r\n                <div>\r\n                    {Array.from({ length: 3 }).map((_, i) => (\r\n                        <NotificationSkeleton key={i} />\r\n                    ))}\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    // Empty state with illustration\r\n    if (notifications.length === 0) {\r\n        return (\r\n            <div className=\"w-full max-w-sm bg-white dark:bg-dark-surface rounded-xl shadow-xl border border-gray-200 dark:border-dark-border overflow-hidden animate-fade-in-up\">\r\n                <div className=\"p-4 border-b border-gray-200 dark:border-dark-border bg-gray-50/50 dark:bg-dark-bg/50\">\r\n                    <h3 className=\"font-semibold text-sm text-text dark:text-dark-text\">Notifications</h3>\r\n                </div>\r\n                <div className=\"py-8 px-4 text-center\">\r\n                    <NoNotificationsIllustration className=\"w-32 h-32 mx-auto mb-4 opacity-80\" />\r\n                    <p className=\"text-sm font-medium text-text dark:text-dark-text mb-1\">All caught up!</p>\r\n                    <p className=\"text-xs text-text-light dark:text-dark-text-muted\">\r\n                        No notifications yet. We&apos;ll let you know when something happens.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"w-full max-w-sm bg-white dark:bg-dark-surface rounded-xl shadow-xl border border-gray-200 dark:border-dark-border overflow-hidden animate-fade-in-up\">\r\n            <div className=\"p-4 border-b border-gray-200 dark:border-dark-border flex justify-between items-center bg-gray-50/50 dark:bg-dark-bg/50\">\r\n                <h3 className=\"font-semibold text-sm text-text dark:text-dark-text\">Notifications</h3>\r\n                <button\r\n                    onClick={markAllAsRead}\r\n                    className=\"text-xs text-primary hover:text-primary-dark dark:hover:text-primary-light transition-colors font-medium\"\r\n                >\r\n                    Mark all as read\r\n                </button>\r\n            </div>\r\n            <div className=\"max-h-[400px] overflow-y-auto\">\r\n                {notifications.map((notification, index) => (\r\n                    <div\r\n                        key={notification.id}\r\n                        onClick={() => handleNotificationClick(notification)}\r\n                        onMouseEnter={() => setHoveredId(notification.id)}\r\n                        onMouseLeave={() => setHoveredId(null)}\r\n                        className={cn(\r\n                            \"p-4 border-b border-gray-100 dark:border-dark-border cursor-pointer\",\r\n                            \"hover:bg-gray-50 dark:hover:bg-dark-border/50 transition-all duration-200\",\r\n                            \"flex gap-3 relative group\",\r\n                            !notification.is_read && \"bg-primary/5 dark:bg-primary/10\",\r\n                            \"animate-fade-in-up\"\r\n                        )}\r\n                        style={{ animationDelay: `${index * 50}ms` }}\r\n                    >\r\n                        {/* Icon with subtle background */}\r\n                        <div className=\"mt-0.5 flex-shrink-0 w-9 h-9 rounded-full bg-gray-100 dark:bg-dark-border flex items-center justify-center\">\r\n                            {getIcon(notification.type)}\r\n                        </div>\r\n\r\n                        {/* Content */}\r\n                        <div className=\"flex-1 min-w-0\">\r\n                            <p className={cn(\r\n                                \"text-sm text-gray-900 dark:text-gray-100 leading-snug\",\r\n                                !notification.is_read && \"font-semibold\"\r\n                            )}>\r\n                                {notification.title}\r\n                            </p>\r\n                            <p className=\"text-sm text-gray-500 dark:text-gray-400 line-clamp-2 mt-0.5\">\r\n                                {notification.message}\r\n                            </p>\r\n                            <p className=\"text-xs text-gray-400 dark:text-gray-500 mt-1.5\">\r\n                                {formatDistanceToNow(new Date(notification.created_at), { addSuffix: true })}\r\n                            </p>\r\n                        </div>\r\n\r\n                        {/* Unread indicator / Mark as read button */}\r\n                        <div className=\"flex-shrink-0 flex items-start pt-1\">\r\n                            {!notification.is_read && (\r\n                                <>\r\n                                    {/* Blue dot when not hovered */}\r\n                                    <div className={cn(\r\n                                        \"w-2.5 h-2.5 rounded-full bg-primary transition-opacity\",\r\n                                        \"shadow-sm shadow-primary/30\",\r\n                                        hoveredId === notification.id && \"opacity-0\"\r\n                                    )} />\r\n                                    {/* Check button on hover */}\r\n                                    <button\r\n                                        onClick={(e) => markAsRead(notification.id, e)}\r\n                                        className={cn(\r\n                                            \"absolute right-3 top-3 p-1.5 rounded-full\",\r\n                                            \"bg-primary/10 text-primary hover:bg-primary hover:text-white\",\r\n                                            \"transition-all duration-200\",\r\n                                            hoveredId === notification.id ? \"opacity-100 scale-100\" : \"opacity-0 scale-75\"\r\n                                        )}\r\n                                        title=\"Mark as read\"\r\n                                    >\r\n                                        <Check className=\"w-3.5 h-3.5\" />\r\n                                    </button>\r\n                                </>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n            <div className=\"p-3 border-t border-gray-200 dark:border-dark-border bg-gray-50/50 dark:bg-dark-bg/50\">\r\n                <a\r\n                    href=\"/notifications\"\r\n                    onClick={() => onClose?.()}\r\n                    className=\"block text-center text-sm font-medium text-primary hover:text-primary-dark dark:hover:text-primary-light transition-colors\"\r\n                >\r\n                    View All Notifications\r\n                </a>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\NotificationsPageContent.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\NotificationsProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\OfflineIndicator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\OnboardingModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\PlagiarismCheckButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\PlagiarismDetails.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":329,"column":53,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[14992,15047],"text":"\r\n                                                    &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[14992,15047],"text":"\r\n                                                    &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[14992,15047],"text":"\r\n                                                    &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[14992,15047],"text":"\r\n                                                    &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":329,"column":74,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15067,15118],"text":"&quot;\r\n                                                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15067,15118],"text":"&ldquo;\r\n                                                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15067,15118],"text":"&#34;\r\n                                                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15067,15118],"text":"&rdquo;\r\n                                                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":346,"column":69,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[15969,16030],"text":"ΓÇó Paraphrase or rewrite content that&apos;s too similar to sources"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[15969,16030],"text":"ΓÇó Paraphrase or rewrite content that&lsquo;s too similar to sources"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[15969,16030],"text":"ΓÇó Paraphrase or rewrite content that&#39;s too similar to sources"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[15969,16030],"text":"ΓÇó Paraphrase or rewrite content that&rsquo;s too similar to sources"},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect, useMemo } from 'react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { AlertTriangle, CheckCircle, ExternalLink, FileSearch, X, Eye } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog'\r\n\r\ninterface PlagiarismMatch {\r\n    source_url?: string\r\n    source_title?: string\r\n    matched_text?: string\r\n    similarity?: number\r\n}\r\n\r\ninterface PlagiarismDetailsProps {\r\n    postId?: string\r\n    postVersionId?: string\r\n    score?: number\r\n    matches?: PlagiarismMatch[]\r\n    variant?: 'badge' | 'inline' | 'full'\r\n}\r\n\r\n/**\r\n * Displays plagiarism check results with:\r\n * - Visual similarity percentage\r\n * - Matched source links\r\n * - Highlighted matched text (in modal)\r\n */\r\nexport function PlagiarismDetails({\r\n    postId,\r\n    postVersionId,\r\n    score: initialScore,\r\n    matches: initialMatches,\r\n    variant = 'badge'\r\n}: PlagiarismDetailsProps) {\r\n    const [score, setScore] = useState<number | null>(initialScore ?? null)\r\n    const [matches, setMatches] = useState<PlagiarismMatch[]>(initialMatches || [])\r\n    const [loading, setLoading] = useState(!initialScore && !initialMatches)\r\n    const [showModal, setShowModal] = useState(false)\r\n    const supabase = useMemo(() => createClient(), [])\r\n\r\n    useEffect(() => {\r\n        if (initialScore !== undefined || initialMatches) {\r\n            setLoading(false)\r\n            return\r\n        }\r\n\r\n        async function fetchPlagiarismData() {\r\n            try {\r\n                const { data, error } = await supabase\r\n                    .from('plagiarism_checks')\r\n                    .select('score, sources, status, flagged')\r\n                    .eq(postVersionId ? 'post_version_id' : 'post_id', postVersionId || postId)\r\n                    .order('created_at', { ascending: false })\r\n                    .limit(1)\r\n                    .single()\r\n\r\n                if (error) {\r\n                    // No plagiarism check exists yet\r\n                    setScore(null)\r\n                    return\r\n                }\r\n\r\n                setScore(data.score / 100) // Normalize to 0-1\r\n\r\n                // Parse sources if available\r\n                if (data.sources) {\r\n                    try {\r\n                        const parsedSources = typeof data.sources === 'string'\r\n                            ? JSON.parse(data.sources)\r\n                            : data.sources\r\n                        setMatches(parsedSources)\r\n                    } catch {\r\n                        setMatches([])\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                console.error('Error fetching plagiarism data:', error)\r\n            } finally {\r\n                setLoading(false)\r\n            }\r\n        }\r\n\r\n        if (postId || postVersionId) {\r\n            fetchPlagiarismData()\r\n        }\r\n    }, [postId, postVersionId, initialScore, initialMatches, supabase])\r\n\r\n    if (loading) {\r\n        return variant === 'badge' ? null : (\r\n            <div className=\"animate-pulse h-4 w-20 bg-gray-200 dark:bg-dark-surface rounded\" />\r\n        )\r\n    }\r\n\r\n    // No plagiarism data or score is below threshold\r\n    if (score === null || score < 0.3) {\r\n        return null\r\n    }\r\n\r\n    const isHighRisk = score >= 0.7\r\n    const isMediumRisk = score >= 0.5\r\n\r\n    const getColorClasses = () => {\r\n        if (isHighRisk) return 'bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 border-red-200 dark:border-red-800'\r\n        if (isMediumRisk) return 'bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-400 border-orange-200 dark:border-orange-800'\r\n        return 'bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 border-yellow-200 dark:border-yellow-800'\r\n    }\r\n\r\n    const percentScore = Math.round(score * 100)\r\n\r\n    // Badge variant - compact inline display\r\n    if (variant === 'badge') {\r\n        return (\r\n            <>\r\n                <button\r\n                    onClick={() => setShowModal(true)}\r\n                    className={`inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full text-xs font-medium border ${getColorClasses()} hover:opacity-80 transition-opacity`}\r\n                >\r\n                    <AlertTriangle className=\"w-3 h-3\" />\r\n                    <span>{percentScore}% match</span>\r\n                </button>\r\n\r\n                <PlagiarismModal\r\n                    isOpen={showModal}\r\n                    onClose={() => setShowModal(false)}\r\n                    score={score}\r\n                    matches={matches}\r\n                />\r\n            </>\r\n        )\r\n    }\r\n\r\n    // Inline variant - for cards/lists\r\n    if (variant === 'inline') {\r\n        return (\r\n            <>\r\n                <div className={`flex items-center gap-2 p-3 rounded-lg border ${getColorClasses()}`}>\r\n                    <AlertTriangle className=\"w-4 h-4 flex-shrink-0\" />\r\n                    <div className=\"flex-1 min-w-0\">\r\n                        <span className=\"text-sm font-medium\">\r\n                            {isHighRisk ? 'High similarity detected' : 'Potential similarity detected'}\r\n                        </span>\r\n                        <span className=\"text-sm opacity-75 ml-1\">({percentScore}% match)</span>\r\n                    </div>\r\n                    <Button\r\n                        size=\"sm\"\r\n                        variant=\"ghost\"\r\n                        onClick={() => setShowModal(true)}\r\n                        className=\"gap-1 text-xs\"\r\n                    >\r\n                        <Eye className=\"w-3.5 h-3.5\" />\r\n                        Details\r\n                    </Button>\r\n                </div>\r\n\r\n                <PlagiarismModal\r\n                    isOpen={showModal}\r\n                    onClose={() => setShowModal(false)}\r\n                    score={score}\r\n                    matches={matches}\r\n                />\r\n            </>\r\n        )\r\n    }\r\n\r\n    // Full variant - expanded view\r\n    return (\r\n        <>\r\n            <div className={`p-4 rounded-xl border ${getColorClasses()}`}>\r\n                <div className=\"flex items-start gap-3\">\r\n                    <div className=\"p-2 rounded-lg bg-white/50 dark:bg-black/20\">\r\n                        <FileSearch className=\"w-5 h-5\" />\r\n                    </div>\r\n                    <div className=\"flex-1\">\r\n                        <h4 className=\"font-semibold text-sm\">\r\n                            {isHighRisk ? 'ΓÜá∩╕Å High Similarity Alert' : 'Similarity Notice'}\r\n                        </h4>\r\n                        <p className=\"text-sm mt-1 opacity-80\">\r\n                            This content shows {percentScore}% similarity with existing sources.\r\n                        </p>\r\n\r\n                        {/* Similarity Bar */}\r\n                        <div className=\"mt-3\">\r\n                            <div className=\"flex items-center justify-between text-xs mb-1\">\r\n                                <span>Similarity Score</span>\r\n                                <span className=\"font-medium\">{percentScore}%</span>\r\n                            </div>\r\n                            <div className=\"h-2 rounded-full bg-white/50 dark:bg-black/20 overflow-hidden\">\r\n                                <div\r\n                                    className={`h-full rounded-full transition-all ${isHighRisk ? 'bg-red-500' : isMediumRisk ? 'bg-orange-500' : 'bg-yellow-500'\r\n                                        }`}\r\n                                    style={{ width: `${percentScore}%` }}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Sources Preview */}\r\n                        {matches.length > 0 && (\r\n                            <div className=\"mt-3 space-y-2\">\r\n                                <span className=\"text-xs font-medium\">Matched Sources:</span>\r\n                                {matches.slice(0, 2).map((match, idx) => (\r\n                                    <div key={idx} className=\"text-xs flex items-center gap-2\">\r\n                                        <ExternalLink className=\"w-3 h-3 flex-shrink-0\" />\r\n                                        <span className=\"truncate\">\r\n                                            {match.source_title || match.source_url || `Source ${idx + 1}`}\r\n                                        </span>\r\n                                    </div>\r\n                                ))}\r\n                                {matches.length > 2 && (\r\n                                    <span className=\"text-xs opacity-75\">+{matches.length - 2} more</span>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n\r\n                        <Button\r\n                            size=\"sm\"\r\n                            variant=\"outline\"\r\n                            onClick={() => setShowModal(true)}\r\n                            className=\"mt-4 gap-1\"\r\n                        >\r\n                            <Eye className=\"w-3.5 h-3.5\" />\r\n                            View Matched Text\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <PlagiarismModal\r\n                isOpen={showModal}\r\n                onClose={() => setShowModal(false)}\r\n                score={score}\r\n                matches={matches}\r\n            />\r\n        </>\r\n    )\r\n}\r\n\r\ninterface PlagiarismModalProps {\r\n    isOpen: boolean\r\n    onClose: () => void\r\n    score: number\r\n    matches: PlagiarismMatch[]\r\n}\r\n\r\nfunction PlagiarismModal({ isOpen, onClose, score, matches }: PlagiarismModalProps) {\r\n    const percentScore = Math.round(score * 100)\r\n    const isHighRisk = score >= 0.7\r\n\r\n    return (\r\n        <Dialog open={isOpen} onOpenChange={onClose}>\r\n            <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col\">\r\n                <DialogHeader>\r\n                    <DialogTitle className=\"flex items-center gap-2\">\r\n                        <FileSearch className=\"w-5 h-5\" />\r\n                        Plagiarism Check Results\r\n                    </DialogTitle>\r\n                </DialogHeader>\r\n\r\n                <div className=\"space-y-6 overflow-y-auto flex-1 pr-2\">\r\n                    {/* Score Summary */}\r\n                    <div className={`p-4 rounded-xl ${isHighRisk\r\n                            ? 'bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800'\r\n                            : 'bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800'\r\n                        }`}>\r\n                        <div className=\"flex items-center justify-between mb-2\">\r\n                            <span className=\"font-medium text-sm\">Overall Similarity</span>\r\n                            <span className={`text-2xl font-bold ${isHighRisk ? 'text-red-600 dark:text-red-400' : 'text-yellow-600 dark:text-yellow-400'\r\n                                }`}>\r\n                                {percentScore}%\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"h-3 rounded-full bg-white/50 dark:bg-black/20 overflow-hidden\">\r\n                            <div\r\n                                className={`h-full rounded-full ${isHighRisk ? 'bg-red-500' : 'bg-yellow-500'}`}\r\n                                style={{ width: `${percentScore}%` }}\r\n                            />\r\n                        </div>\r\n                        <p className=\"text-xs mt-2 opacity-75\">\r\n                            {isHighRisk\r\n                                ? 'This content has significant overlap with existing sources. Review recommended.'\r\n                                : 'Some similarity detected. May require attribution or revision.'}\r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* Matched Sources */}\r\n                    <div>\r\n                        <h3 className=\"font-semibold text-sm mb-3\">Matched Sources ({matches.length})</h3>\r\n                        {matches.length === 0 ? (\r\n                            <p className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                                Detailed source information not available.\r\n                            </p>\r\n                        ) : (\r\n                            <div className=\"space-y-3\">\r\n                                {matches.map((match, idx) => (\r\n                                    <div\r\n                                        key={idx}\r\n                                        className=\"p-4 rounded-lg border border-gray-200 dark:border-dark-border bg-gray-50 dark:bg-dark-bg\"\r\n                                    >\r\n                                        <div className=\"flex items-start justify-between gap-3 mb-2\">\r\n                                            <h4 className=\"font-medium text-sm\">\r\n                                                {match.source_title || `Source ${idx + 1}`}\r\n                                            </h4>\r\n                                            {match.similarity !== undefined && (\r\n                                                <span className=\"text-xs px-2 py-0.5 rounded-full bg-gray-200 dark:bg-dark-surface\">\r\n                                                    {Math.round(match.similarity * 100)}% match\r\n                                                </span>\r\n                                            )}\r\n                                        </div>\r\n\r\n                                        {match.source_url && (\r\n                                            <a\r\n                                                href={match.source_url}\r\n                                                target=\"_blank\"\r\n                                                rel=\"noopener noreferrer\"\r\n                                                className=\"text-xs text-primary hover:underline flex items-center gap-1 mb-2\"\r\n                                            >\r\n                                                <ExternalLink className=\"w-3 h-3\" />\r\n                                                {match.source_url}\r\n                                            </a>\r\n                                        )}\r\n\r\n                                        {match.matched_text && (\r\n                                            <div className=\"mt-2 p-3 rounded bg-yellow-50 dark:bg-yellow-900/10 border-l-2 border-yellow-400\">\r\n                                                <span className=\"text-xs font-medium text-yellow-700 dark:text-yellow-400 block mb-1\">\r\n                                                    Matched Text:\r\n                                                </span>\r\n                                                <p className=\"text-sm text-text-light dark:text-dark-text-muted italic\">\r\n                                                    \"{match.matched_text}\"\r\n                                                </p>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Help Text */}\r\n                    <div className=\"p-4 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800\">\r\n                        <h4 className=\"font-medium text-sm text-blue-700 dark:text-blue-400 mb-1\">\r\n                            What should I do?\r\n                        </h4>\r\n                        <ul className=\"text-xs text-blue-600 dark:text-blue-300 space-y-1\">\r\n                            <li>ΓÇó Review the matched sections and add proper citations if needed</li>\r\n                            <li>ΓÇó Paraphrase or rewrite content that's too similar to sources</li>\r\n                            <li>ΓÇó If you believe this is a false positive, you can file an appeal</li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\PostAnalyticsDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\PostCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\PostHistoryButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\PostHistoryDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\PostMoreOptions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\PostSessionTracker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ProfileCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ProfileCompletionCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ProfileEditForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ProfileHeader.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":75,"column":21,"nodeType":"JSXOpeningElement","endLine":79,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar'\r\nimport { EditProfileDialog } from './EditProfileDialog'\r\nimport BadgeDisplay from './BadgeDisplay'\r\nimport ReputationScore from './ReputationScore'\r\nimport { UserLevelBadge } from './UserLevelBadge'\r\nimport { getTierFromLevel } from '@/lib/gamification'\r\nimport { MapPin, Link as LinkIcon, Building2, Calendar, Users, FileText, Quote, Zap } from 'lucide-react'\r\nimport { format } from 'date-fns'\r\nimport { FollowButton } from './FollowButton'\r\nimport { cn } from '@/lib/utils'\r\n\r\ninterface ProfileHeaderProps {\r\n    profile: any\r\n    stats: any\r\n    badges: any[]\r\n    isOwnProfile: boolean\r\n}\r\n\r\n// Simple animated stat with mini progress bar\r\nfunction StatItem({\r\n    icon: Icon,\r\n    value,\r\n    label,\r\n    maxValue = 100,\r\n    color = 'primary'\r\n}: {\r\n    icon: React.ElementType\r\n    value: number\r\n    label: string\r\n    maxValue?: number\r\n    color?: 'primary' | 'secondary' | 'accent'\r\n}) {\r\n    const percentage = Math.min((value / maxValue) * 100, 100)\r\n    const colorClasses = {\r\n        primary: 'bg-primary dark:bg-primary-light',\r\n        secondary: 'bg-secondary dark:bg-secondary-light',\r\n        accent: 'bg-accent dark:bg-accent-light'\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex-1 min-w-[100px]\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n                <Icon className=\"w-4 h-4 text-text-light dark:text-dark-text-muted\" />\r\n                <span className=\"text-2xl font-bold text-text dark:text-dark-text\">\r\n                    {value}\r\n                </span>\r\n            </div>\r\n            <div className=\"h-1.5 bg-gray-100 dark:bg-dark-border rounded-full overflow-hidden mb-1\">\r\n                <div\r\n                    className={cn(\"h-full rounded-full transition-all duration-700\", colorClasses[color])}\r\n                    style={{ width: `${percentage}%` }}\r\n                />\r\n            </div>\r\n            <span className=\"text-xs uppercase tracking-wider text-text-light dark:text-dark-text-muted\">\r\n                {label}\r\n            </span>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport function ProfileHeader({ profile, stats, badges, isOwnProfile }: ProfileHeaderProps) {\r\n    // Default cover gradient if no cover_image_url\r\n    const hasCoverImage = profile.cover_image_url\r\n\r\n    return (\r\n        <div className=\"bg-white dark:bg-dark-surface rounded-2xl border border-gray-200 dark:border-dark-border overflow-hidden mb-8\">\r\n            {/* Cover Image / Gradient Banner */}\r\n            <div\r\n                className={cn(\r\n                    \"relative h-48 md:h-56 w-full\",\r\n                    !hasCoverImage && \"bg-primary-dark\"\r\n                )}\r\n            >\r\n                {hasCoverImage && (\r\n                    <img\r\n                        src={profile.cover_image_url}\r\n                        alt=\"Profile cover\"\r\n                        className=\"w-full h-full object-cover\"\r\n                    />\r\n                )}\r\n                {/* Subtle overlay for text readability */}\r\n                <div className=\"absolute inset-0 bg-gradient-to-t from-black/30 to-transparent\" />\r\n            </div>\r\n\r\n            {/* Profile Content - Clean integrated design */}\r\n            <div className=\"relative z-10 px-6 md:px-8 pb-6 md:pb-8\">\r\n                {/* Avatar and info row */}\r\n                <div className=\"flex flex-col sm:flex-row gap-5 -mt-12 sm:-mt-16\">\r\n                    {/* Avatar */}\r\n                    <div className=\"relative flex-shrink-0\">\r\n                        <Avatar className=\"w-28 h-28 sm:w-32 sm:h-32 border-4 border-white dark:border-dark-surface shadow-xl bg-white dark:bg-dark-surface\">\r\n                            <AvatarImage src={profile.avatar_url} alt={profile.name} className=\"object-cover\" />\r\n                            <AvatarFallback className=\"text-3xl bg-primary text-white\">\r\n                                {profile.name?.[0]?.toUpperCase()}\r\n                            </AvatarFallback>\r\n                        </Avatar>\r\n                        {/* Online indicator */}\r\n                        <div className=\"absolute bottom-2 right-2 w-4 h-4 bg-green-500 border-2 border-white dark:border-dark-surface rounded-full\" />\r\n                    </div>\r\n\r\n                    {/* Name, role, badges - positioned below avatar on mobile, beside on desktop */}\r\n                    <div className=\"flex-1 pt-2 sm:pt-20\">\r\n                        <div className=\"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3\">\r\n                            {/* Name and badges */}\r\n                            <div>\r\n                                <div className=\"flex items-center gap-2 flex-wrap\">\r\n                                    <h1 className=\"text-2xl sm:text-3xl font-display font-bold text-gray-900 dark:text-white\">\r\n                                        {profile.name}\r\n                                    </h1>\r\n                                    {profile.level && profile.level > 0 && (\r\n                                        <UserLevelBadge\r\n                                            level={profile.level}\r\n                                            tier={getTierFromLevel(profile.level)}\r\n                                            name={profile.level_name}\r\n                                            size=\"sm\"\r\n                                        />\r\n                                    )}\r\n                                    {profile.reputation > 0 && (\r\n                                        <ReputationScore score={profile.reputation} size=\"md\" />\r\n                                    )}\r\n                                </div>\r\n                                {/* Role and XP inline */}\r\n                                <div className=\"flex items-center gap-2 mt-1.5\">\r\n                                    <span className=\"px-2.5 py-0.5 bg-primary/10 text-primary dark:text-white/50 dark:bg-primary/30 rounded-full text-xs font-semibold capitalize border border-primary/10 dark:border-primary/20\">\r\n                                        {profile.role === 'researcher' ? 'Researcher' : profile.role}\r\n                                    </span>\r\n                                    {profile.xp_points > 0 && (\r\n                                        <span className=\"flex items-center gap-1 text-xs text-yellow-600 dark:text-yellow-400 font-medium px-2 py-0.5 bg-yellow-400/10 rounded-full border border-yellow-400/10\">\r\n                                            <Zap className=\"w-3 h-3\" />\r\n                                            {profile.xp_points.toLocaleString()} XP\r\n                                        </span>\r\n                                    )}\r\n                                    <BadgeDisplay badges={badges} size=\"sm\" />\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Action button */}\r\n                            <div className=\"flex-shrink-0 mt-2 sm:mt-0\">\r\n                                {isOwnProfile ? (\r\n                                    <EditProfileDialog profile={profile} />\r\n                                ) : (\r\n                                    <FollowButton userId={profile.id} />\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Bio */}\r\n                {profile.bio && (\r\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-5 max-w-2xl leading-relaxed text-sm sm:text-base\">\r\n                        {profile.bio}\r\n                    </p>\r\n                )}\r\n\r\n                {/* Meta info row */}\r\n                <div className=\"flex flex-wrap gap-x-6 gap-y-2 text-sm text-gray-500 dark:text-gray-400 mt-4\">\r\n                    {profile.affiliation && (\r\n                        <div className=\"flex items-center gap-1.5\">\r\n                            <Building2 className=\"w-4 h-4\" />\r\n                            <span>{profile.affiliation}</span>\r\n                        </div>\r\n                    )}\r\n                    {profile.location && (\r\n                        <div className=\"flex items-center gap-1.5\">\r\n                            <MapPin className=\"w-4 h-4\" />\r\n                            <span>{profile.location}</span>\r\n                        </div>\r\n                    )}\r\n                    {profile.website && (\r\n                        <a\r\n                            href={profile.website}\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                            className=\"flex items-center gap-1.5 hover:text-primary transition-colors\"\r\n                        >\r\n                            <LinkIcon className=\"w-4 h-4\" />\r\n                            <span>Website</span>\r\n                        </a>\r\n                    )}\r\n                    <div className=\"flex items-center gap-1.5\">\r\n                        <Calendar className=\"w-4 h-4\" />\r\n                        <span>Joined {format(new Date(profile.created_at), 'MMMM yyyy')}</span>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Research Interests */}\r\n                {profile.research_interests && profile.research_interests.length > 0 && (\r\n                    <div className=\"flex flex-wrap gap-2 mt-4\">\r\n                        {profile.research_interests.map((interest: string) => (\r\n                            <span\r\n                                key={interest}\r\n                                className=\"px-3 py-1 bg-gray-100 dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-full text-sm text-gray-700 dark:text-gray-300 transition-colors\"\r\n                            >\r\n                                {interest}\r\n                            </span>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n\r\n                {/* Stats with visual bars - softened border */}\r\n                <div className=\"flex flex-wrap gap-6 sm:gap-10 mt-6 pt-5 border-t border-gray-100 dark:border-white/10 px-1\">\r\n                    <StatItem\r\n                        icon={FileText}\r\n                        value={stats?.post_count || 0}\r\n                        label=\"Posts\"\r\n                        maxValue={50}\r\n                        color=\"primary\"\r\n                    />\r\n                    <StatItem\r\n                        icon={Quote}\r\n                        value={stats?.citation_count || 0}\r\n                        label=\"Citations\"\r\n                        maxValue={100}\r\n                        color=\"secondary\"\r\n                    />\r\n                    <StatItem\r\n                        icon={Users}\r\n                        value={stats?.follower_count || stats?.group_count || 0}\r\n                        label=\"Followers\"\r\n                        maxValue={200}\r\n                        color=\"accent\"\r\n                    />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ProjectCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\QuestionCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ReadingInsights.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\RejectionBanner.tsx","messages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useEffect\" is called conditionally. React Hooks must be called in the exact same order in every component render. Did you accidentally call a React Hook after an early return?","line":60,"column":5,"nodeType":"Identifier","endLine":60,"endColumn":14}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { AlertTriangle, Send, Loader2, CheckCircle, Clock } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { useToast } from '@/components/ui/toast'\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from \"@/components/ui/dialog\"\r\nimport { Label } from \"@/components/ui/label\"\r\n\r\ninterface RejectionBannerProps {\r\n    postId: string\r\n    postTitle: string\r\n    rejectionReason: string | null\r\n    approvalStatus: string\r\n    isAuthor: boolean\r\n    contentType?: 'post' | 'article' | 'question' | 'event'\r\n}\r\n\r\ninterface Appeal {\r\n    id: string\r\n    status: 'pending' | 'approved' | 'rejected' | 'revision_requested'\r\n    dispute_reason: string\r\n    admin_response: string | null\r\n    created_at: string\r\n}\r\n\r\nexport function RejectionBanner({\r\n    postId,\r\n    postTitle,\r\n    rejectionReason,\r\n    approvalStatus,\r\n    isAuthor,\r\n    contentType = 'post'\r\n}: RejectionBannerProps) {\r\n    const [appealDialogOpen, setAppealDialogOpen] = useState(false)\r\n    const [appealReason, setAppealReason] = useState('')\r\n    const [submitting, setSubmitting] = useState(false)\r\n    const [existingAppeal, setExistingAppeal] = useState<Appeal | null>(null)\r\n    const [appealCount, setAppealCount] = useState(0)\r\n    const [loading, setLoading] = useState(true)\r\n\r\n    const MAX_APPEALS = 3\r\n    const supabase = createClient()\r\n    const { showToast } = useToast()\r\n\r\n    // Only render for rejected posts and for the author\r\n    if (approvalStatus !== 'rejected' || !isAuthor) {\r\n        return null\r\n    }\r\n\r\n    // Fetch existing appeal and count on mount\r\n    useEffect(() => {\r\n        const fetchAppealData = async () => {\r\n            // Get most recent appeal\r\n            const { data, error } = await supabase\r\n                .from('moderation_appeals')\r\n                .select('id, status, dispute_reason, admin_response, created_at')\r\n                .eq('post_id', postId)\r\n                .order('created_at', { ascending: false })\r\n                .limit(1)\r\n                .single()\r\n\r\n            console.log('RejectionBanner - Appeal fetch:', { postId, data, error })\r\n            setExistingAppeal(data)\r\n\r\n            // Get total appeal count for this post\r\n            const { count } = await supabase\r\n                .from('moderation_appeals')\r\n                .select('*', { count: 'exact', head: true })\r\n                .eq('post_id', postId)\r\n\r\n            setAppealCount(count || 0)\r\n            setLoading(false)\r\n        }\r\n        fetchAppealData()\r\n    }, [postId, supabase])\r\n\r\n    const handleSubmitAppeal = async () => {\r\n        if (appealCount >= MAX_APPEALS) {\r\n            showToast('You have reached the maximum number of appeals for this content.', 'error')\r\n            return\r\n        }\r\n\r\n        if (!appealReason.trim()) {\r\n            showToast('Please provide a reason for your appeal.', 'error')\r\n            return\r\n        }\r\n\r\n        setSubmitting(true)\r\n        try {\r\n            const { data: { user } } = await supabase.auth.getUser()\r\n            if (!user) throw new Error('Not authenticated')\r\n\r\n            const { error } = await supabase\r\n                .from('moderation_appeals')\r\n                .insert({\r\n                    post_id: postId,\r\n                    user_id: user.id,\r\n                    dispute_reason: appealReason.trim()\r\n                })\r\n\r\n            if (error) {\r\n                console.error('Appeal insert error:', error.message, error.code, error.details)\r\n                throw new Error(error.message || 'Failed to insert appeal')\r\n            }\r\n\r\n            showToast('Your appeal has been submitted. You will be notified when it\\'s reviewed.', 'success')\r\n            setAppealDialogOpen(false)\r\n            setAppealReason('')\r\n\r\n            // Refresh appeal status\r\n            const { data } = await supabase\r\n                .from('moderation_appeals')\r\n                .select('id, status, dispute_reason, admin_response, created_at')\r\n                .eq('post_id', postId)\r\n                .order('created_at', { ascending: false })\r\n                .limit(1)\r\n                .single()\r\n            setExistingAppeal(data)\r\n        } catch (error: any) {\r\n            console.error('Error submitting appeal:', error.message || error)\r\n            showToast(error.message || 'Failed to submit appeal. Please try again.', 'error')\r\n        } finally {\r\n            setSubmitting(false)\r\n        }\r\n    }\r\n\r\n    const getAppealStatusBadge = (status: string) => {\r\n        const badges = {\r\n            pending: { icon: Clock, className: 'text-yellow-600 bg-yellow-100 dark:bg-yellow-900/30', label: 'Under Review' },\r\n            approved: { icon: CheckCircle, className: 'text-green-600 bg-green-100 dark:bg-green-900/30', label: 'Approved' },\r\n            rejected: { icon: AlertTriangle, className: 'text-red-600 bg-red-100 dark:bg-red-900/30', label: 'Denied' },\r\n            revision_requested: { icon: AlertTriangle, className: 'text-blue-600 bg-blue-100 dark:bg-blue-900/30', label: 'Changes Required' }\r\n        }\r\n        const badge = badges[status as keyof typeof badges] || badges.pending\r\n        const Icon = badge.icon\r\n        return (\r\n            <span className={`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-sm font-medium ${badge.className}`}>\r\n                <Icon className=\"w-4 h-4\" />\r\n                {badge.label}\r\n            </span>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-5 mb-6\">\r\n                <div className=\"flex items-start gap-4\">\r\n                    <div className=\"flex-shrink-0 p-2 bg-red-100 dark:bg-red-900/40 rounded-lg\">\r\n                        <AlertTriangle className=\"w-6 h-6 text-red-600 dark:text-red-400\" />\r\n                    </div>\r\n                    <div className=\"flex-1 min-w-0\">\r\n                        <h3 className=\"text-lg font-semibold text-red-900 dark:text-red-200 mb-1\">\r\n                            This post has been rejected\r\n                        </h3>\r\n                        {rejectionReason && (\r\n                            <p className=\"text-red-700 dark:text-red-300 mb-4\">\r\n                                <strong>Reason:</strong> {rejectionReason}\r\n                            </p>\r\n                        )}\r\n\r\n                        {/* Appeal Status */}\r\n                        {loading ? (\r\n                            <div className=\"flex items-center gap-2 text-sm text-red-600 dark:text-red-400\">\r\n                                <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                                Checking appeal status...\r\n                            </div>\r\n                        ) : existingAppeal && existingAppeal.status !== 'approved' ? (\r\n                            // Show appeal status only if pending or rejected (not approved, as that's from a previous cycle)\r\n                            <div className=\"bg-white dark:bg-dark-surface border border-red-200 dark:border-dark-border rounded-lg p-4 space-y-3\">\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <span className=\"text-sm font-medium text-text dark:text-dark-text\">Appeal Status</span>\r\n                                    {getAppealStatusBadge(existingAppeal.status)}\r\n                                </div>\r\n                                <p className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                                    <strong>Your appeal:</strong> {existingAppeal.dispute_reason}\r\n                                </p>\r\n                                {existingAppeal.admin_response && (\r\n                                    <p className=\"text-sm text-text-light dark:text-dark-text-muted border-t border-gray-100 dark:border-dark-border pt-3\">\r\n                                        <strong>Admin response:</strong> {existingAppeal.admin_response}\r\n                                    </p>\r\n                                )}\r\n                                {existingAppeal.status === 'rejected' && (\r\n                                    appealCount >= MAX_APPEALS ? (\r\n                                        <p className=\"text-sm text-red-600 dark:text-red-400 mt-2\">\r\n                                            You have used all {MAX_APPEALS} appeals for this content.\r\n                                        </p>\r\n                                    ) : (\r\n                                        <div className=\"flex items-center gap-3 mt-2\">\r\n                                            <Button\r\n                                                onClick={() => setAppealDialogOpen(true)}\r\n                                                variant=\"outline\"\r\n                                                size=\"sm\"\r\n                                                className=\"border-red-300 dark:border-red-700 text-red-700 dark:text-red-300 hover:bg-red-100 dark:hover:bg-red-900/30\"\r\n                                            >\r\n                                                <Send className=\"w-4 h-4 mr-2\" />\r\n                                                Submit New Appeal\r\n                                            </Button>\r\n                                            <span className=\"text-xs text-text-light dark:text-dark-text-muted\">\r\n                                                {MAX_APPEALS - appealCount} appeal{MAX_APPEALS - appealCount !== 1 ? 's' : ''} remaining\r\n                                            </span>\r\n                                        </div>\r\n                                    )\r\n                                )}\r\n                                {existingAppeal.status === 'revision_requested' && (\r\n                                    <div className=\"flex items-center gap-3 mt-2\">\r\n                                        <a\r\n                                            href={contentType === 'event' ? `/events/${postId}/edit` : `/editor?edit=${postId}`}\r\n                                            className=\"inline-flex items-center px-4 py-2 rounded-lg text-sm font-medium bg-blue-600 hover:bg-blue-700 text-white transition-colors\"\r\n                                        >\r\n                                            Edit {contentType === 'event' ? 'Event' : 'Post'}\r\n                                        </a>\r\n                                        <span className=\"text-xs text-text-light dark:text-dark-text-muted\">\r\n                                            Make the requested changes and resubmit\r\n                                        </span>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        ) : (\r\n                            // No relevant appeal (new rejection or previous appeal was approved before re-rejection)\r\n                            appealCount >= MAX_APPEALS ? (\r\n                                <p className=\"text-sm text-red-600 dark:text-red-400\">\r\n                                    You have used all {MAX_APPEALS} appeals for this content.\r\n                                </p>\r\n                            ) : (\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <Button\r\n                                        onClick={() => setAppealDialogOpen(true)}\r\n                                        variant=\"outline\"\r\n                                        className=\"border-red-300 dark:border-red-700 text-red-700 dark:text-red-300 hover:bg-red-100 dark:hover:bg-red-900/30\"\r\n                                    >\r\n                                        <Send className=\"w-4 h-4 mr-2\" />\r\n                                        Submit an Appeal\r\n                                    </Button>\r\n                                    <span className=\"text-xs text-text-light dark:text-dark-text-muted\">\r\n                                        {MAX_APPEALS - appealCount} appeal{MAX_APPEALS - appealCount !== 1 ? 's' : ''} remaining\r\n                                    </span>\r\n                                </div>\r\n                            )\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Appeal Dialog */}\r\n            <Dialog open={appealDialogOpen} onOpenChange={setAppealDialogOpen}>\r\n                <DialogContent>\r\n                    <DialogHeader>\r\n                        <DialogTitle>Appeal Rejection</DialogTitle>\r\n                        <DialogDescription>\r\n                            Explain why you believe &quot;{postTitle}&quot; should not have been rejected.\r\n                            Your appeal will be reviewed by our moderation team.\r\n                        </DialogDescription>\r\n                    </DialogHeader>\r\n                    <div className=\"space-y-4 py-4\">\r\n                        {rejectionReason && (\r\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3\">\r\n                                <p className=\"text-sm text-red-700 dark:text-red-300\">\r\n                                    <strong>Rejection reason:</strong> {rejectionReason}\r\n                                </p>\r\n                            </div>\r\n                        )}\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"appeal-reason\" className=\"text-text dark:text-dark-text font-medium\">\r\n                                Your Appeal <span className=\"text-red-500\">*</span>\r\n                            </Label>\r\n                            <textarea\r\n                                id=\"appeal-reason\"\r\n                                value={appealReason}\r\n                                onChange={(e) => setAppealReason(e.target.value)}\r\n                                placeholder=\"Explain why this rejection should be reconsidered...\"\r\n                                rows={5}\r\n                                className=\"w-full px-3 py-2 rounded-lg border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text placeholder:text-text-light dark:placeholder:text-dark-text-muted focus:outline-none focus:ring-2 focus:ring-primary resize-none\"\r\n                            />\r\n                            <p className=\"text-xs text-text-light dark:text-dark-text-muted\">\r\n                                Be specific and respectful. Provide any context that supports your case.\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                    <DialogFooter className=\"gap-2 sm:gap-0\">\r\n                        <Button variant=\"outline\" onClick={() => setAppealDialogOpen(false)} disabled={submitting}>\r\n                            Cancel\r\n                        </Button>\r\n                        <Button\r\n                            onClick={handleSubmitAppeal}\r\n                            disabled={submitting || !appealReason.trim()}\r\n                        >\r\n                            {submitting ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : <Send className=\"w-4 h-4 mr-2\" />}\r\n                            Submit Appeal\r\n                        </Button>\r\n                    </DialogFooter>\r\n                </DialogContent>\r\n            </Dialog>\r\n        </>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\RelatedAuthors.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\RelatedPosts.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ReportButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ReputationScore.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ResourceCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ResourceFilters.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'filters.search' and 'updateFilters'. Either include them or remove the dependency array.","line":106,"column":8,"nodeType":"ArrayExpression","endLine":106,"endColumn":21,"suggestions":[{"desc":"Update the dependencies array to be: [filters.search, searchInput, updateFilters]","fix":{"range":[3797,3810],"text":"[filters.search, searchInput, updateFilters]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { useRouter, useSearchParams } from 'next/navigation'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { Search, Filter, X, ChevronDown, Database, FileText, Wrench, Film, FileSpreadsheet } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface ResourceFiltersProps {\r\n    onFiltersChange?: (filters: FilterState) => void\r\n    className?: string\r\n}\r\n\r\nexport interface FilterState {\r\n    type: string | null\r\n    discipline: string | null\r\n    license: string | null\r\n    search: string\r\n    sort: string\r\n}\r\n\r\nconst RESOURCE_TYPES = [\r\n    { value: 'dataset', Icon: Database },\r\n    { value: 'paper', Icon: FileText },\r\n    { value: 'tool', Icon: Wrench },\r\n    { value: 'media', Icon: Film },\r\n    { value: 'template', Icon: FileSpreadsheet },\r\n]\r\n\r\nconst LICENSES = [\r\n    { value: 'CC-BY-4.0', label: 'CC BY 4.0' },\r\n    { value: 'CC-BY-SA-4.0', label: 'CC BY-SA 4.0' },\r\n    { value: 'CC-BY-NC-4.0', label: 'CC BY-NC 4.0' },\r\n    { value: 'CC0-1.0', label: 'CC0 (Public Domain)' },\r\n    { value: 'MIT', label: 'MIT License' },\r\n    { value: 'Apache-2.0', label: 'Apache 2.0' },\r\n    { value: 'Copyright', label: 'All Rights Reserved' },\r\n]\r\n\r\nconst SORT_OPTIONS = [\r\n    { value: 'date', key: 'sortNewest' },\r\n    { value: 'downloads', key: 'sortDownloads' },\r\n    { value: 'title', key: 'sortTitle' },\r\n]\r\n\r\nexport function ResourceFilters({ onFiltersChange, className = '' }: ResourceFiltersProps) {\r\n    const t = useTranslations('Resources')\r\n    const router = useRouter()\r\n    const searchParams = useSearchParams()\r\n    const supabase = createClient()\r\n\r\n    const [disciplines, setDisciplines] = useState<{ discipline: string; resource_count: number }[]>([])\r\n    const [isExpanded, setIsExpanded] = useState(false)\r\n    const [searchInput, setSearchInput] = useState(searchParams.get('q') || '')\r\n\r\n    // Initialize filters from URL\r\n    const [filters, setFilters] = useState<FilterState>({\r\n        type: searchParams.get('type'),\r\n        discipline: searchParams.get('discipline'),\r\n        license: searchParams.get('license'),\r\n        search: searchParams.get('q') || '',\r\n        sort: searchParams.get('sort') || 'date',\r\n    })\r\n\r\n    // Fetch available disciplines\r\n    useEffect(() => {\r\n        async function fetchDisciplines() {\r\n            const { data } = await supabase.rpc('get_resource_disciplines')\r\n            if (data) {\r\n                setDisciplines(data)\r\n            }\r\n        }\r\n        fetchDisciplines()\r\n    }, [supabase])\r\n\r\n    // Update URL when filters change\r\n    const updateFilters = (newFilters: Partial<FilterState>) => {\r\n        const updated = { ...filters, ...newFilters }\r\n        setFilters(updated)\r\n\r\n        // Build URL params\r\n        const params = new URLSearchParams()\r\n        if (updated.type) params.set('type', updated.type)\r\n        if (updated.discipline) params.set('discipline', updated.discipline)\r\n        if (updated.license) params.set('license', updated.license)\r\n        if (updated.search) params.set('q', updated.search)\r\n        if (updated.sort && updated.sort !== 'date') params.set('sort', updated.sort)\r\n\r\n        const queryString = params.toString()\r\n        router.push(queryString ? `?${queryString}` : '?', { scroll: false })\r\n\r\n        onFiltersChange?.(updated)\r\n    }\r\n\r\n    // Debounced search\r\n    useEffect(() => {\r\n        const timer = setTimeout(() => {\r\n            if (searchInput !== filters.search) {\r\n                updateFilters({ search: searchInput })\r\n            }\r\n        }, 300)\r\n        return () => clearTimeout(timer)\r\n    }, [searchInput])\r\n\r\n    const clearFilters = () => {\r\n        setSearchInput('')\r\n        setFilters({\r\n            type: null,\r\n            discipline: null,\r\n            license: null,\r\n            search: '',\r\n            sort: 'date',\r\n        })\r\n        router.push('?', { scroll: false })\r\n        onFiltersChange?.({\r\n            type: null,\r\n            discipline: null,\r\n            license: null,\r\n            search: '',\r\n            sort: 'date',\r\n        })\r\n    }\r\n\r\n    const activeFilterCount = [\r\n        filters.type,\r\n        filters.discipline,\r\n        filters.license,\r\n        filters.search,\r\n    ].filter(Boolean).length\r\n\r\n    return (\r\n        <div className={`bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-4 ${className}`}>\r\n            {/* Search Bar */}\r\n            <div className=\"relative mb-4\">\r\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-text-light dark:text-dark-text-muted\" />\r\n                <Input\r\n                    type=\"text\"\r\n                    placeholder={t('searchPlaceholder')}\r\n                    value={searchInput}\r\n                    onChange={(e) => setSearchInput(e.target.value)}\r\n                    className=\"pl-10\"\r\n                />\r\n            </div>\r\n\r\n            {/* Quick Filter Toggle */}\r\n            <button\r\n                onClick={() => setIsExpanded(!isExpanded)}\r\n                className=\"flex items-center justify-between w-full text-sm font-medium text-text dark:text-dark-text mb-2\"\r\n            >\r\n                <span className=\"flex items-center gap-2\">\r\n                    <Filter className=\"w-4 h-4\" />\r\n                    {t('filters')}\r\n                    {activeFilterCount > 0 && (\r\n                        <span className=\"px-2 py-0.5 bg-primary/10 text-primary text-xs rounded-full\">\r\n                            {activeFilterCount}\r\n                        </span>\r\n                    )}\r\n                </span>\r\n                <ChevronDown className={`w-4 h-4 transition-transform ${isExpanded ? 'rotate-180' : ''}`} />\r\n            </button>\r\n\r\n            {/* Expanded Filters */}\r\n            {isExpanded && (\r\n                <div className=\"space-y-4 pt-4 border-t border-gray-100 dark:border-dark-border\">\r\n                    {/* Resource Type */}\r\n                    <div>\r\n                        <Label className=\"text-xs text-text-light dark:text-dark-text-muted mb-2 block\">\r\n                            {t('resourceType')}\r\n                        </Label>\r\n                        <div className=\"flex flex-wrap gap-2\">\r\n                            {RESOURCE_TYPES.map((type) => {\r\n                                const Icon = type.Icon\r\n                                return (\r\n                                    <button\r\n                                        key={type.value}\r\n                                        onClick={() => updateFilters({\r\n                                            type: filters.type === type.value ? null : type.value\r\n                                        })}\r\n                                        className={`px-3 py-1.5 text-sm rounded-lg border transition-colors flex items-center gap-1.5 ${filters.type === type.value\r\n                                            ? 'bg-primary text-white border-primary'\r\n                                            : 'bg-white dark:bg-dark-bg border-gray-300 dark:border-dark-border text-gray-700 dark:text-gray-200 hover:border-primary/50 hover:bg-gray-50 dark:hover:bg-dark-surface'\r\n                                            }`}\r\n                                    >\r\n                                        <Icon className=\"w-3.5 h-3.5\" />\r\n                                        {t(`types.${type.value}`)}\r\n                                    </button>\r\n                                )\r\n                            })}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Discipline */}\r\n                    {disciplines.length > 0 && (\r\n                        <div>\r\n                            <Label className=\"text-xs text-text-light dark:text-dark-text-muted mb-2 block\">\r\n                                {t('discipline')}\r\n                            </Label>\r\n                            <div className=\"flex flex-wrap gap-2\">\r\n                                {disciplines.map((d) => (\r\n                                    <button\r\n                                        key={d.discipline}\r\n                                        onClick={() => updateFilters({\r\n                                            discipline: filters.discipline === d.discipline ? null : d.discipline\r\n                                        })}\r\n                                        className={`px-3 py-1.5 text-sm rounded-lg border transition-colors ${filters.discipline === d.discipline\r\n                                            ? 'bg-primary text-white border-primary'\r\n                                            : 'bg-white dark:bg-dark-bg border-gray-300 dark:border-dark-border text-gray-700 dark:text-gray-200 hover:border-primary/50 hover:bg-gray-50 dark:hover:bg-dark-surface'\r\n                                            }`}\r\n                                    >\r\n                                        {d.discipline}\r\n                                        <span className=\"ml-1.5 text-xs opacity-70\">({d.resource_count})</span>\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* License */}\r\n                    <div>\r\n                        <Label className=\"text-xs text-text-light dark:text-dark-text-muted mb-2 block\">\r\n                            {t('license')}\r\n                        </Label>\r\n                        <select\r\n                            value={filters.license || ''}\r\n                            onChange={(e) => updateFilters({ license: e.target.value || null })}\r\n                            className=\"w-full h-10 rounded-md border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-surface px-3 text-sm text-text dark:text-dark-text\"\r\n                        >\r\n                            <option value=\"\">{t('allLicenses')}</option>\r\n                            {LICENSES.map((license) => (\r\n                                <option key={license.value} value={license.value}>\r\n                                    {license.label}\r\n                                </option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n\r\n                    {/* Sort */}\r\n                    <div>\r\n                        <Label className=\"text-xs text-text-light dark:text-dark-text-muted mb-2 block\">\r\n                            {t('sortBy')}\r\n                        </Label>\r\n                        <select\r\n                            value={filters.sort}\r\n                            onChange={(e) => updateFilters({ sort: e.target.value })}\r\n                            className=\"w-full h-10 rounded-md border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-surface px-3 text-sm text-text dark:text-dark-text\"\r\n                        >\r\n                            {SORT_OPTIONS.map((option) => (\r\n                                <option key={option.value} value={option.value}>\r\n                                    {t(option.key)}\r\n                                </option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n\r\n                    {/* Clear Filters */}\r\n                    {activeFilterCount > 0 && (\r\n                        <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={clearFilters}\r\n                            className=\"w-full\"\r\n                        >\r\n                            <X className=\"w-4 h-4 mr-2\" />\r\n                            {t('clearFilters')}\r\n                        </Button>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ResourceLinker.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":390,"column":59,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[17408,17432],"text":"No resources found for &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[17408,17432],"text":"No resources found for &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[17408,17432],"text":"No resources found for &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[17408,17432],"text":"No resources found for &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":390,"column":73,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[17445,17446],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[17445,17446],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[17445,17446],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[17445,17446],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useCallback, useEffect, useRef } from 'react'\r\nimport { Search, X, Link2, FileText, Database, FileType, Wrench, Film, FileSpreadsheet, Plus, Loader2, Upload, UploadCloud } from 'lucide-react'\r\nimport { createClient } from '@/lib/supabase/client'\r\n\r\ninterface ResourceMetadata {\r\n    url?: string\r\n    size?: number\r\n    mime_type?: string\r\n    original_name?: string\r\n    downloads?: number\r\n    license?: string\r\n    resource_type?: 'dataset' | 'paper' | 'tool' | 'media' | 'template'\r\n}\r\n\r\ninterface Resource {\r\n    id: string\r\n    title: string\r\n    content?: string\r\n    created_at: string\r\n    metadata: ResourceMetadata\r\n    tags?: string[]\r\n    author?: { name?: string | null; email?: string | null } | null\r\n}\r\n\r\ninterface ResourceLinkerProps {\r\n    selectedResources: Resource[]\r\n    onChange: (resources: Resource[]) => void\r\n    maxResources?: number\r\n    userId?: string\r\n}\r\n\r\nconst RESOURCE_TYPES = [\r\n    { value: 'dataset', label: 'Dataset', icon: Database },\r\n    { value: 'paper', label: 'Paper/Report', icon: FileType },\r\n    { value: 'tool', label: 'Tool/Software', icon: Wrench },\r\n    { value: 'media', label: 'Media', icon: Film },\r\n    { value: 'template', label: 'Template', icon: FileSpreadsheet },\r\n]\r\n\r\nconst RESOURCE_TYPE_ICONS = {\r\n    dataset: Database,\r\n    paper: FileType,\r\n    tool: Wrench,\r\n    media: Film,\r\n    template: FileSpreadsheet,\r\n}\r\n\r\nconst RESOURCE_TYPE_COLORS = {\r\n    dataset: 'bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400',\r\n    paper: 'bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400',\r\n    tool: 'bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400',\r\n    media: 'bg-pink-100 text-pink-700 dark:bg-pink-900/30 dark:text-pink-400',\r\n    template: 'bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400',\r\n}\r\n\r\nexport function ResourceLinker({\r\n    selectedResources,\r\n    onChange,\r\n    maxResources = 10,\r\n    userId,\r\n}: ResourceLinkerProps) {\r\n    const [isOpen, setIsOpen] = useState(false)\r\n    const [searchQuery, setSearchQuery] = useState('')\r\n    const [searchResults, setSearchResults] = useState<Resource[]>([])\r\n    const [isSearching, setIsSearching] = useState(false)\r\n    const [error, setError] = useState<string | null>(null)\r\n    const searchInputRef = useRef<HTMLInputElement>(null)\r\n    const dropdownRef = useRef<HTMLDivElement>(null)\r\n\r\n    // Quick Upload Modal State\r\n    const [showUploadModal, setShowUploadModal] = useState(false)\r\n    const [uploadFile, setUploadFile] = useState<File | null>(null)\r\n    const [uploadTitle, setUploadTitle] = useState('')\r\n    const [uploadDescription, setUploadDescription] = useState('')\r\n    const [uploadResourceType, setUploadResourceType] = useState<string>('paper')\r\n    const [isUploading, setIsUploading] = useState(false)\r\n\r\n    const supabase = createClient()\r\n\r\n    // Debounced search\r\n    useEffect(() => {\r\n        if (!searchQuery.trim()) {\r\n            setSearchResults([])\r\n            return\r\n        }\r\n\r\n        const controller = new AbortController()\r\n        const timeoutId = setTimeout(async () => {\r\n            setIsSearching(true)\r\n            setError(null)\r\n\r\n            try {\r\n                const response = await fetch(\r\n                    `/api/resources/search?q=${encodeURIComponent(searchQuery)}&limit=10`,\r\n                    { signal: controller.signal }\r\n                )\r\n\r\n                if (!response.ok) {\r\n                    throw new Error('Failed to search resources')\r\n                }\r\n\r\n                const data = await response.json()\r\n                // Filter out already selected resources\r\n                const filtered = data.resources.filter(\r\n                    (r: Resource) => !selectedResources.some(sr => sr.id === r.id)\r\n                )\r\n                setSearchResults(filtered)\r\n            } catch (err) {\r\n                if ((err as Error).name !== 'AbortError') {\r\n                    setError('Failed to search resources')\r\n                    console.error('Resource search error:', err)\r\n                }\r\n            } finally {\r\n                setIsSearching(false)\r\n            }\r\n        }, 300)\r\n\r\n        return () => {\r\n            clearTimeout(timeoutId)\r\n            controller.abort()\r\n        }\r\n    }, [searchQuery, selectedResources])\r\n\r\n    // Close dropdown on outside click\r\n    useEffect(() => {\r\n        const handleClickOutside = (event: MouseEvent) => {\r\n            if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\r\n                setIsOpen(false)\r\n            }\r\n        }\r\n\r\n        document.addEventListener('mousedown', handleClickOutside)\r\n        return () => document.removeEventListener('mousedown', handleClickOutside)\r\n    }, [])\r\n\r\n    const handleAddResource = useCallback(\r\n        (resource: Resource) => {\r\n            if (selectedResources.length >= maxResources) {\r\n                setError(`Maximum ${maxResources} resources allowed`)\r\n                return\r\n            }\r\n            onChange([...selectedResources, resource])\r\n            setSearchQuery('')\r\n            setSearchResults([])\r\n            setIsOpen(false)\r\n        },\r\n        [selectedResources, onChange, maxResources]\r\n    )\r\n\r\n    const handleRemoveResource = useCallback(\r\n        (resourceId: string) => {\r\n            onChange(selectedResources.filter(r => r.id !== resourceId))\r\n        },\r\n        [selectedResources, onChange]\r\n    )\r\n\r\n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        if (e.target.files && e.target.files[0]) {\r\n            const file = e.target.files[0]\r\n            setUploadFile(file)\r\n            // Auto-fill title from filename if empty\r\n            if (!uploadTitle) {\r\n                setUploadTitle(file.name.replace(/\\.[^/.]+$/, ''))\r\n            }\r\n        }\r\n    }\r\n\r\n    const handleQuickUpload = async () => {\r\n        if (!uploadFile || !uploadTitle.trim() || !userId) {\r\n            setError('Please fill in all required fields')\r\n            return\r\n        }\r\n\r\n        setIsUploading(true)\r\n        setError(null)\r\n\r\n        try {\r\n            // 1. Upload file to storage\r\n            const fileExt = uploadFile.name.split('.').pop()\r\n            const fileName = `${Math.random().toString(36).substring(2)}.${fileExt}`\r\n            const filePath = `${userId}/${fileName}`\r\n\r\n            const { error: uploadError } = await supabase.storage\r\n                .from('resources')\r\n                .upload(filePath, uploadFile)\r\n\r\n            if (uploadError) throw uploadError\r\n\r\n            const { data: { publicUrl } } = supabase.storage\r\n                .from('resources')\r\n                .getPublicUrl(filePath)\r\n\r\n            // 2. Create resource post\r\n            const { data, error: postError } = await supabase\r\n                .from('posts')\r\n                .insert({\r\n                    title: uploadTitle.trim(),\r\n                    content: uploadDescription.trim() || `Resource: ${uploadTitle}`,\r\n                    tags: [],\r\n                    content_type: 'resource',\r\n                    author_id: userId,\r\n                    status: 'published',\r\n                    metadata: {\r\n                        url: publicUrl,\r\n                        size: uploadFile.size,\r\n                        mime_type: uploadFile.type,\r\n                        original_name: uploadFile.name,\r\n                        downloads: 0,\r\n                        license: 'CC-BY-4.0',\r\n                        resource_type: uploadResourceType\r\n                    }\r\n                })\r\n                .select('id, title, content, created_at, metadata')\r\n                .single()\r\n\r\n            if (postError) throw postError\r\n\r\n            // 3. Add to selected resources\r\n            const newResource: Resource = {\r\n                id: data.id,\r\n                title: data.title,\r\n                content: data.content,\r\n                created_at: data.created_at,\r\n                metadata: data.metadata as ResourceMetadata\r\n            }\r\n            handleAddResource(newResource)\r\n\r\n            // 4. Reset upload form\r\n            setShowUploadModal(false)\r\n            setUploadFile(null)\r\n            setUploadTitle('')\r\n            setUploadDescription('')\r\n            setUploadResourceType('paper')\r\n        } catch (err) {\r\n            console.error('Upload error:', err)\r\n            setError('Failed to upload resource. Please try again.')\r\n        } finally {\r\n            setIsUploading(false)\r\n        }\r\n    }\r\n\r\n    const getResourceIcon = (resourceType?: string) => {\r\n        const IconComponent = resourceType\r\n            ? RESOURCE_TYPE_ICONS[resourceType as keyof typeof RESOURCE_TYPE_ICONS]\r\n            : FileText\r\n        return IconComponent || FileText\r\n    }\r\n\r\n    const getResourceColor = (resourceType?: string) => {\r\n        return resourceType\r\n            ? RESOURCE_TYPE_COLORS[resourceType as keyof typeof RESOURCE_TYPE_COLORS]\r\n            : 'bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300'\r\n    }\r\n\r\n    const formatSize = (bytes?: number) => {\r\n        if (!bytes) return ''\r\n        const k = 1024\r\n        const sizes = ['B', 'KB', 'MB', 'GB']\r\n        const i = Math.floor(Math.log(bytes) / Math.log(k))\r\n        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i]\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <label className=\"text-sm font-semibold text-text dark:text-dark-text flex items-center gap-2\">\r\n                    <Link2 className=\"w-4 h-4\" />\r\n                    Linked Resources\r\n                </label>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <span className=\"text-xs text-text-muted dark:text-dark-text-muted\">\r\n                        {selectedResources.length}/{maxResources}\r\n                    </span>\r\n                    {userId && (\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={() => setShowUploadModal(true)}\r\n                            className=\"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-semibold text-primary bg-primary/10 border border-primary/30 hover:bg-primary/20 hover:border-primary/50 rounded-lg transition-all\"\r\n                        >\r\n                            <Upload className=\"w-3.5 h-3.5\" />\r\n                            Upload New\r\n                        </button>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Selected Resources */}\r\n            {selectedResources.length > 0 && (\r\n                <div className=\"space-y-2\">\r\n                    {selectedResources.map(resource => {\r\n                        const Icon = getResourceIcon(resource.metadata?.resource_type)\r\n                        const colorClass = getResourceColor(resource.metadata?.resource_type)\r\n\r\n                        return (\r\n                            <div\r\n                                key={resource.id}\r\n                                className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-dark-surface-hover rounded-xl border border-gray-200 dark:border-dark-border group\"\r\n                            >\r\n                                <div className={`w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 ${colorClass}`}>\r\n                                    <Icon className=\"w-5 h-5\" />\r\n                                </div>\r\n                                <div className=\"flex-1 min-w-0\">\r\n                                    <h4 className=\"font-medium text-text dark:text-dark-text truncate text-sm\">\r\n                                        {resource.title}\r\n                                    </h4>\r\n                                    <div className=\"flex items-center gap-2 text-xs text-text-muted dark:text-dark-text-muted\">\r\n                                        {resource.metadata?.resource_type && (\r\n                                            <span className=\"capitalize\">{resource.metadata.resource_type}</span>\r\n                                        )}\r\n                                        {resource.metadata?.size && (\r\n                                            <>\r\n                                                <span>ΓÇó</span>\r\n                                                <span>{formatSize(resource.metadata.size)}</span>\r\n                                            </>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={() => handleRemoveResource(resource.id)}\r\n                                    className=\"p-1.5 rounded-lg text-text-muted hover:text-accent hover:bg-accent/10 transition-colors opacity-0 group-hover:opacity-100\"\r\n                                    aria-label={`Remove ${resource.title}`}\r\n                                >\r\n                                    <X className=\"w-4 h-4\" />\r\n                                </button>\r\n                            </div>\r\n                        )\r\n                    })}\r\n                </div>\r\n            )}\r\n\r\n            {/* Search Input & Dropdown */}\r\n            <div ref={dropdownRef} className=\"relative\">\r\n                <div className=\"relative\">\r\n                    <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted dark:text-dark-text-muted\" />\r\n                    <input\r\n                        ref={searchInputRef}\r\n                        type=\"text\"\r\n                        placeholder=\"Search existing resources...\"\r\n                        value={searchQuery}\r\n                        onChange={e => {\r\n                            setSearchQuery(e.target.value)\r\n                            setIsOpen(true)\r\n                        }}\r\n                        onFocus={() => setIsOpen(true)}\r\n                        className=\"w-full pl-10 pr-4 py-3 text-sm rounded-xl border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-surface text-text dark:text-dark-text placeholder:text-text-muted focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all\"\r\n                    />\r\n                    {isSearching && (\r\n                        <Loader2 className=\"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-primary animate-spin\" />\r\n                    )}\r\n                </div>\r\n\r\n                {/* Search Results Dropdown */}\r\n                {isOpen && (searchResults.length > 0 || searchQuery.trim()) && (\r\n                    <div className=\"absolute z-50 w-full mt-2 bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border shadow-lg overflow-hidden\">\r\n                        {searchResults.length > 0 ? (\r\n                            <ul className=\"max-h-64 overflow-y-auto py-2\">\r\n                                {searchResults.map(resource => {\r\n                                    const Icon = getResourceIcon(resource.metadata?.resource_type)\r\n                                    const colorClass = getResourceColor(resource.metadata?.resource_type)\r\n\r\n                                    return (\r\n                                        <li key={resource.id}>\r\n                                            <button\r\n                                                type=\"button\"\r\n                                                onClick={() => handleAddResource(resource)}\r\n                                                className=\"w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-50 dark:hover:bg-dark-surface-hover transition-colors text-left\"\r\n                                            >\r\n                                                <div className={`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 ${colorClass}`}>\r\n                                                    <Icon className=\"w-4 h-4\" />\r\n                                                </div>\r\n                                                <div className=\"flex-1 min-w-0\">\r\n                                                    <h4 className=\"font-medium text-text dark:text-dark-text truncate text-sm\">\r\n                                                        {resource.title}\r\n                                                    </h4>\r\n                                                    <p className=\"text-xs text-text-muted dark:text-dark-text-muted truncate\">\r\n                                                        {resource.content}\r\n                                                    </p>\r\n                                                </div>\r\n                                                <Plus className=\"w-4 h-4 text-primary flex-shrink-0\" />\r\n                                            </button>\r\n                                        </li>\r\n                                    )\r\n                                })}\r\n                            </ul>\r\n                        ) : searchQuery.trim() && !isSearching ? (\r\n                            <div className=\"p-4 text-center text-sm text-text-muted dark:text-dark-text-muted\">\r\n                                <p>No resources found for \"{searchQuery}\"</p>\r\n                                {userId && (\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        onClick={() => {\r\n                                            setShowUploadModal(true)\r\n                                            setIsOpen(false)\r\n                                        }}\r\n                                        className=\"inline-flex items-center gap-1 mt-2 text-primary hover:underline\"\r\n                                    >\r\n                                        <Plus className=\"w-3.5 h-3.5\" />\r\n                                        Upload new resource\r\n                                    </button>\r\n                                )}\r\n                            </div>\r\n                        ) : null}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Error Message */}\r\n            {error && (\r\n                <p className=\"text-xs text-accent\">{error}</p>\r\n            )}\r\n\r\n            {/* Help Text */}\r\n            <p className=\"text-xs text-text-light dark:text-dark-text-muted\">\r\n                Link relevant resources like datasets, papers, or tools that support your post.\r\n            </p>\r\n\r\n            {/* Quick Upload Modal */}\r\n            {showUploadModal && (\r\n                <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\r\n                    <div className=\"bg-white dark:bg-dark-surface rounded-2xl border border-gray-200 dark:border-dark-border shadow-xl w-full max-w-lg mx-4 p-6\">\r\n                        <div className=\"flex items-center justify-between mb-6\">\r\n                            <h3 className=\"text-lg font-semibold text-text dark:text-dark-text flex items-center gap-2\">\r\n                                <Upload className=\"w-5 h-5 text-primary\" />\r\n                                Quick Upload Resource\r\n                            </h3>\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={() => setShowUploadModal(false)}\r\n                                className=\"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-surface-hover transition-colors\"\r\n                            >\r\n                                <X className=\"w-5 h-5\" />\r\n                            </button>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-4\">\r\n                            {/* File Upload Area */}\r\n                            <div className=\"border-2 border-dashed border-gray-300 dark:border-dark-border rounded-xl p-6 text-center hover:bg-gray-50 dark:hover:bg-dark-surface-hover transition-colors cursor-pointer relative\">\r\n                                <input\r\n                                    type=\"file\"\r\n                                    onChange={handleFileChange}\r\n                                    className=\"absolute inset-0 w-full h-full opacity-0 cursor-pointer\"\r\n                                    accept=\".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.csv,.zip,.json,.png,.jpg,.jpeg,.mp4,.mp3\"\r\n                                />\r\n                                <div className=\"flex flex-col items-center gap-2 pointer-events-none\">\r\n                                    {uploadFile ? (\r\n                                        <>\r\n                                            <FileText className=\"w-8 h-8 text-primary\" />\r\n                                            <p className=\"font-medium text-text dark:text-dark-text text-sm\">{uploadFile.name}</p>\r\n                                            <p className=\"text-xs text-text-muted\">\r\n                                                {formatSize(uploadFile.size)}\r\n                                            </p>\r\n                                        </>\r\n                                    ) : (\r\n                                        <>\r\n                                            <UploadCloud className=\"w-8 h-8 text-gray-400\" />\r\n                                            <p className=\"font-medium text-text dark:text-dark-text text-sm\">\r\n                                                Click or drag file to upload\r\n                                            </p>\r\n                                            <p className=\"text-xs text-text-muted\">\r\n                                                PDF, Documents, Datasets, Media (Max 50MB)\r\n                                            </p>\r\n                                        </>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Resource Type */}\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-sm font-medium text-text dark:text-dark-text\">Type</label>\r\n                                <div className=\"flex flex-wrap gap-2\">\r\n                                    {RESOURCE_TYPES.map(type => {\r\n                                        const Icon = type.icon\r\n                                        const isSelected = uploadResourceType === type.value\r\n                                        return (\r\n                                            <button\r\n                                                key={type.value}\r\n                                                type=\"button\"\r\n                                                onClick={() => setUploadResourceType(type.value)}\r\n                                                className={`inline-flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all ${isSelected\r\n                                                    ? 'bg-primary text-white'\r\n                                                    : 'bg-gray-100 dark:bg-dark-surface-hover text-text dark:text-dark-text hover:bg-gray-200 dark:hover:bg-dark-border'\r\n                                                    }`}\r\n                                            >\r\n                                                <Icon className=\"w-4 h-4\" />\r\n                                                {type.label}\r\n                                            </button>\r\n                                        )\r\n                                    })}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Title */}\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-sm font-medium text-text dark:text-dark-text\">Title *</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={uploadTitle}\r\n                                    onChange={e => setUploadTitle(e.target.value)}\r\n                                    placeholder=\"Resource title\"\r\n                                    className=\"w-full px-4 py-2.5 text-sm rounded-xl border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Description */}\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-sm font-medium text-text dark:text-dark-text\">Description (optional)</label>\r\n                                <textarea\r\n                                    value={uploadDescription}\r\n                                    onChange={e => setUploadDescription(e.target.value)}\r\n                                    placeholder=\"Brief description of this resource...\"\r\n                                    rows={2}\r\n                                    className=\"w-full px-4 py-2.5 text-sm rounded-xl border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all resize-none\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Actions */}\r\n                            <div className=\"flex gap-3 pt-2\">\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={() => setShowUploadModal(false)}\r\n                                    className=\"flex-1 px-4 py-2.5 text-sm font-medium rounded-xl border border-gray-200 dark:border-dark-border text-text dark:text-dark-text hover:bg-gray-50 dark:hover:bg-dark-surface-hover transition-colors\"\r\n                                >\r\n                                    Cancel\r\n                                </button>\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={handleQuickUpload}\r\n                                    disabled={isUploading || !uploadFile || !uploadTitle.trim()}\r\n                                    className=\"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2.5 text-sm font-medium rounded-xl bg-primary text-white hover:bg-primary-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                                >\r\n                                    {isUploading ? (\r\n                                        <>\r\n                                            <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                                            Uploading...\r\n                                        </>\r\n                                    ) : (\r\n                                        <>\r\n                                            <Upload className=\"w-4 h-4\" />\r\n                                            Upload & Link\r\n                                        </>\r\n                                    )}\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ReviewBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\RichEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\RolePromotionRequest.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchRequests'. Either include it or remove the dependency array.","line":46,"column":8,"nodeType":"ArrayExpression","endLine":46,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchRequests]","fix":{"range":[1517,1519],"text":"[fetchRequests]"}}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":120,"column":86,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[4665,4821],"text":"\r\n                                Your request is being reviewed by the admin team. You&apos;ll be notified when there's an update.\r\n                            "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[4665,4821],"text":"\r\n                                Your request is being reviewed by the admin team. You&lsquo;ll be notified when there's an update.\r\n                            "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[4665,4821],"text":"\r\n                                Your request is being reviewed by the admin team. You&#39;ll be notified when there's an update.\r\n                            "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[4665,4821],"text":"\r\n                                Your request is being reviewed by the admin team. You&rsquo;ll be notified when there's an update.\r\n                            "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":120,"column":112,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[4665,4821],"text":"\r\n                                Your request is being reviewed by the admin team. You'll be notified when there&apos;s an update.\r\n                            "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[4665,4821],"text":"\r\n                                Your request is being reviewed by the admin team. You'll be notified when there&lsquo;s an update.\r\n                            "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[4665,4821],"text":"\r\n                                Your request is being reviewed by the admin team. You'll be notified when there&#39;s an update.\r\n                            "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[4665,4821],"text":"\r\n                                Your request is being reviewed by the admin team. You'll be notified when there&rsquo;s an update.\r\n                            "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { GraduationCap, Clock, CheckCircle, XCircle, Send, Loader2, AlertCircle } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { useToast } from '@/components/ui/toast'\r\nimport { cn } from '@/lib/utils'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface PromotionRequest {\r\n    id: string\r\n    requested_role: string\r\n    reason: string\r\n    status: 'pending' | 'approved' | 'rejected'\r\n    admin_notes: string | null\r\n    created_at: string\r\n    reviewed_at: string | null\r\n}\r\n\r\ninterface RolePromotionRequestProps {\r\n    userRole: string\r\n}\r\n\r\nexport function RolePromotionRequest({ userRole }: RolePromotionRequestProps) {\r\n    const t = useTranslations('Promotion')\r\n    const tCommon = useTranslations('Common')\r\n    const [requests, setRequests] = useState<PromotionRequest[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [submitting, setSubmitting] = useState(false)\r\n    const [reason, setReason] = useState('')\r\n    const [showForm, setShowForm] = useState(false)\r\n    const { showToast } = useToast()\r\n    const supabase = createClient()\r\n\r\n    const fetchRequests = async () => {\r\n        const { data, error } = await supabase.rpc('get_my_promotion_requests')\r\n        if (!error && data) {\r\n            setRequests(data || [])\r\n        }\r\n        setLoading(false)\r\n    }\r\n\r\n    useEffect(() => {\r\n        fetchRequests()\r\n    }, [])\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault()\r\n        if (!reason.trim() || reason.length < 50) {\r\n            showToast('Please provide a detailed reason (at least 50 characters)', 'error')\r\n            return\r\n        }\r\n\r\n        setSubmitting(true)\r\n        try {\r\n            const { data, error } = await supabase.rpc('request_role_promotion', {\r\n                p_requested_role: 'researcher',\r\n                p_reason: reason.trim()\r\n            })\r\n\r\n            if (error) throw error\r\n\r\n            if (data?.success) {\r\n                showToast('Request submitted successfully!', 'success')\r\n                setReason('')\r\n                setShowForm(false)\r\n                fetchRequests()\r\n            } else {\r\n                throw new Error(data?.error || 'Failed to submit request')\r\n            }\r\n        } catch (error) {\r\n            showToast(error instanceof Error ? error.message : 'Failed to submit request', 'error')\r\n        } finally {\r\n            setSubmitting(false)\r\n        }\r\n    }\r\n\r\n    // Only show for members\r\n    if (userRole !== 'member') {\r\n        return null\r\n    }\r\n\r\n    const pendingRequest = requests.find(r => r.status === 'pending')\r\n    const latestRequest = requests[0]\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-6\">\r\n                <div className=\"animate-pulse space-y-4\">\r\n                    <div className=\"h-6 bg-gray-200 dark:bg-dark-border rounded w-48\" />\r\n                    <div className=\"h-20 bg-gray-200 dark:bg-dark-border rounded\" />\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border overflow-hidden\">\r\n            {/* Header */}\r\n            <div className=\"p-4 border-b border-gray-100 dark:border-dark-border\">\r\n                <div className=\"flex items-center gap-2\">\r\n                    <GraduationCap className=\"w-5 h-5 text-primary\" />\r\n                    <h3 className=\"font-semibold text-text dark:text-dark-text\">{t('becomeResearcher')}</h3>\r\n                </div>\r\n                <p className=\"text-sm text-text-light dark:text-dark-text-muted mt-1\">\r\n                    Researchers can create articles, ask questions, and access the Research Lab.\r\n                </p>\r\n            </div>\r\n\r\n            {/* Content */}\r\n            <div className=\"p-4\">\r\n                {/* Show pending request status */}\r\n                {pendingRequest && (\r\n                    <div className=\"flex items-start gap-3 p-4 bg-amber-50 dark:bg-amber-900/20 rounded-lg border border-amber-200 dark:border-amber-800\">\r\n                        <Clock className=\"w-5 h-5 text-amber-600 dark:text-amber-400 flex-shrink-0 mt-0.5\" />\r\n                        <div>\r\n                            <p className=\"font-medium text-amber-800 dark:text-amber-200\">{t('requestPending')}</p>\r\n                            <p className=\"text-sm text-amber-700 dark:text-amber-300 mt-1\">\r\n                                Your request is being reviewed by the admin team. You'll be notified when there's an update.\r\n                            </p>\r\n                            <p className=\"text-xs text-amber-600 dark:text-amber-400 mt-2\">\r\n                                Submitted {new Date(pendingRequest.created_at).toLocaleDateString()}\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Show latest approved/rejected status */}\r\n                {!pendingRequest && latestRequest && latestRequest.status !== 'pending' && (\r\n                    <div className={cn(\r\n                        \"flex items-start gap-3 p-4 rounded-lg border mb-4\",\r\n                        latestRequest.status === 'approved'\r\n                            ? \"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800\"\r\n                            : \"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800\"\r\n                    )}>\r\n                        {latestRequest.status === 'approved' ? (\r\n                            <CheckCircle className=\"w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0 mt-0.5\" />\r\n                        ) : (\r\n                            <XCircle className=\"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5\" />\r\n                        )}\r\n                        <div>\r\n                            <p className={cn(\r\n                                \"font-medium\",\r\n                                latestRequest.status === 'approved'\r\n                                    ? \"text-green-800 dark:text-green-200\"\r\n                                    : \"text-red-800 dark:text-red-200\"\r\n                            )}>\r\n                                {latestRequest.status === 'approved' ? 'Request Approved' : 'Request Not Approved'}\r\n                            </p>\r\n                            {latestRequest.admin_notes && (\r\n                                <p className={cn(\r\n                                    \"text-sm mt-1\",\r\n                                    latestRequest.status === 'approved'\r\n                                        ? \"text-green-700 dark:text-green-300\"\r\n                                        : \"text-red-700 dark:text-red-300\"\r\n                                )}>\r\n                                    {latestRequest.admin_notes}\r\n                                </p>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Request Form */}\r\n                {!pendingRequest && (\r\n                    <>\r\n                        {!showForm ? (\r\n                            <Button\r\n                                onClick={() => setShowForm(true)}\r\n                                className=\"w-full gap-2\"\r\n                            >\r\n                                <GraduationCap className=\"w-4 h-4\" />\r\n                                {t('requestAccess')}\r\n                            </Button>\r\n                        ) : (\r\n                            <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-text dark:text-dark-text mb-2\">\r\n                                        Why do you want to become a researcher?\r\n                                    </label>\r\n                                    <textarea\r\n                                        value={reason}\r\n                                        onChange={(e) => setReason(e.target.value)}\r\n                                        placeholder=\"Tell us about your background, expertise, and what you'd like to contribute to the community...\"\r\n                                        rows={4}\r\n                                        className=\"w-full px-3 py-2 rounded-lg border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text placeholder:text-text-light dark:placeholder:text-dark-text-muted focus:ring-2 focus:ring-primary focus:border-transparent resize-none\"\r\n                                        required\r\n                                        minLength={50}\r\n                                    />\r\n                                    <p className=\"text-xs text-text-light dark:text-dark-text-muted mt-1\">\r\n                                        Minimum 50 characters ({reason.length}/50)\r\n                                    </p>\r\n                                </div>\r\n\r\n                                <div className=\"flex gap-2\">\r\n                                    <Button\r\n                                        type=\"button\"\r\n                                        variant=\"outline\"\r\n                                        onClick={() => setShowForm(false)}\r\n                                        className=\"flex-1\"\r\n                                    >\r\n                                        {tCommon('cancel')}\r\n                                    </Button>\r\n                                    <Button\r\n                                        type=\"submit\"\r\n                                        disabled={submitting || reason.length < 50}\r\n                                        className=\"flex-1 gap-2\"\r\n                                    >\r\n                                        {submitting ? (\r\n                                            <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                                        ) : (\r\n                                            <Send className=\"w-4 h-4\" />\r\n                                        )}\r\n                                        {t('submitRequest')}\r\n                                    </Button>\r\n                                </div>\r\n                            </form>\r\n                        )}\r\n                    </>\r\n                )}\r\n            </div>\r\n\r\n            {/* Info Footer */}\r\n            <div className=\"p-4 bg-gray-50 dark:bg-dark-bg border-t border-gray-100 dark:border-dark-border\">\r\n                <div className=\"flex items-start gap-2 text-xs text-text-light dark:text-dark-text-muted\">\r\n                    <AlertCircle className=\"w-4 h-4 flex-shrink-0 mt-0.5\" />\r\n                    <p>\r\n                        Requests are reviewed by admins. Approval depends on your profile, activity, and stated goals.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\RsvpButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\SavedItemsManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\SearchBar.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback received a function whose dependencies are unknown. Pass an inline function instead.","line":63,"column":26,"nodeType":"Identifier","endLine":63,"endColumn":37,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\SearchFilters.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\SectorGrid.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\SessionContextBar.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\SessionContextBar.tsx:22:9\n  20 |     useEffect(() => {\n  21 |         const context = getSessionContext()\n> 22 |         setTrail(context.researchTrail.slice(-5).reverse())\n     |         ^^^^^^^^ Avoid calling setState() directly within an effect\n  23 |         setSummary(getTrailSummary())\n  24 |     }, [])\n  25 |","line":22,"column":9,"nodeType":null,"endLine":22,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport Link from 'next/link'\r\nimport { getSessionContext, resetSessionContext, getTrailSummary, ResearchTrailItem } from '@/lib/sessionContext'\r\nimport { History, RotateCcw, ChevronRight, Tag, Clock } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { useTranslations } from 'next-intl'\r\n\r\nexport function SessionContextBar() {\r\n    const t = useTranslations('Session')\r\n    const [trail, setTrail] = useState<ResearchTrailItem[]>([])\r\n    const [summary, setSummary] = useState<{ totalViewed: number; disciplines: string[]; sessionDuration: string }>({\r\n        totalViewed: 0,\r\n        disciplines: [],\r\n        sessionDuration: '0m'\r\n    })\r\n    const [isExpanded, setIsExpanded] = useState(false)\r\n\r\n    useEffect(() => {\r\n        const context = getSessionContext()\r\n        setTrail(context.researchTrail.slice(-5).reverse())\r\n        setSummary(getTrailSummary())\r\n    }, [])\r\n\r\n    const handleReset = () => {\r\n        if (confirm('Reset your research context? This clears your current session trail.')) {\r\n            resetSessionContext()\r\n            setTrail([])\r\n            setSummary({ totalViewed: 0, disciplines: [], sessionDuration: '0m' })\r\n        }\r\n    }\r\n\r\n    if (trail.length === 0) {\r\n        return null\r\n    }\r\n\r\n    return (\r\n        <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border overflow-hidden\">\r\n            {/* Header */}\r\n            <div\r\n                className=\"flex items-center justify-between px-4 py-3 cursor-pointer hover:bg-gray-50 dark:hover:bg-dark-bg/50 transition-colors\"\r\n                onClick={() => setIsExpanded(!isExpanded)}\r\n            >\r\n                <div className=\"flex items-center gap-2\">\r\n                    <History className=\"w-4 h-4 text-primary\" />\r\n                    <span className=\"text-sm font-medium text-text dark:text-dark-text\">\r\n                        {t('researchTrail')}\r\n                    </span>\r\n                    <span className=\"text-xs text-text-light dark:text-dark-text-muted\">\r\n                        {summary.totalViewed} viewed ΓÇó {summary.sessionDuration}\r\n                    </span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={(e) => {\r\n                            e.stopPropagation()\r\n                            handleReset()\r\n                        }}\r\n                        className=\"h-7 px-2 text-xs text-text-light hover:text-accent\"\r\n                    >\r\n                        <RotateCcw className=\"w-3 h-3 mr-1\" />\r\n                        {t('resetContext')}\r\n                    </Button>\r\n                    <ChevronRight className={`w-4 h-4 text-text-light transition-transform ${isExpanded ? 'rotate-90' : ''}`} />\r\n                </div>\r\n            </div>\r\n\r\n            {/* Expanded Trail */}\r\n            {isExpanded && (\r\n                <div className=\"border-t border-gray-100 dark:border-dark-border\">\r\n                    {/* Disciplines */}\r\n                    {summary.disciplines.length > 0 && (\r\n                        <div className=\"px-4 py-2 border-b border-gray-100 dark:border-dark-border\">\r\n                            <div className=\"flex items-center gap-1 flex-wrap\">\r\n                                <Tag className=\"w-3 h-3 text-text-light\" />\r\n                                <span className=\"text-xs text-text-light dark:text-dark-text-muted mr-1\">{t('topicsExplored')}</span>\r\n                                {summary.disciplines.map(d => (\r\n                                    <span key={d} className=\"text-xs px-2 py-0.5 bg-gray-100 dark:bg-dark-border rounded-full text-text-light dark:text-dark-text-muted\">\r\n                                        {d}\r\n                                    </span>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Trail Items */}\r\n                    <div className=\"divide-y divide-gray-100 dark:divide-dark-border\">\r\n                        {trail.map((item, idx) => (\r\n                            <Link\r\n                                key={item.postId}\r\n                                href={`/post/${item.postId}`}\r\n                                className=\"flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50 dark:hover:bg-dark-bg/30 transition-colors\"\r\n                            >\r\n                                <span className=\"text-xs text-text-light dark:text-dark-text-muted w-4\">\r\n                                    {idx + 1}\r\n                                </span>\r\n                                <div className=\"flex-1 min-w-0\">\r\n                                    <p className=\"text-sm text-text dark:text-dark-text truncate\">\r\n                                        {item.title}\r\n                                    </p>\r\n                                </div>\r\n                                <span className=\"text-[10px] text-text-light dark:text-dark-text-muted flex items-center gap-1\">\r\n                                    <Clock className=\"w-3 h-3\" />\r\n                                    {formatTimeAgo(item.viewedAt)}\r\n                                </span>\r\n                            </Link>\r\n                        ))}\r\n                    </div>\r\n\r\n                    {/* Footer Note */}\r\n                    <div className=\"px-4 py-2 bg-gray-50 dark:bg-dark-bg/50 border-t border-gray-100 dark:border-dark-border\">\r\n                        <p className=\"text-[10px] text-text-light dark:text-dark-text-muted text-center\">\r\n                            {t('privacyNote')}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction formatTimeAgo(date: Date): string {\r\n    const now = new Date()\r\n    const diffMs = now.getTime() - new Date(date).getTime()\r\n    const diffMins = Math.floor(diffMs / 60000)\r\n\r\n    if (diffMins < 1) return 'just now'\r\n    if (diffMins < 60) return `${diffMins}m ago`\r\n    const diffHours = Math.floor(diffMins / 60)\r\n    return `${diffHours}h ago`\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\SettingsPage.tsx","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":39,"column":5,"severity":1,"nodeType":null,"fix":{"range":[1131,1193],"text":" "}}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"'use client'\r\n\r\nimport { useState } from 'react'\r\nimport {\r\n    Settings,\r\n    Bell,\r\n    Palette,\r\n    Eye,\r\n    Lock,\r\n    FileEdit,\r\n    Sun,\r\n    Moon,\r\n    Monitor,\r\n    Check,\r\n    RotateCcw,\r\n    Ticket,\r\n    MessageSquarePlus\r\n} from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { usePreferences, type UserPreferences } from '@/contexts/PreferencesContext'\r\nimport { useToast } from '@/components/ui/toast'\r\nimport { InviteManager } from '@/components/InviteManager'\r\nimport { FeedbackSection } from '@/components/feedback'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface SettingsPageProps {\r\n    user: {\r\n        id: string\r\n        email?: string\r\n    }\r\n}\r\n\r\nexport function SettingsPage({ user }: SettingsPageProps) {\r\n    const { preferences, updatePreference, updateNestedPreference, resetToDefaults, loading } = usePreferences()\r\n    const { showToast } = useToast()\r\n    const t = useTranslations('Settings')\r\n    const [activeSection, setActiveSection] = useState<'notifications' | 'appearance' | 'display' | 'privacy' | 'editor' | 'invites' | 'feedback'>('appearance')\r\n\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    const handleUpdate = async (section: keyof UserPreferences, key: string, value: any) => {\r\n        try {\r\n            // @ts-expect-error - Dynamic key access for settings\r\n            await updateNestedPreference(section, key, value)\r\n            showToast(t('saved'), 'success')\r\n        } catch (error) {\r\n            showToast(t('saveFailed') || 'Failed to save settings', 'error')\r\n        }\r\n    }\r\n\r\n\r\n\r\n    const handleReset = async () => {\r\n        if (confirm(t('confirmReset'))) {\r\n            await resetToDefaults()\r\n            showToast(t('settingsReset'), 'success')\r\n        }\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center py-12\">\r\n                <div className=\"animate-spin w-8 h-8 border-2 border-primary border-t-transparent rounded-full\" />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const sections = [\r\n        { id: 'appearance', label: t('appearance'), icon: Palette },\r\n        { id: 'notifications', label: t('notifications'), icon: Bell },\r\n        { id: 'display', label: t('displaySettings.title'), icon: Eye },\r\n        { id: 'privacy', label: t('privacyTab'), icon: Lock },\r\n        { id: 'editor', label: t('editorSettings.title'), icon: FileEdit },\r\n        { id: 'invites', label: t('invitesSection.title'), icon: Ticket },\r\n        { id: 'feedback', label: t('feedbackSection.title'), icon: MessageSquarePlus },\r\n    ] as const\r\n\r\n    return (\r\n        <div className=\"max-w-4xl mx-auto\">\r\n            <div className=\"flex items-center justify-between mb-8\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <Settings className=\"w-8 h-8 text-primary\" />\r\n                    <h1 className=\"text-2xl font-display font-bold text-text dark:text-dark-text\">\r\n                        {t('title')}\r\n                    </h1>\r\n                </div>\r\n                <Button variant=\"outline\" onClick={handleReset} className=\"gap-2\">\r\n                    <RotateCcw className=\"w-4 h-4\" />\r\n                    {t('resetToDefaults')}\r\n                </Button>\r\n            </div>\r\n\r\n            <div className=\"flex gap-8\">\r\n                {/* Sidebar */}\r\n                <nav className=\"w-48 flex-shrink-0\">\r\n                    <ul className=\"space-y-1\">\r\n                        {sections.map(section => {\r\n                            const Icon = section.icon\r\n                            return (\r\n                                <li key={section.id}>\r\n                                    <button\r\n                                        onClick={() => setActiveSection(section.id)}\r\n                                        className={`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-colors ${activeSection === section.id\r\n                                            ? 'bg-primary text-white'\r\n                                            : 'text-text-light dark:text-dark-text-muted hover:bg-gray-100 dark:hover:bg-dark-surface'\r\n                                            }`}\r\n                                    >\r\n                                        <Icon className=\"w-4 h-4\" />\r\n                                        {section.label}\r\n                                    </button>\r\n                                </li>\r\n                            )\r\n                        })}\r\n                    </ul>\r\n                </nav>\r\n\r\n                {/* Content */}\r\n                <div className=\"flex-1 card p-6\">\r\n                    {/* Appearance */}\r\n                    {activeSection === 'appearance' && (\r\n                        <div className=\"space-y-6\">\r\n                            <h2 className=\"text-xl font-semibold text-text dark:text-dark-text mb-4\">\r\n                                {t('appearance')}\r\n                            </h2>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-text dark:text-dark-text mb-3\">\r\n                                    {t('theme.title')}\r\n                                </label>\r\n                                <div className=\"flex gap-3\">\r\n                                    {[\r\n                                        { value: 'light', label: t('theme.light'), icon: Sun },\r\n                                        { value: 'dark', label: t('theme.dark'), icon: Moon },\r\n                                        { value: 'system', label: t('theme.system'), icon: Monitor },\r\n                                    ].map(option => {\r\n                                        const Icon = option.icon\r\n                                        const isSelected = preferences.theme === option.value\r\n                                        return (\r\n                                            <button\r\n                                                key={option.value}\r\n                                                onClick={() => updatePreference('theme', option.value as UserPreferences['theme'])}\r\n                                                className={`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-xl border-2 transition-all ${isSelected\r\n                                                    ? 'border-primary bg-primary/10 text-primary dark:text-primary-light'\r\n                                                    : 'border-gray-200 dark:border-dark-border text-text dark:text-dark-text hover:border-primary/50 hover:bg-gray-50 dark:hover:bg-dark-bg'\r\n                                                    }`}\r\n                                            >\r\n                                                <Icon className=\"w-5 h-5\" />\r\n                                                <span className=\"font-medium\">{option.label}</span>\r\n                                                {isSelected && <Check className=\"w-4 h-4\" />}\r\n                                            </button>\r\n                                        )\r\n                                    })}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Notifications */}\r\n                    {activeSection === 'notifications' && (\r\n                        <div className=\"space-y-6\">\r\n                            <h2 className=\"text-xl font-semibold text-text dark:text-dark-text mb-4\">\r\n                                {t('notificationSettings.title')}\r\n                            </h2>\r\n\r\n                            <div className=\"space-y-4\">\r\n                                <h3 className=\"text-sm font-medium text-text-light dark:text-dark-text-muted uppercase tracking-wide\">\r\n                                    {t('notificationSettings.emailNotifications')}\r\n                                </h3>\r\n\r\n                                <ToggleSetting\r\n                                    label={t('notificationSettings.mentions')}\r\n                                    description={t('notificationSettings.mentionsDesc')}\r\n                                    checked={preferences.notifications.email_mentions}\r\n                                    onChange={(v) => handleUpdate('notifications', 'email_mentions', v)}\r\n                                />\r\n                                <ToggleSetting\r\n                                    label={t('notificationSettings.replies')}\r\n                                    description={t('notificationSettings.repliesDesc')}\r\n                                    checked={preferences.notifications.email_replies}\r\n                                    onChange={(v) => handleUpdate('notifications', 'email_replies', v)}\r\n                                />\r\n                                <ToggleSetting\r\n                                    label={t('notificationSettings.newFollowers')}\r\n                                    description={t('notificationSettings.newFollowersDesc')}\r\n                                    checked={preferences.notifications.email_follows}\r\n                                    onChange={(v) => handleUpdate('notifications', 'email_follows', v)}\r\n                                />\r\n\r\n                                <div className=\"pt-4\">\r\n                                    <label className=\"block text-sm font-medium text-text dark:text-dark-text mb-2\">\r\n                                        {t('notificationSettings.emailDigest')}\r\n                                    </label>\r\n                                    <select\r\n                                        value={preferences.notifications.email_digest}\r\n                                        onChange={(e) => handleUpdate('notifications', 'email_digest', e.target.value)}\r\n                                        className=\"w-full px-3 py-2 rounded-lg border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text\"\r\n                                    >\r\n                                        <option value=\"never\">{t('notificationSettings.never')}</option>\r\n                                        <option value=\"daily\">{t('notificationSettings.daily')}</option>\r\n                                        <option value=\"weekly\">{t('notificationSettings.weekly')}</option>\r\n                                    </select>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Display */}\r\n                    {activeSection === 'display' && (\r\n                        <div className=\"space-y-6\">\r\n                            <h2 className=\"text-xl font-semibold text-text dark:text-dark-text mb-4\">\r\n                                {t('displaySettings.title')}\r\n                            </h2>\r\n\r\n                            <ToggleSetting\r\n                                label={t('displaySettings.compactMode')}\r\n                                description={t('displaySettings.compactModeDesc')}\r\n                                checked={preferences.display.compact_mode}\r\n                                onChange={(v) => handleUpdate('display', 'compact_mode', v)}\r\n                            />\r\n                            <ToggleSetting\r\n                                label={t('displaySettings.showAvatars')}\r\n                                description={t('displaySettings.showAvatarsDesc')}\r\n                                checked={preferences.display.show_avatars}\r\n                                onChange={(v) => handleUpdate('display', 'show_avatars', v)}\r\n                            />\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-text dark:text-dark-text mb-2\">\r\n                                    {t('displaySettings.postsPerPage')}\r\n                                </label>\r\n                                <select\r\n                                    value={preferences.display.posts_per_page}\r\n                                    onChange={(e) => handleUpdate('display', 'posts_per_page', parseInt(e.target.value))}\r\n                                    className=\"w-full px-3 py-2 rounded-lg border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text\"\r\n                                >\r\n                                    <option value=\"10\">10</option>\r\n                                    <option value=\"20\">20</option>\r\n                                    <option value=\"50\">50</option>\r\n                                </select>\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-text dark:text-dark-text mb-2\">\r\n                                    {t('displaySettings.defaultSort')}\r\n                                </label>\r\n                                <select\r\n                                    value={preferences.display.default_sort}\r\n                                    onChange={(e) => handleUpdate('display', 'default_sort', e.target.value)}\r\n                                    className=\"w-full px-3 py-2 rounded-lg border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text\"\r\n                                >\r\n                                    <option value=\"recent\">{t('displaySettings.mostRecent')}</option>\r\n                                    <option value=\"popular\">{t('displaySettings.mostPopular')}</option>\r\n                                    <option value=\"trending\">{t('displaySettings.trending')}</option>\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Privacy */}\r\n                    {activeSection === 'privacy' && (\r\n                        <div className=\"space-y-6\">\r\n                            <h2 className=\"text-xl font-semibold text-text dark:text-dark-text mb-4\">\r\n                                {t('privacySectionSettings.title')}\r\n                            </h2>\r\n\r\n                            <ToggleSetting\r\n                                label={t('privacySectionSettings.publicProfile')}\r\n                                description={t('privacySectionSettings.publicProfileDesc')}\r\n                                checked={preferences.privacy.show_profile_public}\r\n                                onChange={(v) => handleUpdate('privacy', 'show_profile_public', v)}\r\n                            />\r\n                            <ToggleSetting\r\n                                label={t('privacySectionSettings.showEmail')}\r\n                                description={t('privacySectionSettings.showEmailDesc')}\r\n                                checked={preferences.privacy.show_email}\r\n                                onChange={(v) => handleUpdate('privacy', 'show_email', v)}\r\n                            />\r\n                            <ToggleSetting\r\n                                label={t('privacySectionSettings.allowMessages')}\r\n                                description={t('privacySectionSettings.allowMessagesDesc')}\r\n                                checked={preferences.privacy.allow_messages}\r\n                                onChange={(v) => handleUpdate('privacy', 'allow_messages', v)}\r\n                            />\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Editor */}\r\n                    {activeSection === 'editor' && (\r\n                        <div className=\"space-y-6\">\r\n                            <h2 className=\"text-xl font-semibold text-text dark:text-dark-text mb-4\">\r\n                                {t('editorSettings.title')}\r\n                            </h2>\r\n\r\n                            <ToggleSetting\r\n                                label={t('editorSettings.autosave')}\r\n                                description={t('editorSettings.autosaveDesc')}\r\n                                checked={preferences.editor.autosave}\r\n                                onChange={(v) => handleUpdate('editor', 'autosave', v)}\r\n                            />\r\n\r\n                            {preferences.editor.autosave && (\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-text dark:text-dark-text mb-2\">\r\n                                        {t('editorSettings.autosaveInterval')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        min={10}\r\n                                        max={120}\r\n                                        value={preferences.editor.autosave_interval}\r\n                                        onChange={(e) => handleUpdate('editor', 'autosave_interval', parseInt(e.target.value))}\r\n                                        className=\"w-full px-3 py-2 rounded-lg border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text\"\r\n                                    />\r\n                                </div>\r\n                            )}\r\n\r\n                            <ToggleSetting\r\n                                label={t('editorSettings.spellcheck')}\r\n                                description={t('editorSettings.spellcheckDesc')}\r\n                                checked={preferences.editor.spellcheck}\r\n                                onChange={(v) => handleUpdate('editor', 'spellcheck', v)}\r\n                            />\r\n                            <ToggleSetting\r\n                                label={t('editorSettings.lineNumbers')}\r\n                                description={t('editorSettings.lineNumbersDesc')}\r\n                                checked={preferences.editor.line_numbers}\r\n                                onChange={(v) => handleUpdate('editor', 'line_numbers', v)}\r\n                            />\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Invites */}\r\n                    {activeSection === 'invites' && (\r\n                        <div className=\"space-y-6\">\r\n                            <h2 className=\"text-xl font-semibold text-text dark:text-dark-text mb-4\">\r\n                                {t('invitesSection.title')}\r\n                            </h2>\r\n                            <p className=\"text-text-light dark:text-dark-text-muted mb-6\">\r\n                                {t('invitesSection.description')}\r\n                            </p>\r\n                            <InviteManager />\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Feedback */}\r\n                    {activeSection === 'feedback' && (\r\n                        <FeedbackSection />\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface ToggleSettingProps {\r\n    label: string\r\n    description: string\r\n    checked: boolean\r\n    onChange: (checked: boolean) => void\r\n}\r\n\r\nfunction ToggleSetting({ label, description, checked, onChange }: ToggleSettingProps) {\r\n    return (\r\n        <div className=\"flex items-center justify-between py-3 border-b border-gray-100 dark:border-dark-border last:border-0\">\r\n            <div>\r\n                <p className=\"font-medium text-text dark:text-dark-text\">{label}</p>\r\n                <p className=\"text-sm text-text-light dark:text-dark-text-muted\">{description}</p>\r\n            </div>\r\n            <button\r\n                role=\"switch\"\r\n                aria-checked={checked}\r\n                onClick={() => onChange(!checked)}\r\n                className={`relative w-11 h-6 rounded-full transition-colors ${checked ? 'bg-primary' : 'bg-gray-300 dark:bg-gray-600'\r\n                    }`}\r\n            >\r\n                <span\r\n                    className={`absolute top-0.5 w-5 h-5 bg-white rounded-full shadow transition-transform ${checked ? 'translate-x-5.5 left-0.5' : 'translate-x-0.5 left-0'\r\n                        }`}\r\n                    style={{ transform: checked ? 'translateX(22px)' : 'translateX(2px)' }}\r\n                />\r\n            </button>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\SkillBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\SocialProofBanner.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\SocialProofBanner.tsx:140:9\n  138 |         const baseOnline = 10 + Math.floor(Math.random() * 15)\n  139 |         const timeMultiplier = hour >= 9 && hour <= 18 ? 2 : 1\n> 140 |         setOnlineCount(baseOnline * timeMultiplier)\n      |         ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  141 |\n  142 |         const interval = setInterval(() => {\n  143 |             setOnlineCount(prev => prev + Math.floor(Math.random() * 3) - 1)","line":140,"column":9,"nodeType":null,"endLine":140,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { Users, TrendingUp, Zap } from 'lucide-react'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface SocialProofStats {\r\n    onlineNow: number\r\n    todayPosts: number\r\n    weeklyGrowth: number\r\n}\r\n\r\nexport function SocialProofBanner() {\r\n    const t = useTranslations('SocialProof')\r\n    const [stats, setStats] = useState<SocialProofStats>({\r\n        onlineNow: 0,\r\n        todayPosts: 0,\r\n        weeklyGrowth: 0,\r\n    })\r\n    const [loading, setLoading] = useState(true)\r\n    const supabase = createClient()\r\n\r\n    useEffect(() => {\r\n        const loadStats = async () => {\r\n            try {\r\n                const now = new Date()\r\n                const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate())\r\n                const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000)\r\n                const twoWeeksAgo = new Date(now.getTime() - 14 * 24 * 60 * 60 * 1000)\r\n\r\n                // Get today's posts count\r\n                const { count: todayPosts } = await supabase\r\n                    .from('posts')\r\n                    .select('*', { count: 'exact', head: true })\r\n                    .gte('created_at', todayStart.toISOString())\r\n                    .eq('status', 'published')\r\n\r\n                // Get this week's new users\r\n                const { count: thisWeekUsers } = await supabase\r\n                    .from('users')\r\n                    .select('*', { count: 'exact', head: true })\r\n                    .gte('created_at', weekAgo.toISOString())\r\n\r\n                // Get last week's new users (for comparison)\r\n                const { count: lastWeekUsers } = await supabase\r\n                    .from('users')\r\n                    .select('*', { count: 'exact', head: true })\r\n                    .gte('created_at', twoWeeksAgo.toISOString())\r\n                    .lt('created_at', weekAgo.toISOString())\r\n\r\n                // Calculate growth percentage\r\n                const weeklyGrowth = lastWeekUsers && lastWeekUsers > 0\r\n                    ? Math.round(((thisWeekUsers || 0) - lastWeekUsers) / lastWeekUsers * 100)\r\n                    : 0\r\n\r\n                // Simulate \"online now\" with random number based on time of day\r\n                // In a real app, you'd track this with presence or analytics\r\n                const hour = now.getHours()\r\n                const baseOnline = 10 + Math.floor(Math.random() * 15)\r\n                const timeMultiplier = hour >= 9 && hour <= 18 ? 2 : 1\r\n                const onlineNow = baseOnline * timeMultiplier\r\n\r\n                setStats({\r\n                    onlineNow,\r\n                    todayPosts: todayPosts || 0,\r\n                    weeklyGrowth: Math.max(0, weeklyGrowth),\r\n                })\r\n            } catch (error) {\r\n                console.error('Error loading social proof stats:', error)\r\n            } finally {\r\n                setLoading(false)\r\n            }\r\n        }\r\n\r\n        loadStats()\r\n\r\n        // Refresh every minute\r\n        const interval = setInterval(loadStats, 60000)\r\n        return () => clearInterval(interval)\r\n    }, [supabase])\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center gap-6 py-3 bg-primary/5 dark:bg-primary-light/5 rounded-lg animate-pulse\">\r\n                <div className=\"h-4 w-32 bg-gray-200 dark:bg-dark-border rounded\" />\r\n                <div className=\"h-4 w-32 bg-gray-200 dark:bg-dark-border rounded\" />\r\n                <div className=\"h-4 w-32 bg-gray-200 dark:bg-dark-border rounded\" />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex flex-wrap items-center justify-center gap-6 sm:gap-10 py-4 text-sm text-text-light dark:text-dark-text-muted\">\r\n            <div className=\"flex items-center gap-2\">\r\n                <span className=\"relative flex h-1.5 w-1.5\">\r\n                    <span className=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75\" />\r\n                    <span className=\"relative inline-flex rounded-full h-1.5 w-1.5 bg-green-500\" />\r\n                </span>\r\n                <span>\r\n                    <span className=\"font-medium text-text dark:text-dark-text\">{stats.onlineNow}</span>\r\n                    {' '}{t('researchersOnline')}\r\n                </span>\r\n            </div>\r\n\r\n            <span className=\"hidden sm:inline text-gray-300 dark:text-dark-border\">┬╖</span>\r\n\r\n            <div className=\"flex items-center gap-2\">\r\n                <span>\r\n                    <span className=\"font-medium text-text dark:text-dark-text\">{stats.todayPosts}</span>\r\n                    {' '}{t('postsToday')}\r\n                </span>\r\n            </div>\r\n\r\n            {stats.weeklyGrowth > 0 && (\r\n                <>\r\n                    <span className=\"hidden sm:inline text-gray-300 dark:text-dark-border\">┬╖</span>\r\n                    <div className=\"flex items-center gap-1\">\r\n                        <span className=\"font-medium text-text dark:text-dark-text\">+{stats.weeklyGrowth}%</span>\r\n                        {' '}{t('thisWeek')}\r\n                    </div>\r\n                </>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n\r\n/**\r\n * Compact social proof indicator (just online count)\r\n */\r\nexport function OnlineIndicator() {\r\n    const [onlineCount, setOnlineCount] = useState(0)\r\n\r\n    useEffect(() => {\r\n        // Simulate dynamic count\r\n        const now = new Date()\r\n        const hour = now.getHours()\r\n        const baseOnline = 10 + Math.floor(Math.random() * 15)\r\n        const timeMultiplier = hour >= 9 && hour <= 18 ? 2 : 1\r\n        setOnlineCount(baseOnline * timeMultiplier)\r\n\r\n        const interval = setInterval(() => {\r\n            setOnlineCount(prev => prev + Math.floor(Math.random() * 3) - 1)\r\n        }, 30000)\r\n\r\n        return () => clearInterval(interval)\r\n    }, [])\r\n\r\n    return (\r\n        <div className=\"flex items-center gap-2 text-xs text-text-light dark:text-dark-text-muted\">\r\n            <span className=\"relative flex h-2 w-2\">\r\n                <span className=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75\" />\r\n                <span className=\"relative inline-flex rounded-full h-2 w-2 bg-green-500\" />\r\n            </span>\r\n            {onlineCount} online\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\SuggestedPosts.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\SuggestionDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\SuggestionsList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\TagChip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\TagsCloud.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\TextSelectionHandler.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\TopicClusters.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\TrendingPosts.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\TrustProfileCard.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":49,"column":21,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[2107,2130],"text":"\r\n                    &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[2107,2130],"text":"\r\n                    &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[2107,2130],"text":"\r\n                    &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[2107,2130],"text":"\r\n                    &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":49,"column":45,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[2153,2172],"text":"&quot;\r\n                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[2153,2172],"text":"&ldquo;\r\n                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[2153,2172],"text":"&#34;\r\n                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[2153,2172],"text":"&rdquo;\r\n                "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { CheckCircle, AlertTriangle, HelpCircle, Clock, Users, FileText, Link2 } from 'lucide-react'\r\nimport type { TrustProfile } from '@/types/advanced'\r\n\r\ninterface TrustProfileCardProps {\r\n    profile: TrustProfile\r\n    compact?: boolean\r\n}\r\n\r\nexport function TrustProfileCard({ profile, compact = false }: TrustProfileCardProps) {\r\n    const dimensions = [\r\n        { key: 't1', label: 'Source', score: profile.t1_source_score, icon: Users },\r\n        { key: 't2', label: 'Method', score: profile.t2_method_score, icon: FileText },\r\n        { key: 't3', label: 'Proximity', score: profile.t3_proximity_score, icon: Link2 },\r\n        { key: 't4', label: 'Temporal', score: profile.t4_temporal_score, icon: Clock },\r\n        { key: 't5', label: 'Validation', score: profile.t5_validation_score, icon: CheckCircle },\r\n    ]\r\n\r\n    const avgScore = Math.round(\r\n        (profile.t1_source_score + profile.t2_method_score + profile.t3_proximity_score +\r\n            profile.t4_temporal_score + profile.t5_validation_score) / 5\r\n    )\r\n\r\n    if (compact) {\r\n        return (\r\n            <div className=\"flex items-center gap-2\">\r\n                <div className={`w-2 h-2 rounded-full ${getScoreColor(avgScore)}`} />\r\n                <span className=\"text-xs text-text-light\">{profile.trust_summary || 'Trust profile available'}</span>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"bg-white dark:bg-dark-card rounded-xl border border-gray-200 dark:border-dark-border p-4\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n                <h4 className=\"font-medium flex items-center gap-2\">\r\n                    <span className={`w-3 h-3 rounded-full ${getScoreColor(avgScore)}`} />\r\n                    Trust Profile\r\n                </h4>\r\n                <span className=\"text-sm text-text-light\">\r\n                    Overall: {avgScore}/100\r\n                </span>\r\n            </div>\r\n\r\n            {/* Trust Summary */}\r\n            {profile.trust_summary && (\r\n                <p className=\"text-sm text-text-light mb-4 italic\">\r\n                    \"{profile.trust_summary}\"\r\n                </p>\r\n            )}\r\n\r\n            {/* 5 Dimension Bars */}\r\n            <div className=\"space-y-3\">\r\n                {dimensions.map(({ key, label, score, icon: Icon }) => (\r\n                    <div key={key} className=\"space-y-1\">\r\n                        <div className=\"flex items-center justify-between text-sm\">\r\n                            <span className=\"flex items-center gap-1.5 text-text-light\">\r\n                                <Icon className=\"w-3.5 h-3.5\" />\r\n                                {label}\r\n                            </span>\r\n                            <span className={getScoreTextColor(score)}>{score}</span>\r\n                        </div>\r\n                        <div className=\"h-1.5 bg-gray-100 dark:bg-dark-border rounded-full overflow-hidden\">\r\n                            <div\r\n                                className={`h-full rounded-full transition-all ${getBarColor(score)}`}\r\n                                style={{ width: `${score}%` }}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Contradictions Warning */}\r\n            {profile.t5_contradicting_count > 0 && (\r\n                <div className=\"mt-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800\">\r\n                    <div className=\"flex items-start gap-2 text-sm text-red-700 dark:text-red-400\">\r\n                        <AlertTriangle className=\"w-4 h-4 shrink-0 mt-0.5\" />\r\n                        <div>\r\n                            <span className=\"font-medium\">Contradicted by {profile.t5_contradicting_count} source(s)</span>\r\n                            {profile.t5_contradictions && profile.t5_contradictions.length > 0 && (\r\n                                <p className=\"text-xs mt-1\">{profile.t5_contradictions[0].detail}</p>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Corroboration Info */}\r\n            {profile.t5_corroborating_count > 0 && (\r\n                <div className=\"mt-3 flex items-center gap-2 text-sm text-green-600 dark:text-green-400\">\r\n                    <CheckCircle className=\"w-4 h-4\" />\r\n                    Corroborated by {profile.t5_corroborating_count} source(s)\r\n                </div>\r\n            )}\r\n\r\n            {/* Time Sensitivity */}\r\n            {profile.t4_is_time_sensitive && (\r\n                <div className=\"mt-2 flex items-center gap-2 text-sm text-amber-600 dark:text-amber-400\">\r\n                    <Clock className=\"w-4 h-4\" />\r\n                    Time-sensitive data\r\n                    {profile.t4_data_timestamp && (\r\n                        <span className=\"text-text-light\">\r\n                            (from {new Date(profile.t4_data_timestamp).toLocaleDateString()})\r\n                        </span>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction getScoreColor(score: number): string {\r\n    if (score >= 80) return 'bg-green-500'\r\n    if (score >= 60) return 'bg-blue-500'\r\n    if (score >= 40) return 'bg-amber-500'\r\n    return 'bg-red-500'\r\n}\r\n\r\nfunction getBarColor(score: number): string {\r\n    if (score >= 80) return 'bg-green-500'\r\n    if (score >= 60) return 'bg-blue-500'\r\n    if (score >= 40) return 'bg-amber-500'\r\n    return 'bg-red-500'\r\n}\r\n\r\nfunction getScoreTextColor(score: number): string {\r\n    if (score >= 80) return 'text-green-600 dark:text-green-400 font-medium'\r\n    if (score >= 60) return 'text-blue-600 dark:text-blue-400'\r\n    if (score >= 40) return 'text-amber-600 dark:text-amber-400'\r\n    return 'text-red-600 dark:text-red-400'\r\n}\r\n\r\n// Compact badge version\r\ninterface TrustBadgeProps {\r\n    score: number\r\n    size?: 'sm' | 'md'\r\n}\r\n\r\nexport function TrustBadge({ score, size = 'md' }: TrustBadgeProps) {\r\n    const getLabel = (s: number) => {\r\n        if (s >= 80) return 'High Trust'\r\n        if (s >= 60) return 'Medium Trust'\r\n        if (s >= 40) return 'Low Trust'\r\n        return 'Unverified'\r\n    }\r\n\r\n    // More subtle badge styles per design guidelines\r\n    const getBadgeStyle = (s: number) => {\r\n        if (s >= 80) return 'bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-800/50'\r\n        if (s >= 60) return 'bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400 border border-blue-200 dark:border-blue-800/50'\r\n        if (s >= 40) return 'bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400 border border-amber-200 dark:border-amber-800/50'\r\n        return 'bg-gray-50 dark:bg-gray-800/50 text-gray-600 dark:text-gray-400 border border-gray-200 dark:border-gray-700'\r\n    }\r\n\r\n    const sizeClasses = size === 'sm'\r\n        ? 'text-xs px-2 py-0.5 gap-1'\r\n        : 'text-sm px-2.5 py-1 gap-1.5'\r\n\r\n    return (\r\n        <span className={`inline-flex items-center rounded-md font-medium ${sizeClasses} ${getBadgeStyle(score)}`}>\r\n            <span className={`w-1.5 h-1.5 rounded-full ${getScoreColor(score)}`} />\r\n            {getLabel(score)}\r\n        </span>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\UserAchievements.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":299,"column":31,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[9688,9748],"text":"\r\n                    Great! You&apos;ve posted today. Keep your "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[9688,9748],"text":"\r\n                    Great! You&lsquo;ve posted today. Keep your "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[9688,9748],"text":"\r\n                    Great! You&#39;ve posted today. Keep your "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[9688,9748],"text":"\r\n                    Great! You&rsquo;ve posted today. Keep your "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":310,"column":24,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[10236,10274],"text":"\r\n                    Don&apos;t lose your "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[10236,10274],"text":"\r\n                    Don&lsquo;t lose your "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[10236,10274],"text":"\r\n                    Don&#39;t lose your "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[10236,10274],"text":"\r\n                    Don&rsquo;t lose your "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { Skeleton } from '@/components/ui/skeleton'\r\nimport {\r\n    Flame,\r\n    Award,\r\n    Star,\r\n    Zap,\r\n    Trophy,\r\n    CheckCircle,\r\n    PenTool,\r\n    Footprints\r\n} from 'lucide-react'\r\n\r\ninterface UserStreak {\r\n    currentStreak: number\r\n    longestStreak: number\r\n    lastPostDate: string | null\r\n    isActiveToday: boolean\r\n}\r\n\r\ninterface Badge {\r\n    id: string\r\n    name: string\r\n    description: string\r\n    icon_url: string\r\n    awarded_at: string\r\n}\r\n\r\nconst BADGE_ICONS: Record<string, React.ElementType> = {\r\n    footprints: Footprints,\r\n    pen_tool: PenTool,\r\n    check_circle: CheckCircle,\r\n    star: Star,\r\n    verified: Award,\r\n    trophy: Trophy,\r\n    default: Award,\r\n}\r\n\r\n/**\r\n * Calculate streak from post dates\r\n */\r\nfunction calculateStreak(postDates: Date[]): UserStreak {\r\n    if (postDates.length === 0) {\r\n        return {\r\n            currentStreak: 0,\r\n            longestStreak: 0,\r\n            lastPostDate: null,\r\n            isActiveToday: false,\r\n        }\r\n    }\r\n\r\n    const today = new Date()\r\n    today.setHours(0, 0, 0, 0)\r\n\r\n    const sortedDates = postDates\r\n        .map(d => {\r\n            const date = new Date(d)\r\n            date.setHours(0, 0, 0, 0)\r\n            return date\r\n        })\r\n        .sort((a, b) => b.getTime() - a.getTime())\r\n\r\n    // Get unique dates\r\n    const uniqueDates = [...new Set(sortedDates.map(d => d.getTime()))]\r\n        .map(t => new Date(t))\r\n        .sort((a, b) => b.getTime() - a.getTime())\r\n\r\n    if (uniqueDates.length === 0) {\r\n        return {\r\n            currentStreak: 0,\r\n            longestStreak: 0,\r\n            lastPostDate: null,\r\n            isActiveToday: false,\r\n        }\r\n    }\r\n\r\n    const lastPostDate = uniqueDates[0]\r\n    const isActiveToday = lastPostDate.getTime() === today.getTime()\r\n    const yesterday = new Date(today)\r\n    yesterday.setDate(yesterday.getDate() - 1)\r\n\r\n    // Calculate current streak\r\n    let currentStreak = 0\r\n    let checkDate = isActiveToday ? today : yesterday\r\n\r\n    for (const date of uniqueDates) {\r\n        if (date.getTime() === checkDate.getTime()) {\r\n            currentStreak++\r\n            checkDate = new Date(checkDate)\r\n            checkDate.setDate(checkDate.getDate() - 1)\r\n        } else if (date.getTime() < checkDate.getTime()) {\r\n            break\r\n        }\r\n    }\r\n\r\n    // Calculate longest streak\r\n    let longestStreak = 0\r\n    let tempStreak = 1\r\n\r\n    for (let i = 0; i < uniqueDates.length - 1; i++) {\r\n        const current = uniqueDates[i]\r\n        const next = uniqueDates[i + 1]\r\n        const diffDays = Math.round((current.getTime() - next.getTime()) / (1000 * 60 * 60 * 24))\r\n\r\n        if (diffDays === 1) {\r\n            tempStreak++\r\n        } else {\r\n            longestStreak = Math.max(longestStreak, tempStreak)\r\n            tempStreak = 1\r\n        }\r\n    }\r\n    longestStreak = Math.max(longestStreak, tempStreak)\r\n\r\n    return {\r\n        currentStreak,\r\n        longestStreak,\r\n        lastPostDate: lastPostDate.toISOString(),\r\n        isActiveToday,\r\n    }\r\n}\r\n\r\nexport function UserStreakBadge({ userId }: { userId: string }) {\r\n    const [streak, setStreak] = useState<UserStreak | null>(null)\r\n    const [loading, setLoading] = useState(true)\r\n    const supabase = createClient()\r\n\r\n    useEffect(() => {\r\n        const loadStreak = async () => {\r\n            try {\r\n                const thirtyDaysAgo = new Date()\r\n                thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30)\r\n\r\n                const { data: posts } = await supabase\r\n                    .from('posts')\r\n                    .select('created_at')\r\n                    .eq('author_id', userId)\r\n                    .eq('status', 'published')\r\n                    .gte('created_at', thirtyDaysAgo.toISOString())\r\n                    .order('created_at', { ascending: false })\r\n\r\n                if (posts) {\r\n                    const postDates = posts.map((p: any) => new Date(p.created_at))\r\n                    setStreak(calculateStreak(postDates))\r\n                }\r\n            } catch (error) {\r\n                console.error('Error loading streak:', error)\r\n            } finally {\r\n                setLoading(false)\r\n            }\r\n        }\r\n\r\n        loadStreak()\r\n    }, [userId, supabase])\r\n\r\n    if (loading) {\r\n        return <Skeleton className=\"w-16 h-6 rounded-full\" />\r\n    }\r\n\r\n    if (!streak || streak.currentStreak === 0) {\r\n        return null\r\n    }\r\n\r\n    return (\r\n        <div className=\"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md bg-gray-100 dark:bg-dark-surface border border-gray-200 dark:border-dark-border\">\r\n            <span className=\"text-xs text-text-light dark:text-dark-text-muted\">Streak</span>\r\n            <span className=\"text-sm font-medium text-text dark:text-dark-text\">\r\n                {streak.currentStreak}d\r\n            </span>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport function UserBadgesDisplay({ userId, limit = 5 }: { userId: string; limit?: number }) {\r\n    const [badges, setBadges] = useState<Badge[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n    const supabase = createClient()\r\n\r\n    useEffect(() => {\r\n        const loadBadges = async () => {\r\n            try {\r\n                const { data } = await supabase\r\n                    .from('user_badges')\r\n                    .select(`\r\n            awarded_at,\r\n            badge:badges(id, name, description, icon_url)\r\n          `)\r\n                    .eq('user_id', userId)\r\n                    .order('awarded_at', { ascending: false })\r\n                    .limit(limit)\r\n\r\n                if (data) {\r\n                    setBadges(\r\n                        data.map((item: any) => ({\r\n                            id: item.badge.id,\r\n                            name: item.badge.name,\r\n                            description: item.badge.description,\r\n                            icon_url: item.badge.icon_url,\r\n                            awarded_at: item.awarded_at,\r\n                        }))\r\n                    )\r\n                }\r\n            } catch (error) {\r\n                console.error('Error loading badges:', error)\r\n            } finally {\r\n                setLoading(false)\r\n            }\r\n        }\r\n\r\n        loadBadges()\r\n    }, [userId, supabase, limit])\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex gap-2\">\r\n                {Array.from({ length: 3 }).map((_, i) => (\r\n                    <Skeleton key={i} className=\"w-8 h-8 rounded-full\" />\r\n                ))}\r\n            </div>\r\n        )\r\n    }\r\n\r\n    if (badges.length === 0) {\r\n        return null\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex flex-wrap gap-2\">\r\n            {badges.map((badge) => {\r\n                const IconComponent = BADGE_ICONS[badge.icon_url] || BADGE_ICONS.default\r\n                return (\r\n                    <div\r\n                        key={badge.id}\r\n                        className=\"group relative inline-flex items-center justify-center w-7 h-7 rounded-md bg-gray-100 dark:bg-dark-surface border border-gray-200 dark:border-dark-border cursor-help transition-colors hover:border-gray-300 dark:hover:border-gray-600\"\r\n                        title={`${badge.name}: ${badge.description}`}\r\n                    >\r\n                        <IconComponent className=\"w-3.5 h-3.5 text-text-light dark:text-dark-text-muted\" />\r\n\r\n                        {/* Tooltip */}\r\n                        <div className=\"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 dark:bg-gray-100 text-white dark:text-gray-900 text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-10\">\r\n                            <div className=\"font-medium\">{badge.name}</div>\r\n                            <div className=\"text-gray-400 dark:text-gray-500\">{badge.description}</div>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            })}\r\n        </div>\r\n    )\r\n}\r\n\r\n/**\r\n * Combined streak and badges component for profile cards\r\n */\r\nexport function UserAchievements({ userId }: { userId: string }) {\r\n    return (\r\n        <div className=\"flex flex-wrap items-center gap-3\">\r\n            <UserStreakBadge userId={userId} />\r\n            <UserBadgesDisplay userId={userId} />\r\n        </div>\r\n    )\r\n}\r\n\r\n/**\r\n * Streak encouragement banner\r\n */\r\nexport function StreakEncouragement({ userId }: { userId: string }) {\r\n    const [streak, setStreak] = useState<UserStreak | null>(null)\r\n    const supabase = createClient()\r\n\r\n    useEffect(() => {\r\n        const loadStreak = async () => {\r\n            const thirtyDaysAgo = new Date()\r\n            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30)\r\n\r\n            const { data: posts } = await supabase\r\n                .from('posts')\r\n                .select('created_at')\r\n                .eq('author_id', userId)\r\n                .eq('status', 'published')\r\n                .gte('created_at', thirtyDaysAgo.toISOString())\r\n\r\n            if (posts) {\r\n                setStreak(calculateStreak(posts.map((p: any) => new Date(p.created_at))))\r\n            }\r\n        }\r\n\r\n        loadStreak()\r\n    }, [userId, supabase])\r\n\r\n    if (!streak) return null\r\n\r\n    if (streak.isActiveToday) {\r\n        return (\r\n            <div className=\"flex items-center gap-2 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg\">\r\n                <Zap className=\"w-5 h-5 text-green-500\" />\r\n                <span className=\"text-sm text-green-700 dark:text-green-300\">\r\n                    Great! You've posted today. Keep your <strong>{streak.currentStreak}-day streak</strong> going!\r\n                </span>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    if (streak.currentStreak > 0) {\r\n        return (\r\n            <div className=\"flex items-center gap-2 p-3 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg\">\r\n                <Flame className=\"w-5 h-5 text-orange-500 animate-pulse\" />\r\n                <span className=\"text-sm text-orange-700 dark:text-orange-300\">\r\n                    Don't lose your <strong>{streak.currentStreak}-day streak</strong>! Post something today.\r\n                </span>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex items-center gap-2 p-3 bg-gray-50 dark:bg-dark-surface border border-gray-200 dark:border-dark-border rounded-lg\">\r\n            <Flame className=\"w-5 h-5 text-gray-400\" />\r\n            <span className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                Start a posting streak today!\r\n            </span>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\UserActivityFeed.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\UserLevelBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\UserProgressCard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'supabase'. Either include it or remove the dependency array.","line":59,"column":8,"nodeType":"ArrayExpression","endLine":59,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [supabase, userId]","fix":{"range":[1716,1724],"text":"[supabase, userId]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { Zap, Trophy, Target, ChevronRight, Loader2 } from 'lucide-react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { UserLevelBadge, getTierFromLevel } from './UserLevelBadge'\r\nimport { cn } from '@/lib/utils'\r\nimport Link from 'next/link'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface UserProgress {\r\n    xp_points: number\r\n    level: number\r\n    current_level: {\r\n        level: number\r\n        name: string\r\n        tier: string\r\n        xp_required: number\r\n        perks: string[]\r\n        color: string\r\n    }\r\n    next_level: {\r\n        level: number\r\n        name: string\r\n        tier: string\r\n        xp_required: number\r\n        perks: string[]\r\n        color: string\r\n    } | null\r\n    xp_to_next_level: number\r\n    progress_percentage: number\r\n    achievements_unlocked: number\r\n    total_achievements: number\r\n}\r\n\r\ninterface UserProgressCardProps {\r\n    userId: string\r\n    compact?: boolean\r\n}\r\n\r\nexport function UserProgressCard({ userId, compact = false }: UserProgressCardProps) {\r\n    const [progress, setProgress] = useState<UserProgress | null>(null)\r\n    const [loading, setLoading] = useState(true)\r\n    const supabase = createClient()\r\n    const t = useTranslations('Gamification')\r\n    const tCommon = useTranslations('Common')\r\n\r\n    useEffect(() => {\r\n        const fetchProgress = async () => {\r\n            const { data, error } = await supabase.rpc('get_user_progress', {\r\n                p_user_id: userId\r\n            })\r\n            if (!error && data?.success) {\r\n                setProgress(data)\r\n            }\r\n            setLoading(false)\r\n        }\r\n        fetchProgress()\r\n    }, [userId])\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className={cn(\r\n                \"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border\",\r\n                compact ? \"p-4\" : \"p-6\"\r\n            )}>\r\n                <div className=\"flex items-center justify-center py-8\">\r\n                    <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    if (!progress) return null\r\n\r\n    const tier = getTierFromLevel(progress.level)\r\n\r\n    // Compact version for sidebar/profile header\r\n    if (compact) {\r\n        return (\r\n            <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-4\">\r\n                <div className=\"flex items-center justify-between mb-3\">\r\n                    <UserLevelBadge\r\n                        level={progress.level}\r\n                        tier={tier}\r\n                        name={progress.current_level?.name}\r\n                    />\r\n                    <span className=\"text-xs text-text-light dark:text-dark-text-muted\">\r\n                        {progress.xp_points.toLocaleString()} XP\r\n                    </span>\r\n                </div>\r\n\r\n                {/* Progress bar */}\r\n                {progress.next_level && (\r\n                    <div className=\"space-y-1\">\r\n                        <div className=\"h-2 bg-gray-100 dark:bg-dark-border rounded-full overflow-hidden\">\r\n                            <div\r\n                                className={cn(\r\n                                    \"h-full rounded-full transition-all duration-500\",\r\n                                    tier === 'bronze' && \"bg-gradient-to-r from-amber-500 to-amber-600\",\r\n                                    tier === 'silver' && \"bg-gradient-to-r from-gray-400 to-gray-500\",\r\n                                    tier === 'gold' && \"bg-gradient-to-r from-yellow-400 to-yellow-500\",\r\n                                    tier === 'platinum' && \"bg-gradient-to-r from-purple-500 to-purple-600\"\r\n                                )}\r\n                                style={{ width: `${Math.min(progress.progress_percentage, 100)}%` }}\r\n                            />\r\n                        </div>\r\n                        <p className=\"text-xs text-text-light dark:text-dark-text-muted text-right\">\r\n                            {progress.xp_to_next_level.toLocaleString()} XP to Level {progress.next_level.level}\r\n                        </p>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        )\r\n    }\r\n\r\n    // Full version\r\n    return (\r\n        <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border overflow-hidden\">\r\n            {/* Header */}\r\n            <div className=\"p-4 border-b border-gray-100 dark:border-dark-border flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-2\">\r\n                    <Zap className=\"w-5 h-5 text-primary\" />\r\n                    <h3 className=\"font-semibold text-text dark:text-dark-text\">{t('yourProgress')}</h3>\r\n                </div>\r\n                <Link\r\n                    href=\"/achievements\"\r\n                    className=\"flex items-center gap-1 text-sm text-primary hover:underline\"\r\n                >\r\n                    {tCommon('viewAll')}\r\n                    <ChevronRight className=\"w-4 h-4\" />\r\n                </Link>\r\n            </div>\r\n\r\n            {/* Level Section */}\r\n            <div className=\"p-6 bg-gradient-to-br from-gray-50 to-white dark:from-dark-bg dark:to-dark-surface\">\r\n                <div className=\"flex items-center gap-4 mb-4\">\r\n                    <div className={cn(\r\n                        \"w-16 h-16 rounded-2xl flex items-center justify-center\",\r\n                        tier === 'bronze' && \"bg-gradient-to-br from-amber-400 to-amber-600\",\r\n                        tier === 'silver' && \"bg-gradient-to-br from-gray-300 to-gray-500\",\r\n                        tier === 'gold' && \"bg-gradient-to-br from-yellow-300 to-yellow-500\",\r\n                        tier === 'platinum' && \"bg-gradient-to-br from-purple-400 to-purple-600\"\r\n                    )}>\r\n                        <span className=\"text-2xl font-bold text-white\">{progress.level}</span>\r\n                    </div>\r\n                    <div>\r\n                        <p className=\"text-lg font-bold text-text dark:text-dark-text\">\r\n                            {progress.current_level?.name || `Level ${progress.level}`}\r\n                        </p>\r\n                        <p className=\"text-sm text-text-light dark:text-dark-text-muted capitalize\">\r\n                            {tier} Tier\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* XP Progress */}\r\n                {progress.next_level && (\r\n                    <div className=\"space-y-2\">\r\n                        <div className=\"flex justify-between text-sm\">\r\n                            <span className=\"text-text dark:text-dark-text font-medium\">\r\n                                {progress.xp_points.toLocaleString()} XP\r\n                            </span>\r\n                            <span className=\"text-text-light dark:text-dark-text-muted\">\r\n                                {progress.next_level.xp_required.toLocaleString()} XP\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"h-3 bg-gray-200 dark:bg-dark-border rounded-full overflow-hidden\">\r\n                            <div\r\n                                className={cn(\r\n                                    \"h-full rounded-full transition-all duration-700\",\r\n                                    tier === 'bronze' && \"bg-gradient-to-r from-amber-400 to-amber-600\",\r\n                                    tier === 'silver' && \"bg-gradient-to-r from-gray-300 to-gray-500\",\r\n                                    tier === 'gold' && \"bg-gradient-to-r from-yellow-300 to-yellow-500\",\r\n                                    tier === 'platinum' && \"bg-gradient-to-r from-purple-400 to-purple-600\"\r\n                                )}\r\n                                style={{ width: `${Math.min(progress.progress_percentage, 100)}%` }}\r\n                            />\r\n                        </div>\r\n                        <p className=\"text-xs text-center text-text-light dark:text-dark-text-muted\">\r\n                            {progress.xp_to_next_level.toLocaleString()} XP until {progress.next_level.name}\r\n                        </p>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Stats Grid */}\r\n            <div className=\"grid grid-cols-2 divide-x divide-gray-100 dark:divide-dark-border border-t border-gray-100 dark:border-dark-border\">\r\n                <div className=\"p-4 text-center\">\r\n                    <div className=\"flex items-center justify-center gap-1 text-2xl font-bold text-text dark:text-dark-text\">\r\n                        <Zap className=\"w-5 h-5 text-yellow-500\" />\r\n                        {progress.xp_points.toLocaleString()}\r\n                    </div>\r\n                    <p className=\"text-xs text-text-light dark:text-dark-text-muted mt-1\">{t('totalXp')}</p>\r\n                </div>\r\n                <div className=\"p-4 text-center\">\r\n                    <div className=\"flex items-center justify-center gap-1 text-2xl font-bold text-text dark:text-dark-text\">\r\n                        <Trophy className=\"w-5 h-5 text-primary\" />\r\n                        {progress.achievements_unlocked}/{progress.total_achievements}\r\n                    </div>\r\n                    <p className=\"text-xs text-text-light dark:text-dark-text-muted mt-1\">{t('achievementsLabel')}</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ViewTracker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\WaitlistForm.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":67,"column":23,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[2404,2446],"text":"\r\n                    We&apos;ll notify you at "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[2404,2446],"text":"\r\n                    We&lsquo;ll notify you at "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[2404,2446],"text":"\r\n                    We&#39;ll notify you at "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[2404,2446],"text":"\r\n                    We&rsquo;ll notify you at "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState } from 'react'\r\nimport Link from 'next/link'\r\nimport { Mail, User, Building, MessageSquare, Loader2, CheckCircle, AlertCircle, ArrowRight } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface WaitlistFormProps {\r\n    onSuccess?: () => void\r\n}\r\n\r\nexport function WaitlistForm({ onSuccess }: WaitlistFormProps) {\r\n    const t = useTranslations('Waitlist')\r\n    const [email, setEmail] = useState('')\r\n    const [name, setName] = useState('')\r\n    const [affiliation, setAffiliation] = useState('')\r\n    const [reason, setReason] = useState('')\r\n    const [referralSource, setReferralSource] = useState('')\r\n    const [loading, setLoading] = useState(false)\r\n    const [success, setSuccess] = useState(false)\r\n    const [error, setError] = useState<string | null>(null)\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault()\r\n        setLoading(true)\r\n        setError(null)\r\n\r\n        try {\r\n            const response = await fetch('/api/waitlist', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    email,\r\n                    name,\r\n                    affiliation,\r\n                    reason,\r\n                    referralSource,\r\n                }),\r\n            })\r\n\r\n            const data = await response.json()\r\n\r\n            if (!response.ok) {\r\n                throw new Error(data.error || 'Failed to join waitlist')\r\n            }\r\n\r\n            setSuccess(true)\r\n            onSuccess?.()\r\n        } catch (err) {\r\n            setError(err instanceof Error ? err.message : 'Something went wrong')\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    if (success) {\r\n        return (\r\n            <div className=\"text-center py-8\">\r\n                <div className=\"w-16 h-16 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center mx-auto mb-4\">\r\n                    <CheckCircle className=\"w-8 h-8 text-green-600 dark:text-green-400\" />\r\n                </div>\r\n                <h3 className=\"text-2xl font-bold text-text dark:text-dark-text mb-2\">\r\n                    {t('onTheList')}\r\n                </h3>\r\n                <p className=\"text-text-light dark:text-dark-text-muted mb-6\">\r\n                    We'll notify you at <strong>{email}</strong> when a spot opens up.\r\n                </p>\r\n                <p className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                    Already have an invite code?{' '}\r\n                    <Link href=\"/auth/signup\" className=\"text-primary hover:underline\">\r\n                        Sign up here\r\n                    </Link>\r\n                </p>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit} className=\"space-y-5\">\r\n            {error && (\r\n                <div className=\"flex items-center gap-2 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400 text-sm\">\r\n                    <AlertCircle className=\"w-4 h-4 flex-shrink-0\" />\r\n                    {error}\r\n                </div>\r\n            )}\r\n\r\n            {/* Email */}\r\n            <div>\r\n                <label className=\"block text-sm font-medium text-text dark:text-dark-text mb-1.5\">\r\n                    {t('email')} *\r\n                </label>\r\n                <div className=\"relative\">\r\n                    <Mail className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-text-light dark:text-dark-text-muted\" />\r\n                    <input\r\n                        type=\"email\"\r\n                        value={email}\r\n                        onChange={(e) => setEmail(e.target.value)}\r\n                        required\r\n                        placeholder=\"researcher@university.edu\"\r\n                        className=\"w-full pl-11 pr-4 py-3 rounded-xl border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text placeholder:text-text-light/50 dark:placeholder:text-dark-text-muted/50 focus:ring-2 focus:ring-primary focus:border-transparent transition-all\"\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n            {/* Name */}\r\n            <div>\r\n                <label className=\"block text-sm font-medium text-text dark:text-dark-text mb-1.5\">\r\n                    {t('fullName')}\r\n                </label>\r\n                <div className=\"relative\">\r\n                    <User className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-text-light dark:text-dark-text-muted\" />\r\n                    <input\r\n                        type=\"text\"\r\n                        value={name}\r\n                        onChange={(e) => setName(e.target.value)}\r\n                        placeholder=\"Dr. Jane Smith\"\r\n                        className=\"w-full pl-11 pr-4 py-3 rounded-xl border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text placeholder:text-text-light/50 dark:placeholder:text-dark-text-muted/50 focus:ring-2 focus:ring-primary focus:border-transparent transition-all\"\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n            {/* Affiliation */}\r\n            <div>\r\n                <label className=\"block text-sm font-medium text-text dark:text-dark-text mb-1.5\">\r\n                    {t('organization')}\r\n                </label>\r\n                <div className=\"relative\">\r\n                    <Building className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-text-light dark:text-dark-text-muted\" />\r\n                    <input\r\n                        type=\"text\"\r\n                        value={affiliation}\r\n                        onChange={(e) => setAffiliation(e.target.value)}\r\n                        placeholder=\"Damascus University\"\r\n                        className=\"w-full pl-11 pr-4 py-3 rounded-xl border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text placeholder:text-text-light/50 dark:placeholder:text-dark-text-muted/50 focus:ring-2 focus:ring-primary focus:border-transparent transition-all\"\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n            {/* Reason */}\r\n            <div>\r\n                <label className=\"block text-sm font-medium text-text dark:text-dark-text mb-1.5\">\r\n                    {t('whyJoin')}\r\n                </label>\r\n                <div className=\"relative\">\r\n                    <MessageSquare className=\"absolute left-3 top-3 w-5 h-5 text-text-light dark:text-dark-text-muted\" />\r\n                    <textarea\r\n                        value={reason}\r\n                        onChange={(e) => setReason(e.target.value)}\r\n                        placeholder=\"Tell us about your research interests...\"\r\n                        rows={3}\r\n                        className=\"w-full pl-11 pr-4 py-3 rounded-xl border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text placeholder:text-text-light/50 dark:placeholder:text-dark-text-muted/50 focus:ring-2 focus:ring-primary focus:border-transparent transition-all resize-none\"\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n            {/* Referral Source */}\r\n            <div>\r\n                <label className=\"block text-sm font-medium text-text dark:text-dark-text mb-1.5\">\r\n                    {t('referralSource')}\r\n                </label>\r\n                <select\r\n                    value={referralSource}\r\n                    onChange={(e) => setReferralSource(e.target.value)}\r\n                    className=\"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text focus:ring-2 focus:ring-primary focus:border-transparent transition-all\"\r\n                >\r\n                    <option value=\"\">Select an option</option>\r\n                    <option value=\"colleague\">Colleague / Friend</option>\r\n                    <option value=\"social_media\">Social Media</option>\r\n                    <option value=\"search\">Search Engine</option>\r\n                    <option value=\"conference\">Conference / Event</option>\r\n                    <option value=\"other\">Other</option>\r\n                </select>\r\n            </div>\r\n\r\n            {/* Submit */}\r\n            <Button\r\n                type=\"submit\"\r\n                disabled={loading || !email}\r\n                className=\"w-full py-3 gap-2\"\r\n            >\r\n                {loading ? (\r\n                    <>\r\n                        <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                        Joining waitlist...\r\n                    </>\r\n                ) : (\r\n                    <>\r\n                        {t('joinWaitlist')}\r\n                        <ArrowRight className=\"w-4 h-4\" />\r\n                    </>\r\n                )}\r\n            </Button>\r\n\r\n            <p className=\"text-center text-sm text-text-light dark:text-dark-text-muted\">\r\n                Already have an invite code?{' '}\r\n                <Link href=\"/auth/signup\" className=\"text-primary hover:underline font-medium\">\r\n                    Sign up here\r\n                </Link>\r\n            </p>\r\n        </form>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\accessibility.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\accessibility.tsx:242:9\n  240 |     useEffect(() => {\n  241 |         const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)')\n> 242 |         setPrefersReducedMotion(mediaQuery.matches)\n      |         ^^^^^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  243 |\n  244 |         const listener = (e: MediaQueryListEvent) => {\n  245 |             setPrefersReducedMotion(e.matches)","line":242,"column":9,"nodeType":null,"endLine":242,"endColumn":32}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\n/**\r\n * Skip Navigation Link Component\r\n * Provides keyboard-accessible skip link for main content\r\n */\r\nexport function SkipNavLink() {\r\n    return (\r\n        <a\r\n            href=\"#main-content\"\r\n            className=\"\r\n        sr-only focus:not-sr-only\r\n        fixed top-2 left-2 z-[100]\r\n        px-4 py-2 \r\n        bg-primary text-white \r\n        rounded-lg \r\n        font-medium\r\n        focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary\r\n        transition-transform\r\n        -translate-y-full focus:translate-y-0\r\n      \"\r\n        >\r\n            Skip to main content\r\n        </a>\r\n    )\r\n}\r\n\r\n/**\r\n * Skip Nav Target - wrap main content with this\r\n */\r\nexport function SkipNavContent({ children, className = '' }: { children: React.ReactNode; className?: string }) {\r\n    return (\r\n        <main id=\"main-content\" tabIndex={-1} className={`outline-none ${className}`}>\r\n            {children}\r\n        </main>\r\n    )\r\n}\r\n\r\n/**\r\n * Focus trap for modals and dialogs\r\n */\r\nimport { useEffect, useRef, ReactNode } from 'react'\r\n\r\ninterface FocusTrapProps {\r\n    children: ReactNode\r\n    active?: boolean\r\n    returnFocusOnDeactivate?: boolean\r\n}\r\n\r\nexport function FocusTrap({\r\n    children,\r\n    active = true,\r\n    returnFocusOnDeactivate = true\r\n}: FocusTrapProps) {\r\n    const containerRef = useRef<HTMLDivElement>(null)\r\n    const previousActiveElement = useRef<Element | null>(null)\r\n\r\n    useEffect(() => {\r\n        if (!active) return\r\n\r\n        previousActiveElement.current = document.activeElement\r\n\r\n        const container = containerRef.current\r\n        if (!container) return\r\n\r\n        const focusableElements = container.querySelectorAll(\r\n            'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\r\n        )\r\n        const firstElement = focusableElements[0] as HTMLElement\r\n        const lastElement = focusableElements[focusableElements.length - 1] as HTMLElement\r\n\r\n        // Focus first element\r\n        firstElement?.focus()\r\n\r\n        const handleKeyDown = (e: KeyboardEvent) => {\r\n            if (e.key !== 'Tab') return\r\n\r\n            if (e.shiftKey) {\r\n                if (document.activeElement === firstElement) {\r\n                    e.preventDefault()\r\n                    lastElement?.focus()\r\n                }\r\n            } else {\r\n                if (document.activeElement === lastElement) {\r\n                    e.preventDefault()\r\n                    firstElement?.focus()\r\n                }\r\n            }\r\n        }\r\n\r\n        document.addEventListener('keydown', handleKeyDown)\r\n\r\n        return () => {\r\n            document.removeEventListener('keydown', handleKeyDown)\r\n            if (returnFocusOnDeactivate && previousActiveElement.current instanceof HTMLElement) {\r\n                previousActiveElement.current.focus()\r\n            }\r\n        }\r\n    }, [active, returnFocusOnDeactivate])\r\n\r\n    return <div ref={containerRef}>{children}</div>\r\n}\r\n\r\n/**\r\n * Announce content to screen readers\r\n */\r\nexport function VisuallyHidden({ children }: { children: ReactNode }) {\r\n    return (\r\n        <span className=\"sr-only\">\r\n            {children}\r\n        </span>\r\n    )\r\n}\r\n\r\n/**\r\n * Live region for dynamic announcements\r\n */\r\ninterface LiveRegionProps {\r\n    message: string\r\n    politeness?: 'polite' | 'assertive'\r\n}\r\n\r\nexport function LiveRegion({ message, politeness = 'polite' }: LiveRegionProps) {\r\n    return (\r\n        <div\r\n            role=\"status\"\r\n            aria-live={politeness}\r\n            aria-atomic=\"true\"\r\n            className=\"sr-only\"\r\n        >\r\n            {message}\r\n        </div>\r\n    )\r\n}\r\n\r\n/**\r\n * Hook for announcing messages to screen readers\r\n */\r\nimport { useState, useCallback } from 'react'\r\n\r\nexport function useAnnounce() {\r\n    const [message, setMessage] = useState('')\r\n\r\n    const announce = useCallback((text: string, delay = 100) => {\r\n        // Clear first to ensure re-announcement of same message\r\n        setMessage('')\r\n        setTimeout(() => setMessage(text), delay)\r\n    }, [])\r\n\r\n    const LiveRegionComponent = () => (\r\n        <LiveRegion message={message} />\r\n    )\r\n\r\n    return { announce, LiveRegion: LiveRegionComponent }\r\n}\r\n\r\n/**\r\n * Keyboard navigation hook\r\n */\r\nexport function useKeyboardNavigation(\r\n    items: HTMLElement[],\r\n    options: {\r\n        orientation?: 'horizontal' | 'vertical' | 'both'\r\n        wrap?: boolean\r\n        onSelect?: (item: HTMLElement) => void\r\n    } = {}\r\n) {\r\n    const { orientation = 'vertical', wrap = true, onSelect } = options\r\n    const [activeIndex, setActiveIndex] = useState(0)\r\n\r\n    const handleKeyDown = useCallback((e: React.KeyboardEvent) => {\r\n        const length = items.length\r\n        if (length === 0) return\r\n\r\n        let newIndex = activeIndex\r\n\r\n        switch (e.key) {\r\n            case 'ArrowDown':\r\n                if (orientation !== 'horizontal') {\r\n                    e.preventDefault()\r\n                    newIndex = wrap\r\n                        ? (activeIndex + 1) % length\r\n                        : Math.min(activeIndex + 1, length - 1)\r\n                }\r\n                break\r\n            case 'ArrowUp':\r\n                if (orientation !== 'horizontal') {\r\n                    e.preventDefault()\r\n                    newIndex = wrap\r\n                        ? (activeIndex - 1 + length) % length\r\n                        : Math.max(activeIndex - 1, 0)\r\n                }\r\n                break\r\n            case 'ArrowRight':\r\n                if (orientation !== 'vertical') {\r\n                    e.preventDefault()\r\n                    newIndex = wrap\r\n                        ? (activeIndex + 1) % length\r\n                        : Math.min(activeIndex + 1, length - 1)\r\n                }\r\n                break\r\n            case 'ArrowLeft':\r\n                if (orientation !== 'vertical') {\r\n                    e.preventDefault()\r\n                    newIndex = wrap\r\n                        ? (activeIndex - 1 + length) % length\r\n                        : Math.max(activeIndex - 1, 0)\r\n                }\r\n                break\r\n            case 'Home':\r\n                e.preventDefault()\r\n                newIndex = 0\r\n                break\r\n            case 'End':\r\n                e.preventDefault()\r\n                newIndex = length - 1\r\n                break\r\n            case 'Enter':\r\n            case ' ':\r\n                e.preventDefault()\r\n                onSelect?.(items[activeIndex])\r\n                return\r\n            default:\r\n                return\r\n        }\r\n\r\n        setActiveIndex(newIndex)\r\n        items[newIndex]?.focus()\r\n    }, [items, activeIndex, orientation, wrap, onSelect])\r\n\r\n    return { activeIndex, setActiveIndex, handleKeyDown }\r\n}\r\n\r\n/**\r\n * Reduced motion preference hook\r\n */\r\nexport function usePrefersReducedMotion() {\r\n    const [prefersReducedMotion, setPrefersReducedMotion] = useState(false)\r\n\r\n    useEffect(() => {\r\n        const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)')\r\n        setPrefersReducedMotion(mediaQuery.matches)\r\n\r\n        const listener = (e: MediaQueryListEvent) => {\r\n            setPrefersReducedMotion(e.matches)\r\n        }\r\n\r\n        mediaQuery.addEventListener('change', listener)\r\n        return () => mediaQuery.removeEventListener('change', listener)\r\n    }, [])\r\n\r\n    return prefersReducedMotion\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\admin\\AdminPromotionRequests.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchRequests'. Either include it or remove the dependency array.","line":59,"column":8,"nodeType":"ArrayExpression","endLine":59,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchRequests]","fix":{"range":[1957,1959],"text":"[fetchRequests]"}}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":126,"column":45,"nodeType":"JSXOpeningElement","endLine":130,"endColumn":47}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { GraduationCap, Clock, CheckCircle, XCircle, User, Calendar, ChevronDown, ChevronUp, Loader2 } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { useToast } from '@/components/ui/toast'\r\nimport { cn } from '@/lib/utils'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface PromotionRequest {\r\n    id: string\r\n    user_id: string\r\n    current_role: string\r\n    requested_role: string\r\n    reason: string\r\n    status: 'pending' | 'approved' | 'rejected'\r\n    admin_notes: string | null\r\n    created_at: string\r\n    reviewed_at: string | null\r\n    user?: {\r\n        id: string\r\n        name: string\r\n        email: string\r\n        avatar_url: string | null\r\n    }\r\n}\r\n\r\nexport function AdminPromotionRequests() {\r\n    const t = useTranslations('Promotion')\r\n    const tCommon = useTranslations('Common')\r\n    const tUser = useTranslations('UserManagement.roles')\r\n    const [requests, setRequests] = useState<PromotionRequest[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [processingId, setProcessingId] = useState<string | null>(null)\r\n    const [expandedId, setExpandedId] = useState<string | null>(null)\r\n    const [adminNotes, setAdminNotes] = useState<Record<string, string>>({})\r\n    const { showToast } = useToast()\r\n    const supabase = createClient()\r\n\r\n    const fetchRequests = async () => {\r\n        const { data, error } = await supabase\r\n            .from('role_promotion_requests')\r\n            .select(`\r\n                *,\r\n                user:users!user_id(id, name, email, avatar_url)\r\n            `)\r\n            .eq('status', 'pending')\r\n            .order('created_at', { ascending: false })\r\n\r\n        if (!error && data) {\r\n            setRequests(data)\r\n        }\r\n        setLoading(false)\r\n    }\r\n\r\n    useEffect(() => {\r\n        fetchRequests()\r\n    }, [])\r\n\r\n    const handleDecision = async (requestId: string, decision: 'approved' | 'rejected') => {\r\n        setProcessingId(requestId)\r\n        try {\r\n            const { data, error } = await supabase.rpc('review_promotion_request', {\r\n                p_request_id: requestId,\r\n                p_decision: decision,\r\n                p_admin_notes: adminNotes[requestId] || null\r\n            })\r\n\r\n            if (error) throw error\r\n\r\n            if (data?.success) {\r\n                showToast(t('requestProcessed', { decision: decision === 'approved' ? t('approve') : t('reject') }), 'success')\r\n                fetchRequests()\r\n            } else {\r\n                throw new Error(data?.error || t('processError'))\r\n            }\r\n        } catch (error) {\r\n            showToast(error instanceof Error ? error.message : t('processError'), 'error')\r\n        } finally {\r\n            setProcessingId(null)\r\n        }\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-6\">\r\n                <div className=\"animate-pulse space-y-4\">\r\n                    <div className=\"h-6 bg-gray-200 dark:bg-dark-border rounded w-48\" />\r\n                    <div className=\"h-32 bg-gray-200 dark:bg-dark-border rounded\" />\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border overflow-hidden\">\r\n            {/* Header */}\r\n            <div className=\"p-4 border-b border-gray-100 dark:border-dark-border flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-2\">\r\n                    <GraduationCap className=\"w-5 h-5 text-primary\" />\r\n                    <h3 className=\"font-semibold text-text dark:text-dark-text\">{t('rolePromotionRequests')}</h3>\r\n                </div>\r\n                {requests.length > 0 && (\r\n                    <span className=\"px-2 py-1 bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 text-xs font-medium rounded-full\">\r\n                        {t('pendingCount', { count: requests.length })}\r\n                    </span>\r\n                )}\r\n            </div>\r\n\r\n            {/* Content */}\r\n            <div className=\"divide-y divide-gray-100 dark:divide-dark-border\">\r\n                {requests.length === 0 ? (\r\n                    <div className=\"p-8 text-center\">\r\n                        <CheckCircle className=\"w-8 h-8 text-green-500 mx-auto mb-2\" />\r\n                        <p className=\"text-text-light dark:text-dark-text-muted\">{t('noPending')}</p>\r\n                    </div>\r\n                ) : (\r\n                    requests.map((request) => (\r\n                        <div key={request.id} className=\"p-4\">\r\n                            {/* Request Header */}\r\n                            <div className=\"flex items-start justify-between\">\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <div className=\"w-10 h-10 rounded-full bg-gray-100 dark:bg-dark-border flex items-center justify-center overflow-hidden\">\r\n                                        {request.user?.avatar_url ? (\r\n                                            <img\r\n                                                src={request.user.avatar_url}\r\n                                                alt={request.user.name}\r\n                                                className=\"w-full h-full object-cover\"\r\n                                            />\r\n                                        ) : (\r\n                                            <User className=\"w-5 h-5 text-text-light\" />\r\n                                        )}\r\n                                    </div>\r\n                                    <div>\r\n                                        <p className=\"font-medium text-text dark:text-dark-text\">\r\n                                            {request.user?.name || tCommon('unknown')}\r\n                                        </p>\r\n                                        <div className=\"flex items-center gap-2 text-xs text-text-light dark:text-dark-text-muted\">\r\n                                            <span className=\"capitalize\">{tUser(request.current_role as any)}</span>\r\n                                            <span>ΓåÆ</span>\r\n                                            <span className=\"text-primary font-medium capitalize\">{tUser(request.requested_role as any)}</span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2 text-xs text-text-light dark:text-dark-text-muted\">\r\n                                    <Calendar className=\"w-3 h-3\" />\r\n                                    {new Date(request.created_at).toLocaleDateString()}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Expand/Collapse Toggle */}\r\n                            <button\r\n                                onClick={() => setExpandedId(expandedId === request.id ? null : request.id)}\r\n                                className=\"mt-3 flex items-center gap-1 text-sm text-primary hover:underline\"\r\n                            >\r\n                                {expandedId === request.id ? (\r\n                                    <>\r\n                                        <ChevronUp className=\"w-4 h-4\" />\r\n                                        {t('hideDetails')}\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <ChevronDown className=\"w-4 h-4\" />\r\n                                        {t('showReason')}\r\n                                    </>\r\n                                )}\r\n                            </button>\r\n\r\n                            {/* Expanded Content */}\r\n                            {expandedId === request.id && (\r\n                                <div className=\"mt-4 space-y-4\">\r\n                                    {/* Reason */}\r\n                                    <div className=\"p-3 bg-gray-50 dark:bg-dark-bg rounded-lg\">\r\n                                        <p className=\"text-sm text-text dark:text-dark-text whitespace-pre-wrap\">\r\n                                            {request.reason}\r\n                                        </p>\r\n                                    </div>\r\n\r\n                                    {/* Admin Notes Input */}\r\n                                    <div>\r\n                                        <label className=\"block text-sm font-medium text-text dark:text-dark-text mb-1\">\r\n                                            {t('adminNotesLabel')}\r\n                                        </label>\r\n                                        <textarea\r\n                                            value={adminNotes[request.id] || ''}\r\n                                            onChange={(e) => setAdminNotes({ ...adminNotes, [request.id]: e.target.value })}\r\n                                            placeholder={t('adminNotesPlaceholder')}\r\n                                            rows={2}\r\n                                            className=\"w-full px-3 py-2 rounded-lg border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-bg text-text dark:text-dark-text placeholder:text-text-light dark:placeholder:text-dark-text-muted focus:ring-2 focus:ring-primary focus:border-transparent resize-none text-sm\"\r\n                                        />\r\n                                    </div>\r\n\r\n                                    {/* Action Buttons */}\r\n                                    <div className=\"flex gap-2\">\r\n                                        <Button\r\n                                            variant=\"outline\"\r\n                                            onClick={() => handleDecision(request.id, 'rejected')}\r\n                                            disabled={processingId === request.id}\r\n                                            className=\"flex-1 gap-2 text-red-600 border-red-200 hover:bg-red-50 dark:text-red-400 dark:border-red-800 dark:hover:bg-red-900/20\"\r\n                                        >\r\n                                            {processingId === request.id ? (\r\n                                                <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                                            ) : (\r\n                                                <XCircle className=\"w-4 h-4\" />\r\n                                            )}\r\n                                            {t('reject')}\r\n                                        </Button>\r\n                                        <Button\r\n                                            onClick={() => handleDecision(request.id, 'approved')}\r\n                                            disabled={processingId === request.id}\r\n                                            className=\"flex-1 gap-2 bg-green-600 hover:bg-green-700\"\r\n                                        >\r\n                                            {processingId === request.id ? (\r\n                                                <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                                            ) : (\r\n                                                <CheckCircle className=\"w-4 h-4\" />\r\n                                            )}\r\n                                            {t('approve')}\r\n                                        </Button>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    ))\r\n                )}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\admin\\AdminSidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\admin\\AnalyticsDashboard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadData'. Either include it or remove the dependency array.","line":107,"column":8,"nodeType":"ArrayExpression","endLine":107,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [daysBack, loadData]","fix":{"range":[2430,2440],"text":"[daysBack, loadData]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect, useMemo } from 'react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport {\r\n    Users,\r\n    FileText,\r\n    MessageSquare,\r\n    TrendingUp,\r\n    TrendingDown,\r\n    BarChart3,\r\n    Activity,\r\n    Eye,\r\n    ThumbsUp,\r\n    Quote,\r\n    AlertTriangle,\r\n    Scale,\r\n    UserPlus,\r\n    Shield,\r\n    Loader2\r\n} from 'lucide-react'\r\nimport {\r\n    LineChart,\r\n    Line,\r\n    XAxis,\r\n    YAxis,\r\n    CartesianGrid,\r\n    Tooltip,\r\n    ResponsiveContainer,\r\n    AreaChart,\r\n    Area,\r\n    BarChart,\r\n    Bar,\r\n    Legend\r\n} from 'recharts'\r\nimport { format } from 'date-fns'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface AdminStats {\r\n    users: {\r\n        total: number\r\n        new_period: number\r\n        researchers: number\r\n        moderators: number\r\n        admins: number\r\n        suspended: number\r\n        verified_authors: number\r\n    }\r\n    posts: {\r\n        total: number\r\n        new_period: number\r\n        articles: number\r\n        questions: number\r\n        discussions: number\r\n        pending_approval: number\r\n        approved: number\r\n        rejected: number\r\n    }\r\n    comments: {\r\n        total: number\r\n        new_period: number\r\n    }\r\n    engagement: {\r\n        total_votes: number\r\n        votes_period: number\r\n        citations: number\r\n        citations_period: number\r\n    }\r\n    moderation: {\r\n        pending_reports: number\r\n        resolved_reports: number\r\n        pending_appeals: number\r\n        waitlist_pending: number\r\n    }\r\n    period_days: number\r\n    generated_at: string\r\n}\r\n\r\ninterface GrowthDataPoint {\r\n    date: string\r\n    new_users: number\r\n    cumulative_users: number\r\n}\r\n\r\ninterface ActivityDataPoint {\r\n    date: string\r\n    posts: number\r\n    comments: number\r\n    votes: number\r\n}\r\n\r\nexport function AnalyticsDashboard() {\r\n    const t = useTranslations('Admin.analyticsPage')\r\n    const tCommon = useTranslations('Common')\r\n    const tUser = useTranslations('UserManagement')\r\n\r\n    const [stats, setStats] = useState<AdminStats | null>(null)\r\n    const [userGrowth, setUserGrowth] = useState<GrowthDataPoint[]>([])\r\n    const [contentActivity, setContentActivity] = useState<ActivityDataPoint[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [daysBack, setDaysBack] = useState(30)\r\n\r\n    const supabase = useMemo(() => createClient(), [])\r\n\r\n    useEffect(() => {\r\n        loadData()\r\n    }, [daysBack])\r\n\r\n    const loadData = async () => {\r\n        setLoading(true)\r\n\r\n        try {\r\n            const [statsResult, growthResult, activityResult] = await Promise.all([\r\n                supabase.rpc('get_admin_stats', { days_back: daysBack }),\r\n                supabase.rpc('get_user_growth', { days_back: daysBack }),\r\n                supabase.rpc('get_content_activity', { days_back: daysBack })\r\n            ])\r\n\r\n            if (statsResult.data && !statsResult.error) {\r\n                setStats(statsResult.data as AdminStats)\r\n            }\r\n\r\n            if (growthResult.data && !growthResult.error) {\r\n                setUserGrowth(growthResult.data as GrowthDataPoint[])\r\n            }\r\n\r\n            if (activityResult.data && !activityResult.error) {\r\n                setContentActivity(activityResult.data as ActivityDataPoint[])\r\n            }\r\n        } catch (error) {\r\n            console.error('Error loading analytics:', error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    const calculateGrowthRate = (current: number, previous: number) => {\r\n        if (previous === 0) return current > 0 ? 100 : 0\r\n        return Math.round(((current - previous) / previous) * 100)\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-96\">\r\n                <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    if (!stats) {\r\n        return (\r\n            <div className=\"text-center py-12 text-text-light dark:text-dark-text-muted\">\r\n                {t('failedToLoad')}\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const StatCard = ({\r\n        icon: Icon,\r\n        label,\r\n        value,\r\n        subValue,\r\n        trend,\r\n        color = 'primary'\r\n    }: {\r\n        icon: typeof Users\r\n        label: string\r\n        value: number | string\r\n        subValue?: string\r\n        trend?: number\r\n        color?: 'primary' | 'accent' | 'green' | 'yellow' | 'red' | 'purple'\r\n    }) => {\r\n        const colorClasses = {\r\n            primary: 'text-primary dark:text-primary-light',\r\n            accent: 'text-accent dark:text-accent-light',\r\n            green: 'text-green-600 dark:text-green-400',\r\n            yellow: 'text-yellow-600 dark:text-yellow-400',\r\n            red: 'text-red-600 dark:text-red-400',\r\n            purple: 'text-purple-600 dark:text-purple-400'\r\n        }\r\n\r\n        return (\r\n            <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-5\">\r\n                <div className=\"flex items-start justify-between\">\r\n                    <div className={`p-2.5 rounded-lg bg-gray-100 dark:bg-dark-border ${colorClasses[color]}`}>\r\n                        <Icon className=\"w-5 h-5\" />\r\n                    </div>\r\n                    {trend !== undefined && (\r\n                        <div className={`flex items-center gap-1 text-sm font-medium ${trend >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n                            {trend >= 0 ? <TrendingUp className=\"w-4 h-4\" /> : <TrendingDown className=\"w-4 h-4\" />}\r\n                            {Math.abs(trend)}%\r\n                        </div>\r\n                    )}\r\n                </div>\r\n                <div className=\"mt-4\">\r\n                    <p className=\"text-2xl font-display font-bold text-text dark:text-dark-text\">\r\n                        {typeof value === 'number' ? value.toLocaleString() : value}\r\n                    </p>\r\n                    <p className=\"text-sm text-text-light dark:text-dark-text-muted mt-1\">{label}</p>\r\n                    {subValue && (\r\n                        <p className=\"text-xs text-text-light/70 dark:text-dark-text-muted/70 mt-0.5\">{subValue}</p>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Time Range Selector */}\r\n            <div className=\"flex items-center justify-between\">\r\n                <h2 className=\"text-xl font-display font-semibold text-text dark:text-dark-text\">\r\n                    {t('title')}\r\n                </h2>\r\n                <div className=\"flex items-center gap-2\">\r\n                    {[7, 14, 30, 90].map((days) => (\r\n                        <button\r\n                            key={days}\r\n                            onClick={() => setDaysBack(days)}\r\n                            className={`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${daysBack === days\r\n                                ? 'bg-primary text-white'\r\n                                : 'bg-gray-100 dark:bg-dark-border text-text-light dark:text-dark-text-muted hover:bg-gray-200 dark:hover:bg-dark-border/80'\r\n                                }`}\r\n                        >\r\n                            {days}{tCommon('days_short') || 'd'}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Overview Stats */}\r\n            <div className=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-4\">\r\n                <StatCard\r\n                    icon={Users}\r\n                    label={t('totalUsers')}\r\n                    value={stats.users.total}\r\n                    subValue={t('newInPeriod', { count: stats.users.new_period, days: daysBack })}\r\n                    color=\"primary\"\r\n                />\r\n                <StatCard\r\n                    icon={FileText}\r\n                    label={t('totalPosts')}\r\n                    value={stats.posts.total}\r\n                    subValue={t('newInPeriod', { count: stats.posts.new_period, days: daysBack })}\r\n                    color=\"accent\"\r\n                />\r\n                <StatCard\r\n                    icon={MessageSquare}\r\n                    label={t('totalComments')}\r\n                    value={stats.comments.total}\r\n                    subValue={t('newInPeriod', { count: stats.comments.new_period, days: daysBack })}\r\n                    color=\"green\"\r\n                />\r\n                <StatCard\r\n                    icon={ThumbsUp}\r\n                    label={t('totalVotes')}\r\n                    value={stats.engagement.total_votes}\r\n                    subValue={t('newInPeriod', { count: stats.engagement.votes_period, days: daysBack })}\r\n                    color=\"purple\"\r\n                />\r\n            </div>\r\n\r\n            {/* Charts Row */}\r\n            <div className=\"grid gap-6 lg:grid-cols-2\">\r\n                {/* User Growth Chart */}\r\n                <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-5\">\r\n                    <h3 className=\"font-semibold text-text dark:text-dark-text mb-4 flex items-center gap-2\">\r\n                        <TrendingUp className=\"w-5 h-5 text-primary\" />\r\n                        {t('userGrowth')}\r\n                    </h3>\r\n                    <div className=\"h-64\">\r\n                        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                            <AreaChart data={userGrowth}>\r\n                                <defs>\r\n                                    <linearGradient id=\"userGradient\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                                        <stop offset=\"5%\" stopColor=\"hsl(var(--color-primary))\" stopOpacity={0.3} />\r\n                                        <stop offset=\"95%\" stopColor=\"hsl(var(--color-primary))\" stopOpacity={0} />\r\n                                    </linearGradient>\r\n                                </defs>\r\n                                <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-gray-200 dark:stroke-dark-border\" />\r\n                                <XAxis\r\n                                    dataKey=\"date\"\r\n                                    tickFormatter={(date) => format(new Date(date), 'MMM d')}\r\n                                    className=\"text-xs\"\r\n                                    tick={{ fill: 'currentColor' }}\r\n                                />\r\n                                <YAxis className=\"text-xs\" tick={{ fill: 'currentColor' }} />\r\n                                <Tooltip\r\n                                    contentStyle={{\r\n                                        backgroundColor: 'var(--bg-surface)',\r\n                                        border: '1px solid var(--border-color)',\r\n                                        borderRadius: '8px'\r\n                                    }}\r\n                                    labelFormatter={(date) => format(new Date(date), 'MMM d, yyyy')}\r\n                                />\r\n                                <Area\r\n                                    type=\"monotone\"\r\n                                    dataKey=\"cumulative_users\"\r\n                                    stroke=\"hsl(var(--color-primary))\"\r\n                                    fill=\"url(#userGradient)\"\r\n                                    strokeWidth={2}\r\n                                    name={t('totalUsers')}\r\n                                />\r\n                            </AreaChart>\r\n                        </ResponsiveContainer>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Content Activity Chart */}\r\n                <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-5\">\r\n                    <h3 className=\"font-semibold text-text dark:text-dark-text mb-4 flex items-center gap-2\">\r\n                        <Activity className=\"w-5 h-5 text-accent\" />\r\n                        {t('contentActivity')}\r\n                    </h3>\r\n                    <div className=\"h-64\">\r\n                        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                            <BarChart data={contentActivity}>\r\n                                <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-gray-200 dark:stroke-dark-border\" />\r\n                                <XAxis\r\n                                    dataKey=\"date\"\r\n                                    tickFormatter={(date) => format(new Date(date), 'MMM d')}\r\n                                    className=\"text-xs\"\r\n                                    tick={{ fill: 'currentColor' }}\r\n                                />\r\n                                <YAxis className=\"text-xs\" tick={{ fill: 'currentColor' }} />\r\n                                <Tooltip\r\n                                    contentStyle={{\r\n                                        backgroundColor: 'var(--bg-surface)',\r\n                                        border: '1px solid var(--border-color)',\r\n                                        borderRadius: '8px'\r\n                                    }}\r\n                                    labelFormatter={(date) => format(new Date(date), 'MMM d, yyyy')}\r\n                                />\r\n                                <Legend />\r\n                                <Bar dataKey=\"posts\" fill=\"hsl(var(--color-primary))\" name={t('articles')} radius={[2, 2, 0, 0]} />\r\n                                <Bar dataKey=\"comments\" fill=\"hsl(var(--color-accent))\" name={t('totalComments')} radius={[2, 2, 0, 0]} />\r\n                                <Bar dataKey=\"votes\" fill=\"#8B5CF6\" name={t('totalVotes')} radius={[2, 2, 0, 0]} />\r\n                            </BarChart>\r\n                        </ResponsiveContainer>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* User Breakdown & Moderation Stats */}\r\n            <div className=\"grid gap-6 lg:grid-cols-2\">\r\n                {/* User Role Distribution */}\r\n                <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-5\">\r\n                    <h3 className=\"font-semibold text-text dark:text-dark-text mb-4 flex items-center gap-2\">\r\n                        <Shield className=\"w-5 h-5 text-primary\" />\r\n                        {t('userRoles')}\r\n                    </h3>\r\n                    <div className=\"space-y-4\">\r\n                        {[\r\n                            { label: tUser('researchers'), count: stats.users.researchers, color: 'bg-blue-500' },\r\n                            { label: tUser('moderators'), count: stats.users.moderators, color: 'bg-green-500' },\r\n                            { label: tUser('admins'), count: stats.users.admins, color: 'bg-purple-500' },\r\n                            { label: tUser('verified'), count: stats.users.verified_authors, color: 'bg-amber-500' },\r\n                            { label: tUser('suspended'), count: stats.users.suspended, color: 'bg-red-500' },\r\n                        ].map((item) => (\r\n                            <div key={item.label} className=\"flex items-center justify-between\">\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <div className={`w-3 h-3 rounded-full ${item.color}`} />\r\n                                    <span className=\"text-text dark:text-dark-text\">{item.label}</span>\r\n                                </div>\r\n                                <span className=\"font-semibold text-text dark:text-dark-text\">{item.count}</span>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Moderation Queue */}\r\n                <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-5\">\r\n                    <h3 className=\"font-semibold text-text dark:text-dark-text mb-4 flex items-center gap-2\">\r\n                        <AlertTriangle className=\"w-5 h-5 text-yellow-500\" />\r\n                        {t('moderationQueue')}\r\n                    </h3>\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div className=\"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4\">\r\n                            <div className=\"flex items-center gap-2 text-yellow-700 dark:text-yellow-300\">\r\n                                <AlertTriangle className=\"w-4 h-4\" />\r\n                                <span className=\"text-sm font-medium\">{t('pendingReports')}</span>\r\n                            </div>\r\n                            <p className=\"text-2xl font-bold text-yellow-700 dark:text-yellow-300 mt-2\">\r\n                                {stats.moderation.pending_reports}\r\n                            </p>\r\n                        </div>\r\n                        <div className=\"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-4\">\r\n                            <div className=\"flex items-center gap-2 text-orange-700 dark:text-orange-300\">\r\n                                <Scale className=\"w-4 h-4\" />\r\n                                <span className=\"text-sm font-medium\">{t('pendingAppeals')}</span>\r\n                            </div>\r\n                            <p className=\"text-2xl font-bold text-orange-700 dark:text-orange-300 mt-2\">\r\n                                {stats.moderation.pending_appeals}\r\n                            </p>\r\n                        </div>\r\n                        <div className=\"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4\">\r\n                            <div className=\"flex items-center gap-2 text-purple-700 dark:text-purple-300\">\r\n                                <UserPlus className=\"w-4 h-4\" />\r\n                                <span className=\"text-sm font-medium\">{t('waitlist')}</span>\r\n                            </div>\r\n                            <p className=\"text-2xl font-bold text-purple-700 dark:text-purple-300 mt-2\">\r\n                                {stats.moderation.waitlist_pending}\r\n                            </p>\r\n                        </div>\r\n                        <div className=\"bg-green-50 dark:bg-green-900/20 rounded-lg p-4\">\r\n                            <div className=\"flex items-center gap-2 text-green-700 dark:text-green-300\">\r\n                                <FileText className=\"w-4 h-4\" />\r\n                                <span className=\"text-sm font-medium\">{t('postsPending')}</span>\r\n                            </div>\r\n                            <p className=\"text-2xl font-bold text-green-700 dark:text-green-300 mt-2\">\r\n                                {stats.posts.pending_approval}\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Content Type Distribution */}\r\n            <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-5\">\r\n                <h3 className=\"font-semibold text-text dark:text-dark-text mb-4 flex items-center gap-2\">\r\n                    <BarChart3 className=\"w-5 h-5 text-accent\" />\r\n                    {t('contentDistribution')}\r\n                </h3>\r\n                <div className=\"grid grid-cols-3 gap-6\">\r\n                    <div className=\"text-center\">\r\n                        <p className=\"text-3xl font-bold text-primary dark:text-primary-light\">\r\n                            {stats.posts.articles}\r\n                        </p>\r\n                        <p className=\"text-sm text-text-light dark:text-dark-text-muted mt-1\">{t('articles')}</p>\r\n                    </div>\r\n                    <div className=\"text-center\">\r\n                        <p className=\"text-3xl font-bold text-accent dark:text-accent-light\">\r\n                            {stats.posts.questions}\r\n                        </p>\r\n                        <p className=\"text-sm text-text-light dark:text-dark-text-muted mt-1\">{t('questions')}</p>\r\n                    </div>\r\n                    <div className=\"text-center\">\r\n                        <p className=\"text-3xl font-bold text-purple-600 dark:text-purple-400\">\r\n                            {stats.posts.discussions}\r\n                        </p>\r\n                        <p className=\"text-sm text-text-light dark:text-dark-text-muted mt-1\">{t('discussions')}</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\admin\\AuditLogs.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadLogs'. Either include it or remove the dependency array.","line":58,"column":8,"nodeType":"ArrayExpression","endLine":58,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [loadLogs, page]","fix":{"range":[1411,1417],"text":"[loadLogs, page]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect, useMemo } from 'react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport {\r\n    History,\r\n    Shield,\r\n    Search,\r\n    Calendar,\r\n    ChevronLeft,\r\n    ChevronRight,\r\n    ArrowRight,\r\n    ArrowUp,\r\n    ArrowDown,\r\n    Loader2,\r\n    User,\r\n    Download\r\n} from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { format } from 'date-fns'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface AuditLogEntry {\r\n    id: string\r\n    user_id: string\r\n    user_name: string | null\r\n    user_email: string | null\r\n    changed_by_id: string\r\n    changed_by_name: string | null\r\n    old_role: string\r\n    new_role: string\r\n    reason: string | null\r\n    created_at: string\r\n}\r\n\r\ninterface AuditLogsResponse {\r\n    logs: AuditLogEntry[]\r\n    total: number\r\n    page: number\r\n    page_size: number\r\n}\r\n\r\nexport function AuditLogs() {\r\n    const t = useTranslations('Admin.auditLogPage')\r\n    const tCommon = useTranslations('Common')\r\n    const tUser = useTranslations('UserManagement')\r\n\r\n    const [logs, setLogs] = useState<AuditLogEntry[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [totalLogs, setTotalLogs] = useState(0)\r\n    const [page, setPage] = useState(1)\r\n    const [pageSize] = useState(50)\r\n\r\n    const supabase = useMemo(() => createClient(), [])\r\n\r\n    useEffect(() => {\r\n        loadLogs()\r\n    }, [page])\r\n\r\n    const loadLogs = async () => {\r\n        setLoading(true)\r\n        try {\r\n            const { data, error } = await supabase.rpc('get_audit_logs', {\r\n                page_number: page,\r\n                page_size: pageSize\r\n            })\r\n\r\n            if (error) {\r\n                console.error('Error loading audit logs:', error)\r\n                return\r\n            }\r\n\r\n            if (data.error) {\r\n                console.error('Access denied:', data.error)\r\n                return\r\n            }\r\n\r\n            const result = data as AuditLogsResponse\r\n            setLogs(result.logs || [])\r\n            setTotalLogs(result.total)\r\n        } catch (error) {\r\n            console.error('Error:', error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    const getRoleChangeVisual = (oldRole: string, newRole: string) => {\r\n        const roleOrder = { researcher: 0, moderator: 1, admin: 2 }\r\n        const isPromotion = roleOrder[newRole as keyof typeof roleOrder] > roleOrder[oldRole as keyof typeof roleOrder]\r\n\r\n        const roleColors = {\r\n            researcher: 'bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300',\r\n            moderator: 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300',\r\n            admin: 'bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300'\r\n        }\r\n\r\n        return (\r\n            <div className=\"flex items-center gap-2\">\r\n                <span className={`px-2 py-0.5 rounded-full text-xs font-medium capitalize ${roleColors[oldRole as keyof typeof roleColors] || roleColors.researcher}`}>\r\n                    {tUser(oldRole as any)}\r\n                </span>\r\n                <div className={`${isPromotion ? 'text-green-500' : 'text-red-500'}`}>\r\n                    {isPromotion ? (\r\n                        <ArrowUp className=\"w-4 h-4\" />\r\n                    ) : (\r\n                        <ArrowDown className=\"w-4 h-4\" />\r\n                    )}\r\n                </div>\r\n                <span className={`px-2 py-0.5 rounded-full text-xs font-medium capitalize ${roleColors[newRole as keyof typeof roleColors] || roleColors.researcher}`}>\r\n                    {tUser(newRole as any)}\r\n                </span>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const exportLogs = () => {\r\n        const csvContent = [\r\n            [\r\n                t('timestamp'),\r\n                t('user'),\r\n                tCommon('email'),\r\n                t('changedBy'),\r\n                tUser('oldRole') || 'Old Role',\r\n                tUser('newRole') || 'New Role',\r\n                t('reason')\r\n            ].join(','),\r\n            ...logs.map(log => [\r\n                format(new Date(log.created_at), 'yyyy-MM-dd HH:mm:ss'),\r\n                log.user_name || tCommon('unknown'),\r\n                log.user_email || tCommon('unknown'),\r\n                log.changed_by_name || tCommon('unknown'),\r\n                tUser(log.old_role as any),\r\n                tUser(log.new_role as any),\r\n                `\"${(log.reason || '').replace(/\"/g, '\"\"')}\"`\r\n            ].join(','))\r\n        ].join('\\n')\r\n\r\n        const blob = new Blob([csvContent], { type: 'text/csv' })\r\n        const url = URL.createObjectURL(blob)\r\n        const a = document.createElement('a')\r\n        a.href = url\r\n        a.download = `audit-logs-${format(new Date(), 'yyyy-MM-dd')}.csv`\r\n        a.click()\r\n        URL.revokeObjectURL(url)\r\n    }\r\n\r\n    const totalPages = Math.ceil(totalLogs / pageSize)\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h2 className=\"text-xl font-display font-semibold text-text dark:text-dark-text flex items-center gap-2\">\r\n                        <History className=\"w-5 h-5 text-primary\" />\r\n                        {t('title')}\r\n                    </h2>\r\n                    <p className=\"text-sm text-text-light dark:text-dark-text-muted mt-1\">\r\n                        {t('subtitle')}\r\n                    </p>\r\n                </div>\r\n                <Button variant=\"outline\" size=\"sm\" onClick={exportLogs} disabled={logs.length === 0}>\r\n                    <Download className=\"w-4 h-4 mr-2\" />\r\n                    {t('exportCsv')}\r\n                </Button>\r\n            </div>\r\n\r\n            {/* Stats */}\r\n            <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-4\">\r\n                <p className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                    {t('totalChanges')}: <span className=\"font-semibold text-text dark:text-dark-text\">{totalLogs}</span>\r\n                </p>\r\n            </div>\r\n\r\n            {/* Logs List */}\r\n            <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border overflow-hidden\">\r\n                {loading ? (\r\n                    <div className=\"flex items-center justify-center h-64\">\r\n                        <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\r\n                    </div>\r\n                ) : logs.length === 0 ? (\r\n                    <div className=\"text-center py-12 text-text-light dark:text-dark-text-muted\">\r\n                        <History className=\"w-12 h-12 mx-auto mb-4 opacity-30\" />\r\n                        <p>{t('noLogs')}</p>\r\n                        <p className=\"text-sm mt-1\">{t('noLogsDesc')}</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"divide-y divide-gray-100 dark:divide-dark-border\">\r\n                        {logs.map((log) => (\r\n                            <div\r\n                                key={log.id}\r\n                                className=\"p-4 hover:bg-gray-50 dark:hover:bg-dark-border/30 transition-colors\"\r\n                            >\r\n                                <div className=\"flex items-start justify-between gap-4\">\r\n                                    <div className=\"flex-1 min-w-0\">\r\n                                        {/* User affected */}\r\n                                        <div className=\"flex items-center gap-2 mb-2\">\r\n                                            <div className=\"w-8 h-8 rounded-full bg-gray-200 dark:bg-dark-border flex items-center justify-center\">\r\n                                                <User className=\"w-4 h-4 text-text-light dark:text-dark-text-muted\" />\r\n                                            </div>\r\n                                            <div>\r\n                                                <p className=\"font-medium text-text dark:text-dark-text\">\r\n                                                    {log.user_name || tCommon('unknown')}\r\n                                                </p>\r\n                                                <p className=\"text-xs text-text-light dark:text-dark-text-muted\">\r\n                                                    {log.user_email}\r\n                                                </p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {/* Role Change */}\r\n                                        <div className=\"ml-10 space-y-2\">\r\n                                            {getRoleChangeVisual(log.old_role, log.new_role)}\r\n\r\n                                            {log.reason && (\r\n                                                <div className=\"mt-2 p-2 bg-gray-50 dark:bg-dark-border/50 rounded-lg\">\r\n                                                    <p className=\"text-xs text-text-light dark:text-dark-text-muted mb-0.5\">{t('reason')}:</p>\r\n                                                    <p className=\"text-sm text-text dark:text-dark-text\">{log.reason}</p>\r\n                                                </div>\r\n                                            )}\r\n\r\n                                            <p className=\"text-xs text-text-light dark:text-dark-text-muted\">\r\n                                                {t('changedBy')}: <span className=\"font-medium\">{log.changed_by_name || tCommon('unknown')}</span>\r\n                                            </p>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Timestamp */}\r\n                                    <div className=\"text-right flex-shrink-0\">\r\n                                        <p className=\"text-sm text-text-light dark:text-dark-text-muted flex items-center gap-1\">\r\n                                            <Calendar className=\"w-3.5 h-3.5\" />\r\n                                            {format(new Date(log.created_at), 'MMM d, yyyy')}\r\n                                        </p>\r\n                                        <p className=\"text-xs text-text-light/70 dark:text-dark-text-muted/70\">\r\n                                            {format(new Date(log.created_at), 'HH:mm:ss')}\r\n                                        </p>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Pagination */}\r\n            {totalPages > 1 && (\r\n                <div className=\"flex items-center justify-between\">\r\n                    <p className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                        {tCommon('pagination', { current: page, total: totalPages })}\r\n                    </p>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={() => setPage(p => Math.max(1, p - 1))}\r\n                            disabled={page === 1 || loading}\r\n                        >\r\n                            <ChevronLeft className=\"w-4 h-4\" />\r\n                            {tCommon('previous')}\r\n                        </Button>\r\n                        <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={() => setPage(p => Math.min(totalPages, p + 1))}\r\n                            disabled={page === totalPages || loading}\r\n                        >\r\n                            {tCommon('next')}\r\n                            <ChevronRight className=\"w-4 h-4\" />\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\admin\\RolePromotionDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\admin\\SearchAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\admin\\UserManagement.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":322,"column":57,"nodeType":"JSXOpeningElement","endLine":326,"endColumn":59}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect, useMemo, useCallback } from 'react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport {\r\n    Users,\r\n    Search,\r\n    Filter,\r\n    ChevronDown,\r\n    Shield,\r\n    ShieldCheck,\r\n    ShieldX,\r\n    MoreHorizontal,\r\n    Mail,\r\n    Calendar,\r\n    FileText,\r\n    MessageSquare,\r\n    Loader2,\r\n    ChevronLeft,\r\n    ChevronRight,\r\n    Ban,\r\n    CheckCircle,\r\n    AlertTriangle\r\n} from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { useToast } from '@/components/ui/toast'\r\nimport { RolePromotionDialog } from './RolePromotionDialog'\r\nimport { format } from 'date-fns'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface AdminUser {\r\n    id: string\r\n    email: string\r\n    name: string | null\r\n    role: 'researcher' | 'moderator' | 'admin'\r\n    avatar_url: string | null\r\n    created_at: string\r\n    is_verified_author: boolean\r\n    suspended_at: string | null\r\n    suspension_reason: string | null\r\n    post_count: number\r\n    comment_count: number\r\n}\r\n\r\ninterface UserListResponse {\r\n    users: AdminUser[]\r\n    total: number\r\n    page: number\r\n    page_size: number\r\n    total_pages: number\r\n}\r\n\r\nexport function UserManagement() {\r\n    const [users, setUsers] = useState<AdminUser[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [totalUsers, setTotalUsers] = useState(0)\r\n    const [totalPages, setTotalPages] = useState(1)\r\n    const [page, setPage] = useState(1)\r\n    const [pageSize] = useState(20)\r\n    const [searchQuery, setSearchQuery] = useState('')\r\n    const [roleFilter, setRoleFilter] = useState<string | null>(null)\r\n    const [sortBy, setSortBy] = useState('created_at')\r\n    const [sortOrder, setSortOrder] = useState('desc')\r\n    const [selectedUser, setSelectedUser] = useState<AdminUser | null>(null)\r\n    const [showRoleDialog, setShowRoleDialog] = useState(false)\r\n    const [processingUserId, setProcessingUserId] = useState<string | null>(null)\r\n    const [showActionMenu, setShowActionMenu] = useState<string | null>(null)\r\n    const [currentUserRole, setCurrentUserRole] = useState<string | null>(null)\r\n\r\n    const supabase = useMemo(() => createClient(), [])\r\n    const { showToast } = useToast()\r\n    const t = useTranslations('UserManagement')\r\n    const tCommon = useTranslations('Common')\r\n\r\n    // Fetch current user's role on mount\r\n    useEffect(() => {\r\n        async function fetchCurrentUserRole() {\r\n            const { data: { user } } = await supabase.auth.getUser()\r\n            if (user) {\r\n                const { data } = await supabase\r\n                    .from('users')\r\n                    .select('role')\r\n                    .eq('id', user.id)\r\n                    .single()\r\n                if (data) setCurrentUserRole(data.role)\r\n            }\r\n        }\r\n        fetchCurrentUserRole()\r\n    }, [supabase])\r\n\r\n    const loadUsers = useCallback(async () => {\r\n        setLoading(true)\r\n        try {\r\n            const { data, error } = await supabase.rpc('get_admin_users', {\r\n                page_number: page,\r\n                page_size: pageSize,\r\n                role_filter: roleFilter,\r\n                search_query: searchQuery || null,\r\n                sort_by: sortBy,\r\n                sort_order: sortOrder\r\n            })\r\n\r\n            if (error) {\r\n                console.error('Error loading users:', error)\r\n                showToast(tCommon('errors.failedToLoad'), 'error')\r\n                return\r\n            }\r\n\r\n            const result = data as UserListResponse\r\n            setUsers(result.users || [])\r\n            setTotalUsers(result.total)\r\n            setTotalPages(result.total_pages)\r\n        } catch (error) {\r\n            console.error('Error:', error)\r\n            showToast(tCommon('errors.general'), 'error')\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }, [page, pageSize, roleFilter, searchQuery, sortBy, sortOrder, supabase, showToast, tCommon])\r\n\r\n    useEffect(() => {\r\n        loadUsers()\r\n    }, [loadUsers])\r\n\r\n    // Debounced search\r\n    useEffect(() => {\r\n        const timer = setTimeout(() => {\r\n            if (page !== 1) setPage(1)\r\n            else loadUsers()\r\n        }, 300)\r\n        return () => clearTimeout(timer)\r\n    }, [searchQuery, loadUsers, page])\r\n\r\n    const handleRoleChange = (user: AdminUser) => {\r\n        // Only admins can change roles\r\n        if (currentUserRole !== 'admin') {\r\n            showToast(t('adminOnly'), 'error')\r\n            return\r\n        }\r\n        setSelectedUser(user)\r\n        setShowRoleDialog(true)\r\n        setShowActionMenu(null)\r\n    }\r\n\r\n    const handleSuspend = async (user: AdminUser) => {\r\n        // Moderators cannot suspend admins\r\n        if (currentUserRole === 'moderator' && user.role === 'admin') {\r\n            showToast(t('moderatorRestriction'), 'error')\r\n            setShowActionMenu(null)\r\n            return\r\n        }\r\n        setProcessingUserId(user.id)\r\n        setShowActionMenu(null)\r\n        try {\r\n            const { data, error } = await supabase.rpc('suspend_user', {\r\n                target_user_id: user.id,\r\n                suspend: !user.suspended_at,\r\n                reason: user.suspended_at ? null : 'Suspended by admin'\r\n            })\r\n\r\n            if (error || !data.success) {\r\n                showToast(data?.error || tCommon('errors.updateFailed'), 'error')\r\n                return\r\n            }\r\n\r\n            showToast(\r\n                user.suspended_at ? t('unsuspendedSuccess') : t('suspendedSuccess'),\r\n                'success'\r\n            )\r\n            loadUsers()\r\n        } catch (error) {\r\n            showToast(tCommon('errors.general'), 'error')\r\n        } finally {\r\n            setProcessingUserId(null)\r\n        }\r\n    }\r\n\r\n    const getRoleBadge = (role: string, isVerified: boolean, suspended: boolean) => {\r\n        if (suspended) {\r\n            return (\r\n                <span className=\"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300\">\r\n                    <Ban className=\"w-3 h-3\" />\r\n                    {t('suspended')}\r\n                </span>\r\n            )\r\n        }\r\n\r\n        const styles = {\r\n            admin: 'bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300',\r\n            moderator: 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300',\r\n            researcher: 'bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300'\r\n        }\r\n\r\n        const icons = {\r\n            admin: ShieldCheck,\r\n            moderator: Shield,\r\n            researcher: Users\r\n        }\r\n\r\n        const Icon = icons[role as keyof typeof icons] || Users\r\n\r\n        return (\r\n            <div className=\"flex items-center gap-1.5\">\r\n                <span className={`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium capitalize ${styles[role as keyof typeof styles] || styles.researcher}`}>\r\n                    <Icon className=\"w-3 h-3\" />\r\n                    {t(`roles.${role}`)}\r\n                </span>\r\n                {isVerified && (\r\n                    <span className=\"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300\">\r\n                        <CheckCircle className=\"w-3 h-3\" />\r\n                        {t('verified')}\r\n                    </span>\r\n                )}\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Header & Filters */}\r\n            <div className=\"flex flex-col sm:flex-row gap-4 justify-between\">\r\n                <div className=\"relative flex-1 max-w-md\">\r\n                    <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-text-light dark:text-dark-text-muted\" />\r\n                    <input\r\n                        type=\"text\"\r\n                        value={searchQuery}\r\n                        onChange={(e) => setSearchQuery(e.target.value)}\r\n                        placeholder={t('searchPlaceholder')}\r\n                        className=\"w-full pl-10 pr-4 py-2.5 rounded-lg border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-surface text-text dark:text-dark-text focus:ring-2 focus:ring-primary/20 focus:border-primary\"\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-2\">\r\n                    {/* Role Filter */}\r\n                    <div className=\"relative\">\r\n                        <select\r\n                            value={roleFilter || ''}\r\n                            onChange={(e) => {\r\n                                setRoleFilter(e.target.value || null)\r\n                                setPage(1)\r\n                            }}\r\n                            className=\"appearance-none pl-3 pr-8 py-2.5 rounded-lg border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-surface text-text dark:text-dark-text text-sm focus:ring-2 focus:ring-primary/20\"\r\n                        >\r\n                            <option value=\"\">{t('allRoles')}</option>\r\n                            <option value=\"researcher\">{t('researchers')}</option>\r\n                            <option value=\"moderator\">{t('moderators')}</option>\r\n                            <option value=\"admin\">{t('admins')}</option>\r\n                        </select>\r\n                        <ChevronDown className=\"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-text-light pointer-events-none\" />\r\n                    </div>\r\n\r\n                    {/* Sort */}\r\n                    <div className=\"relative\">\r\n                        <select\r\n                            value={`${sortBy}-${sortOrder}`}\r\n                            onChange={(e) => {\r\n                                const [by, order] = e.target.value.split('-')\r\n                                setSortBy(by)\r\n                                setSortOrder(order)\r\n                                setPage(1)\r\n                            }}\r\n                            className=\"appearance-none pl-3 pr-8 py-2.5 rounded-lg border border-gray-200 dark:border-dark-border bg-white dark:bg-dark-surface text-text dark:text-dark-text text-sm focus:ring-2 focus:ring-primary/20\"\r\n                        >\r\n                            <option value=\"created_at-desc\">{t('sort.newest')}</option>\r\n                            <option value=\"created_at-asc\">{t('sort.oldest')}</option>\r\n                            <option value=\"name-asc\">{t('sort.nameAZ')}</option>\r\n                            <option value=\"name-desc\">{t('sort.nameZA')}</option>\r\n                        </select>\r\n                        <ChevronDown className=\"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-text-light pointer-events-none\" />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* User Count */}\r\n            <div className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                {t('showing', { count: users.length, total: totalUsers })}\r\n            </div>\r\n\r\n            {/* Users Table */}\r\n            <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border overflow-hidden\">\r\n                {loading ? (\r\n                    <div className=\"flex items-center justify-center h-64\">\r\n                        <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\r\n                    </div>\r\n                ) : users.length === 0 ? (\r\n                    <div className=\"text-center py-12 text-text-light dark:text-dark-text-muted\">\r\n                        <Users className=\"w-12 h-12 mx-auto mb-4 opacity-30\" />\r\n                        <p>{t('noUsers')}</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"overflow-x-auto\">\r\n                        <table className=\"w-full\">\r\n                            <thead className=\"bg-gray-50 dark:bg-dark-border/50 border-b border-gray-200 dark:border-dark-border\">\r\n                                <tr>\r\n                                    <th className=\"px-4 py-3 text-start text-xs font-semibold text-text-light dark:text-dark-text-muted uppercase tracking-wider\">\r\n                                        {t('user')}\r\n                                    </th>\r\n                                    <th className=\"px-4 py-3 text-start text-xs font-semibold text-text-light dark:text-dark-text-muted uppercase tracking-wider\">\r\n                                        {t('role')}\r\n                                    </th>\r\n                                    <th className=\"px-4 py-3 text-start text-xs font-semibold text-text-light dark:text-dark-text-muted uppercase tracking-wider\">\r\n                                        {t('joined')}\r\n                                    </th>\r\n                                    <th className=\"px-4 py-3 text-start text-xs font-semibold text-text-light dark:text-dark-text-muted uppercase tracking-wider\">\r\n                                        {t('activity')}\r\n                                    </th>\r\n                                    <th className=\"px-4 py-3 text-end text-xs font-semibold text-text-light dark:text-dark-text-muted uppercase tracking-wider\">\r\n                                        {t('actions')}\r\n                                    </th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody className=\"divide-y divide-gray-100 dark:divide-dark-border\">\r\n                                {users.map((user) => (\r\n                                    <tr\r\n                                        key={user.id}\r\n                                        className=\"hover:bg-gray-50 dark:hover:bg-dark-border/30 transition-colors\"\r\n                                    >\r\n                                        <td className=\"px-4 py-3\">\r\n                                            <div className=\"flex items-center gap-3\">\r\n                                                <div className=\"w-10 h-10 rounded-full bg-gray-200 dark:bg-dark-border flex items-center justify-center overflow-hidden\">\r\n                                                    {user.avatar_url ? (\r\n                                                        <img\r\n                                                            src={user.avatar_url}\r\n                                                            alt=\"\"\r\n                                                            className=\"w-full h-full object-cover\"\r\n                                                        />\r\n                                                    ) : (\r\n                                                        <Users className=\"w-5 h-5 text-text-light dark:text-dark-text-muted\" />\r\n                                                    )}\r\n                                                </div>\r\n                                                <div>\r\n                                                    <p className=\"font-medium text-text dark:text-dark-text\">\r\n                                                        {user.name || tCommon('unknown')}\r\n                                                    </p>\r\n                                                    <p className=\"text-sm text-text-light dark:text-dark-text-muted flex items-center gap-1\">\r\n                                                        <Mail className=\"w-3 h-3\" />\r\n                                                        {user.email}\r\n                                                    </p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </td>\r\n                                        <td className=\"px-4 py-3\">\r\n                                            {getRoleBadge(user.role, user.is_verified_author, !!user.suspended_at)}\r\n                                        </td>\r\n                                        <td className=\"px-4 py-3 text-sm text-text-light dark:text-dark-text-muted\">\r\n                                            <div className=\"flex items-center gap-1\">\r\n                                                <Calendar className=\"w-3.5 h-3.5\" />\r\n                                                {format(new Date(user.created_at), 'MMM d, yyyy')}\r\n                                            </div>\r\n                                        </td>\r\n                                        <td className=\"px-4 py-3\">\r\n                                            <div className=\"flex items-center gap-4 text-sm text-text-light dark:text-dark-text-muted\">\r\n                                                <span className=\"flex items-center gap-1\" title={t('activity.posts')}>\r\n                                                    <FileText className=\"w-3.5 h-3.5\" />\r\n                                                    {user.post_count}\r\n                                                </span>\r\n                                                <span className=\"flex items-center gap-1\" title={t('activity.comments')}>\r\n                                                    <MessageSquare className=\"w-3.5 h-3.5\" />\r\n                                                    {user.comment_count}\r\n                                                </span>\r\n                                            </div>\r\n                                        </td>\r\n                                        <td className=\"px-4 py-3 text-right\">\r\n                                            <div className=\"relative inline-block\">\r\n                                                <button\r\n                                                    onClick={() => setShowActionMenu(showActionMenu === user.id ? null : user.id)}\r\n                                                    disabled={processingUserId === user.id}\r\n                                                    className=\"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-border transition-colors disabled:opacity-50\"\r\n                                                >\r\n                                                    {processingUserId === user.id ? (\r\n                                                        <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                                                    ) : (\r\n                                                        <MoreHorizontal className=\"w-4 h-4 text-text-light dark:text-dark-text-muted\" />\r\n                                                    )}\r\n                                                </button>\r\n\r\n                                                {showActionMenu === user.id && (\r\n                                                    <>\r\n                                                        <div\r\n                                                            className=\"fixed inset-0 z-10\"\r\n                                                            onClick={() => setShowActionMenu(null)}\r\n                                                        />\r\n                                                        <div className=\"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-dark-surface border border-gray-200 dark:border-dark-border rounded-lg shadow-lg z-20 py-1\">\r\n                                                            {/* Only show Change Role to admins */}\r\n                                                            {currentUserRole === 'admin' && (\r\n                                                                <button\r\n                                                                    onClick={() => handleRoleChange(user)}\r\n                                                                    className=\"w-full px-4 py-2 text-left text-sm text-text dark:text-dark-text hover:bg-gray-50 dark:hover:bg-dark-border flex items-center gap-2\"\r\n                                                                >\r\n                                                                    <Shield className=\"w-4 h-4\" />\r\n                                                                    {t('changeRole')}\r\n                                                                </button>\r\n                                                            )}\r\n                                                            {/* Moderators cannot suspend admins */}\r\n                                                            {!(currentUserRole === 'moderator' && user.role === 'admin') && (\r\n                                                                <button\r\n                                                                    onClick={() => handleSuspend(user)}\r\n                                                                    className={`w-full px-4 py-2 text-left text-sm flex items-center gap-2 ${user.suspended_at\r\n                                                                        ? 'text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20'\r\n                                                                        : 'text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20'\r\n                                                                        }`}\r\n                                                                >\r\n                                                                    {user.suspended_at ? (\r\n                                                                        <>\r\n                                                                            <CheckCircle className=\"w-4 h-4\" />\r\n                                                                            {t('unsuspend')}\r\n                                                                        </>\r\n                                                                    ) : (\r\n                                                                        <>\r\n                                                                            <Ban className=\"w-4 h-4\" />\r\n                                                                            {t('suspend')}\r\n                                                                        </>\r\n                                                                    )}\r\n                                                                </button>\r\n                                                            )}\r\n                                                        </div>\r\n                                                    </>\r\n                                                )}\r\n                                            </div>\r\n                                        </td>\r\n                                    </tr>\r\n                                ))}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Pagination */}\r\n            {totalPages > 1 && (\r\n                <div className=\"flex items-center justify-between\">\r\n                    <p className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                        {tCommon('pagination', { current: page, total: totalPages })}\r\n                    </p>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={() => setPage(p => Math.max(1, p - 1))}\r\n                            disabled={page === 1 || loading}\r\n                        >\r\n                            <ChevronLeft className=\"w-4 h-4\" />\r\n                            {tCommon('previous')}\r\n                        </Button>\r\n                        <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={() => setPage(p => Math.min(totalPages, p + 1))}\r\n                            disabled={page === totalPages || loading}\r\n                        >\r\n                            {tCommon('next')}\r\n                            <ChevronRight className=\"w-4 h-4\" />\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Role Change Dialog */}\r\n            {selectedUser && (\r\n                <RolePromotionDialog\r\n                    open={showRoleDialog}\r\n                    onOpenChange={setShowRoleDialog}\r\n                    user={selectedUser}\r\n                    onSuccess={() => {\r\n                        loadUsers()\r\n                        setSelectedUser(null)\r\n                    }}\r\n                />\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\admin\\coordination\\CoordinationCenter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\admin\\coordination\\NewMessageForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\admin\\coordination\\NewThreadDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\admin\\coordination\\ThreadView.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadThread'. Either include it or remove the dependency array.","line":143,"column":8,"nodeType":"ArrayExpression","endLine":143,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [loadThread, threadId]","fix":{"range":[4805,4815],"text":"[loadThread, threadId]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect, useMemo } from 'react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { useToast } from '@/components/ui/toast'\r\nimport {\r\n    ArrowLeft,\r\n    FileText,\r\n    User,\r\n    MessagesSquare,\r\n    AlertTriangle,\r\n    MessageSquareWarning,\r\n    Calendar,\r\n    Clock,\r\n    Archive,\r\n    ChevronDown,\r\n    Send,\r\n    Loader2,\r\n    Shield,\r\n    Flag,\r\n    CheckCircle,\r\n    XCircle,\r\n    HelpCircle,\r\n    ArrowUpRight\r\n} from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { format, formatDistanceToNow } from 'date-fns'\r\nimport { cn } from '@/lib/utils'\r\nimport { NewMessageForm } from './NewMessageForm'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface ThreadMessage {\r\n    id: string\r\n    author_id: string\r\n    author_name: string | null\r\n    author_role: string\r\n    message_type: string\r\n    content: string\r\n    action_type: string | null\r\n    action_data: any\r\n    action_executed: boolean\r\n    action_executed_at: string | null\r\n    action_result: any\r\n    decision_confidence: string | null\r\n    review_pending: boolean\r\n    review_pending_until: string | null\r\n    review_completed_at: string | null\r\n    old_state: string | null\r\n    new_state: string | null\r\n    version: number\r\n    is_current_version: boolean\r\n    created_at: string\r\n}\r\n\r\ninterface Thread {\r\n    id: string\r\n    object_type: string\r\n    object_id: string\r\n    title: string\r\n    description: string | null\r\n    object_state: string\r\n    priority: string\r\n    trigger_event: string\r\n    created_by: string\r\n    created_by_name: string | null\r\n    archived_at: string | null\r\n    archive_reason: string | null\r\n    created_at: string\r\n    updated_at: string\r\n}\r\n\r\ninterface ThreadViewProps {\r\n    threadId: string\r\n    isAdmin: boolean\r\n    onBack: () => void\r\n}\r\n\r\nconst messageTypeConfig: Record<string, { icon: typeof FileText; color: string; labelKey: string }> = {\r\n    NOTE: { icon: FileText, color: 'bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300', labelKey: 'messageTypes.note' },\r\n    FLAG: { icon: Flag, color: 'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300', labelKey: 'messageTypes.flag' },\r\n    DECISION: { icon: CheckCircle, color: 'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300', labelKey: 'messageTypes.decision' },\r\n    RATIONALE: { icon: HelpCircle, color: 'bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300', labelKey: 'messageTypes.rationale' },\r\n    REQUEST_REVIEW: { icon: ArrowUpRight, color: 'bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300', labelKey: 'messageTypes.request_review' }\r\n}\r\n\r\nconst objectTypeIcons: Record<string, typeof FileText> = {\r\n    post: FileText,\r\n    user: User,\r\n    comment: MessagesSquare,\r\n    report: AlertTriangle,\r\n    appeal: MessageSquareWarning,\r\n    event: Calendar,\r\n    resource: FileText\r\n}\r\n\r\nconst stateColors: Record<string, string> = {\r\n    ACTIVE: 'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300',\r\n    UNDER_REVIEW: 'bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300',\r\n    CONTESTED: 'bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300',\r\n    REVOKED: 'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300',\r\n    ARCHIVED: 'bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300'\r\n}\r\n\r\nconst confidenceColors: Record<string, string> = {\r\n    confident: 'text-green-600 dark:text-green-400',\r\n    provisional: 'text-yellow-600 dark:text-yellow-400',\r\n    contested: 'text-red-600 dark:text-red-400'\r\n}\r\n\r\nexport function ThreadView({ threadId, isAdmin, onBack }: ThreadViewProps) {\r\n    const [thread, setThread] = useState<Thread | null>(null)\r\n    const [messages, setMessages] = useState<ThreadMessage[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [archiving, setArchiving] = useState(false)\r\n    const [showArchiveDialog, setShowArchiveDialog] = useState(false)\r\n    const [archiveReason, setArchiveReason] = useState('')\r\n\r\n    const supabase = useMemo(() => createClient(), [])\r\n    const { showToast } = useToast()\r\n    const t = useTranslations('Coordination')\r\n\r\n    const loadThread = async () => {\r\n        setLoading(true)\r\n        try {\r\n            const response = await fetch(`/api/coordination/${threadId}`)\r\n            const data = await response.json()\r\n\r\n            if (!response.ok) {\r\n                throw new Error(data.error || t('loadError'))\r\n            }\r\n\r\n            setThread(data.thread)\r\n            setMessages(data.messages || [])\r\n        } catch (error: any) {\r\n            showToast(error.message, 'error')\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        loadThread()\r\n    }, [threadId])\r\n\r\n    const handleArchive = async () => {\r\n        if (!isAdmin) return\r\n\r\n        setArchiving(true)\r\n        try {\r\n            const response = await fetch(`/api/coordination/${threadId}`, {\r\n                method: 'PATCH',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ action: 'archive', reason: archiveReason })\r\n            })\r\n            const data = await response.json()\r\n\r\n            if (!response.ok) {\r\n                throw new Error(data.error || t('loadError'))\r\n            }\r\n\r\n            showToast(t('archiveSuccess'), 'success')\r\n            onBack()\r\n        } catch (error: any) {\r\n            showToast(error.message, 'error')\r\n        } finally {\r\n            setArchiving(false)\r\n            setShowArchiveDialog(false)\r\n        }\r\n    }\r\n\r\n    const handleMessageAdded = () => {\r\n        loadThread()\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    if (!thread) {\r\n        return (\r\n            <div className=\"text-center py-12\">\r\n                <p className=\"text-text-light dark:text-dark-text-muted\">{t('threadNotFound')}</p>\r\n                <Button variant=\"ghost\" onClick={onBack} className=\"mt-4\">\r\n                    <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n                    {t('backToThreads')}\r\n                </Button>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const ObjectIcon = objectTypeIcons[thread.object_type] || FileText\r\n\r\n    const getStateLabel = (state: string) => {\r\n        switch (state) {\r\n            case 'UNDER_REVIEW': return t('underReview')\r\n            case 'CONTESTED': return t('contested')\r\n            case 'REVOKED': return t('revoked')\r\n            case 'ACTIVE': return t('active')\r\n            case 'ARCHIVED': return t('archived')\r\n            default: return state.replace('_', ' ')\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Header */}\r\n            <div className=\"flex items-start justify-between gap-4\">\r\n                <div className=\"flex-1\">\r\n                    <Button variant=\"ghost\" size=\"sm\" onClick={onBack} className=\"mb-2 -ml-2\">\r\n                        <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n                        {t('backToThreads')}\r\n                    </Button>\r\n                    <div className=\"flex items-center gap-2 mb-2\">\r\n                        <ObjectIcon className=\"w-5 h-5 text-text-light dark:text-dark-text-muted\" />\r\n                        <span className={cn('px-2 py-0.5 rounded-full text-xs font-medium', stateColors[thread.object_state])}>\r\n                            {getStateLabel(thread.object_state)}\r\n                        </span>\r\n                        {thread.archived_at && (\r\n                            <span className=\"flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300\">\r\n                                <Archive className=\"w-3 h-3\" />\r\n                                {t('archived')}\r\n                            </span>\r\n                        )}\r\n                    </div>\r\n                    <h2 className=\"text-xl font-display font-semibold text-text dark:text-dark-text\">\r\n                        {thread.title}\r\n                    </h2>\r\n                    {thread.description && (\r\n                        <p className=\"text-sm text-text-light dark:text-dark-text-muted mt-1\">\r\n                            {thread.description}\r\n                        </p>\r\n                    )}\r\n                    <p className=\"text-xs text-text-light dark:text-dark-text-muted mt-2\">\r\n                        {t('createdWithMessages', {\r\n                            name: thread.created_by_name || t('system'),\r\n                            count: messages.length,\r\n                            date: format(new Date(thread.created_at), 'PPP')\r\n                        })}\r\n                    </p>\r\n                </div>\r\n                {isAdmin && !thread.archived_at && (\r\n                    <Button variant=\"outline\" size=\"sm\" onClick={() => setShowArchiveDialog(true)}>\r\n                        <Archive className=\"w-4 h-4 mr-2\" />\r\n                        {t('archiveThread')}\r\n                    </Button>\r\n                )}\r\n            </div>\r\n\r\n            {/* Timeline */}\r\n            <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border overflow-hidden\">\r\n                <div className=\"p-4 border-b border-gray-100 dark:border-dark-border\">\r\n                    <h3 className=\"font-medium text-text dark:text-dark-text flex items-center gap-2\">\r\n                        <MessagesSquare className=\"w-4 h-4\" />\r\n                        {t('timeline')} {t('entries', { count: messages.length })}\r\n                    </h3>\r\n                </div>\r\n\r\n                <div className=\"divide-y divide-gray-100 dark:divide-dark-border\">\r\n                    {messages.map((message, index) => {\r\n                        const config = messageTypeConfig[message.message_type] || messageTypeConfig.NOTE\r\n                        const TypeIcon = config.icon\r\n\r\n                        return (\r\n                            <div key={message.id} className=\"p-4\">\r\n                                {/* State change indicator */}\r\n                                {message.old_state && message.new_state && message.old_state !== message.new_state && (\r\n                                    <div className=\"mb-3 flex items-center justify-center\">\r\n                                        <div className=\"flex items-center gap-2 px-3 py-1 rounded-full bg-gray-50 dark:bg-dark-border text-xs\">\r\n                                            <span className={cn('px-1.5 py-0.5 rounded', stateColors[message.old_state])}>\r\n                                                {getStateLabel(message.old_state)}\r\n                                            </span>\r\n                                            <span className=\"text-text-light dark:text-dark-text-muted\">ΓåÆ</span>\r\n                                            <span className={cn('px-1.5 py-0.5 rounded', stateColors[message.new_state])}>\r\n                                                {getStateLabel(message.new_state)}\r\n                                            </span>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                <div className=\"flex items-start gap-3\">\r\n                                    <div className=\"flex-shrink-0 mt-1\">\r\n                                        <div className={cn('w-8 h-8 rounded-full flex items-center justify-center', config.color)}>\r\n                                            <TypeIcon className=\"w-4 h-4\" />\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex-1 min-w-0\">\r\n                                        <div className=\"flex items-center gap-2 mb-1\">\r\n                                            <span className=\"font-medium text-text dark:text-dark-text\">\r\n                                                {message.author_name || t('unknown')}\r\n                                            </span>\r\n                                            <span className={cn('px-1.5 py-0.5 rounded text-xs', config.color)}>\r\n                                                {t(config.labelKey as any)}\r\n                                            </span>\r\n                                            {message.decision_confidence && (\r\n                                                <span className={cn('text-xs font-medium', confidenceColors[message.decision_confidence])}>\r\n                                                    ({t(`confidences.${message.decision_confidence}` as any)})\r\n                                                </span>\r\n                                            )}\r\n                                            {message.review_pending && (\r\n                                                <span className=\"px-1.5 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300\">\r\n                                                    ΓÅ│ {t('reviewPending')}\r\n                                                </span>\r\n                                            )}\r\n                                            <span className=\"text-xs text-text-light dark:text-dark-text-muted\">\r\n                                                {formatDistanceToNow(new Date(message.created_at), { addSuffix: true })}\r\n                                            </span>\r\n                                        </div>\r\n                                        <p className=\"text-text dark:text-dark-text whitespace-pre-wrap\">\r\n                                            {message.content}\r\n                                        </p>\r\n                                        {message.action_type && (\r\n                                            <div className=\"mt-2 p-2 rounded bg-gray-50 dark:bg-dark-border text-sm\">\r\n                                                <span className=\"font-medium text-text dark:text-dark-text\">\r\n                                                    {t('action')}: {message.action_type.replace(/_/g, ' ')}\r\n                                                </span>\r\n                                                {message.action_executed && (\r\n                                                    <span className=\"ml-2 text-green-600 dark:text-green-400\">Γ£ô {t('executed')}</span>\r\n                                                )}\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )\r\n                    })}\r\n                </div>\r\n\r\n                {/* New Message Form */}\r\n                {!thread.archived_at && (\r\n                    <div className=\"border-t border-gray-100 dark:border-dark-border\">\r\n                        <NewMessageForm\r\n                            threadId={threadId}\r\n                            isAdmin={isAdmin}\r\n                            currentState={thread.object_state}\r\n                            onSuccess={handleMessageAdded}\r\n                        />\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Archive Dialog */}\r\n            {showArchiveDialog && (\r\n                <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\r\n                    <div className=\"bg-white dark:bg-dark-surface rounded-xl p-6 w-full max-w-md mx-4\">\r\n                        <h3 className=\"text-lg font-semibold text-text dark:text-dark-text mb-2\">\r\n                            {t('archiveThread')}\r\n                        </h3>\r\n                        <p className=\"text-sm text-text-light dark:text-dark-text-muted mb-4\">\r\n                            {t('archiveDescription')}\r\n                        </p>\r\n                        <textarea\r\n                            placeholder={t('archiveReasonPlaceholder')}\r\n                            value={archiveReason}\r\n                            onChange={(e) => setArchiveReason(e.target.value)}\r\n                            className=\"w-full p-3 border border-gray-200 dark:border-dark-border rounded-lg bg-white dark:bg-dark-bg text-text dark:text-dark-text mb-4 resize-none outline-none focus:ring-2 focus:ring-primary/20\"\r\n                            rows={3}\r\n                        />\r\n                        <div className=\"flex gap-2 justify-end\">\r\n                            <Button variant=\"ghost\" onClick={() => setShowArchiveDialog(false)}>\r\n                                {t('Common.cancel' as any)}\r\n                            </Button>\r\n                            <Button onClick={handleArchive} disabled={archiving}>\r\n                                {archiving && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\r\n                                {t('archiveThread')}\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\admin\\coordination\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\admin\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\feedback\\FeedbackButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\feedback\\FeedbackDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\feedback\\FeedbackList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\feedback\\FeedbackSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\feedback\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\research-lab\\PollsList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\research-lab\\QuestionAdvisor.tsx","messages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useRefinedVersion\" cannot be called inside a callback. React Hooks must be called in a React function component or a custom React Hook function.","line":301,"column":64,"nodeType":"Identifier","endLine":301,"endColumn":81}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState } from 'react'\r\nimport {\r\n    Sparkles,\r\n    Send,\r\n    Loader2,\r\n    AlertCircle,\r\n    CheckCircle,\r\n    Lightbulb,\r\n    Scale,\r\n    Target,\r\n    RefreshCw,\r\n    Copy,\r\n    Check,\r\n    Zap\r\n} from 'lucide-react'\r\nimport { useToast } from '@/components/ui/toast'\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface QuestionAdvisorProps {\r\n    userId?: string\r\n    usageLimits?: {\r\n        can_use: boolean\r\n        daily_remaining: number\r\n        monthly_remaining: number\r\n        reset_at: string\r\n    }\r\n}\r\n\r\ninterface AnalysisResult {\r\n    clarity_score: number\r\n    scope_analysis: {\r\n        assessment: 'too_broad' | 'too_narrow' | 'appropriate'\r\n        explanation: string\r\n    }\r\n    bias_detection: {\r\n        has_bias: boolean\r\n        biases: string[]\r\n    }\r\n    measurability: {\r\n        score: number\r\n        explanation: string\r\n    }\r\n    suggestions: string[]\r\n    refined_versions: string[]\r\n}\r\n\r\nexport function QuestionAdvisor({ userId, usageLimits }: QuestionAdvisorProps) {\r\n    const t = useTranslations('ResearchSearch')\r\n    const tCommon = useTranslations('Common')\r\n    const [question, setQuestion] = useState('')\r\n    const [context, setContext] = useState('')\r\n    const [analyzing, setAnalyzing] = useState(false)\r\n    const [result, setResult] = useState<AnalysisResult | null>(null)\r\n    const [copiedIndex, setCopiedIndex] = useState<number | null>(null)\r\n    const [remainingUses, setRemainingUses] = useState(usageLimits?.daily_remaining ?? 10)\r\n    const { showToast } = useToast()\r\n\r\n    const handleAnalyze = async () => {\r\n        if (!question.trim()) {\r\n            showToast('Please enter a research question', 'error')\r\n            return\r\n        }\r\n\r\n        if (!userId) {\r\n            showToast('Please log in to use the Question Advisor', 'error')\r\n            return\r\n        }\r\n\r\n        if (remainingUses <= 0) {\r\n            showToast('Daily limit reached. Try again tomorrow!', 'error')\r\n            return\r\n        }\r\n\r\n        setAnalyzing(true)\r\n\r\n        try {\r\n            const response = await fetch('/api/question-advisor', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ question, context })\r\n            })\r\n\r\n            if (!response.ok) {\r\n                const error = await response.json()\r\n                throw new Error(error.message || 'Failed to analyze question')\r\n            }\r\n\r\n            const data = await response.json()\r\n            setResult(data)\r\n            setRemainingUses(prev => Math.max(0, prev - 1))\r\n        } catch (error: any) {\r\n            showToast(error.message || 'Failed to analyze question', 'error')\r\n        } finally {\r\n            setAnalyzing(false)\r\n        }\r\n    }\r\n\r\n    const copyToClipboard = (text: string, index: number) => {\r\n        navigator.clipboard.writeText(text)\r\n        setCopiedIndex(index)\r\n        setTimeout(() => setCopiedIndex(null), 2000)\r\n        showToast('Copied to clipboard!', 'success')\r\n    }\r\n\r\n    const useRefinedVersion = (text: string) => {\r\n        setQuestion(text)\r\n        setResult(null)\r\n        showToast('Question updated!', 'success')\r\n    }\r\n\r\n    const getScoreColor = (score: number) => {\r\n        if (score >= 80) return 'text-emerald-500'\r\n        if (score >= 60) return 'text-amber-500'\r\n        return 'text-red-500'\r\n    }\r\n\r\n    const getScoreBg = (score: number) => {\r\n        if (score >= 80) return 'bg-emerald-100 dark:bg-emerald-900/30'\r\n        if (score >= 60) return 'bg-amber-100 dark:bg-amber-900/30'\r\n        return 'bg-red-100 dark:bg-red-900/30'\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <div className=\"mb-8\">\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                    <h1 className=\"text-2xl font-display font-bold text-text dark:text-dark-text flex items-center gap-2\">\r\n                        <Sparkles className=\"w-6 h-6 text-amber-500\" />\r\n                        {t('questionAdvisor')}\r\n                    </h1>\r\n                    <div className=\"flex items-center gap-2 text-sm text-text-light dark:text-dark-text-muted\">\r\n                        <Zap className=\"w-4 h-4\" />\r\n                        {remainingUses} uses remaining today\r\n                    </div>\r\n                </div>\r\n                <p className=\"text-text-light dark:text-dark-text-muted\">\r\n                    AI-powered analysis to refine your research questions for clarity, scope, and measurability\r\n                </p>\r\n            </div>\r\n\r\n            <div className=\"grid lg:grid-cols-[1fr_400px] gap-6\">\r\n                {/* Input Section */}\r\n                <div className=\"space-y-6\">\r\n                    <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-6\">\r\n                        <label className=\"block text-sm font-medium text-text dark:text-dark-text mb-2\">\r\n                            {t('researchQuestion')}\r\n                        </label>\r\n                        <textarea\r\n                            value={question}\r\n                            onChange={(e) => setQuestion(e.target.value)}\r\n                            placeholder=\"Enter your research question here...\"\r\n                            rows={4}\r\n                            className=\"w-full px-4 py-3 border border-gray-200 dark:border-dark-border rounded-lg bg-white dark:bg-dark-bg text-text dark:text-dark-text placeholder-text-light dark:placeholder-dark-text-muted focus:ring-2 focus:ring-primary focus:border-transparent resize-none text-lg\"\r\n                        />\r\n\r\n                        <label className=\"block text-sm font-medium text-text dark:text-dark-text mb-2 mt-4\">\r\n                            {t('contextOptional')}\r\n                        </label>\r\n                        <textarea\r\n                            value={context}\r\n                            onChange={(e) => setContext(e.target.value)}\r\n                            placeholder=\"Provide additional context about your research field, methodology, or constraints...\"\r\n                            rows={2}\r\n                            className=\"w-full px-3 py-2 border border-gray-200 dark:border-dark-border rounded-lg bg-white dark:bg-dark-bg text-text dark:text-dark-text placeholder-text-light dark:placeholder-dark-text-muted focus:ring-2 focus:ring-primary focus:border-transparent resize-none\"\r\n                        />\r\n\r\n                        <button\r\n                            onClick={handleAnalyze}\r\n                            disabled={analyzing || !question.trim() || remainingUses <= 0}\r\n                            className=\"btn btn-primary w-full mt-4\"\r\n                        >\r\n                            {analyzing ? (\r\n                                <>\r\n                                    <Loader2 className=\"w-4 h-4 animate-spin mr-2\" />\r\n                                    Analyzing...\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <Send className=\"w-4 h-4 mr-2\" />\r\n                                    {t('analyzeQuestion')}\r\n                                </>\r\n                            )}\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Results */}\r\n                    {result && (\r\n                        <div className=\"space-y-4\">\r\n                            {/* Scores Overview */}\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <ScoreCard\r\n                                    label={t('clarityScore')}\r\n                                    score={result.clarity_score}\r\n                                    icon={CheckCircle}\r\n                                />\r\n                                <ScoreCard\r\n                                    label={t('measurability')}\r\n                                    score={result.measurability.score}\r\n                                    icon={Target}\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Scope Analysis */}\r\n                            <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-5\">\r\n                                <div className=\"flex items-center gap-2 mb-3\">\r\n                                    <Scale className=\"w-5 h-5 text-blue-500\" />\r\n                                    <h3 className=\"font-semibold text-text dark:text-dark-text\">\r\n                                        Scope Analysis\r\n                                    </h3>\r\n                                    <span className={`\r\n                                        px-2 py-0.5 rounded-full text-xs font-medium\r\n                                        ${result.scope_analysis.assessment === 'appropriate'\r\n                                            ? 'bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400'\r\n                                            : 'bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400'\r\n                                        }\r\n                                    `}>\r\n                                        {result.scope_analysis.assessment.replace('_', ' ')}\r\n                                    </span>\r\n                                </div>\r\n                                <p className=\"text-text-light dark:text-dark-text-muted\">\r\n                                    {result.scope_analysis.explanation}\r\n                                </p>\r\n                            </div>\r\n\r\n                            {/* Bias Detection */}\r\n                            {result.bias_detection.has_bias && (\r\n                                <div className=\"bg-amber-50 dark:bg-amber-900/20 rounded-xl border border-amber-200 dark:border-amber-800 p-5\">\r\n                                    <div className=\"flex items-center gap-2 mb-3\">\r\n                                        <AlertCircle className=\"w-5 h-5 text-amber-600\" />\r\n                                        <h3 className=\"font-semibold text-amber-800 dark:text-amber-200\">\r\n                                            Potential Biases Detected\r\n                                        </h3>\r\n                                    </div>\r\n                                    <ul className=\"space-y-2\">\r\n                                        {result.bias_detection.biases.map((bias, i) => (\r\n                                            <li key={i} className=\"flex items-start gap-2 text-sm text-amber-700 dark:text-amber-300\">\r\n                                                <span className=\"mt-1.5 w-1.5 h-1.5 rounded-full bg-amber-500 flex-shrink-0\" />\r\n                                                {bias}\r\n                                            </li>\r\n                                        ))}\r\n                                    </ul>\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Suggestions */}\r\n                            {result.suggestions.length > 0 && (\r\n                                <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-5\">\r\n                                    <div className=\"flex items-center gap-2 mb-3\">\r\n                                        <Lightbulb className=\"w-5 h-5 text-amber-500\" />\r\n                                        <h3 className=\"font-semibold text-text dark:text-dark-text\">\r\n                                            Suggestions\r\n                                        </h3>\r\n                                    </div>\r\n                                    <ul className=\"space-y-2\">\r\n                                        {result.suggestions.map((suggestion, i) => (\r\n                                            <li key={i} className=\"flex items-start gap-2 text-sm text-text-light dark:text-dark-text-muted\">\r\n                                                <span className=\"mt-1.5 w-1.5 h-1.5 rounded-full bg-primary flex-shrink-0\" />\r\n                                                {suggestion}\r\n                                            </li>\r\n                                        ))}\r\n                                    </ul>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Refined Versions Sidebar */}\r\n                <div className=\"space-y-4\">\r\n                    <div className=\"bg-gradient-to-br from-primary/5 to-purple-50 dark:from-primary/10 dark:to-purple-900/10 rounded-xl border border-gray-200 dark:border-dark-border p-5\">\r\n                        <h3 className=\"font-semibold text-text dark:text-dark-text mb-3 flex items-center gap-2\">\r\n                            <RefreshCw className=\"w-5 h-5 text-primary\" />\r\n                            Refined Alternatives\r\n                        </h3>\r\n\r\n                        {result?.refined_versions && result.refined_versions.length > 0 ? (\r\n                            <div className=\"space-y-3\">\r\n                                {result.refined_versions.map((version, i) => (\r\n                                    <div\r\n                                        key={i}\r\n                                        className=\"bg-white dark:bg-dark-surface rounded-lg p-4 border border-gray-100 dark:border-dark-border\"\r\n                                    >\r\n                                        <p className=\"text-sm text-text dark:text-dark-text mb-3\">\r\n                                            {version}\r\n                                        </p>\r\n                                        <div className=\"flex gap-2\">\r\n                                            <button\r\n                                                onClick={() => copyToClipboard(version, i)}\r\n                                                className=\"flex items-center gap-1.5 px-2 py-1 text-xs text-text-light dark:text-dark-text-muted hover:text-primary transition-colors\"\r\n                                            >\r\n                                                {copiedIndex === i ? (\r\n                                                    <Check className=\"w-3.5 h-3.5\" />\r\n                                                ) : (\r\n                                                    <Copy className=\"w-3.5 h-3.5\" />\r\n                                                )}\r\n                                                Copy\r\n                                            </button>\r\n                                            <button\r\n                                                onClick={() => useRefinedVersion(version)}\r\n                                                className=\"flex items-center gap-1.5 px-2 py-1 text-xs text-primary hover:underline\"\r\n                                            >\r\n                                                <RefreshCw className=\"w-3.5 h-3.5\" />\r\n                                                Use this\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        ) : (\r\n                            <p className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                                Analyze your question to get refined alternatives\r\n                            </p>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Tips Card */}\r\n                    <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-5\">\r\n                        <h3 className=\"font-semibold text-text dark:text-dark-text mb-3\">\r\n                            Tips for Good Research Questions\r\n                        </h3>\r\n                        <ul className=\"space-y-2 text-sm text-text-light dark:text-dark-text-muted\">\r\n                            <li className=\"flex items-start gap-2\">\r\n                                <CheckCircle className=\"w-4 h-4 text-emerald-500 mt-0.5 flex-shrink-0\" />\r\n                                Be specific and focused\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                                <CheckCircle className=\"w-4 h-4 text-emerald-500 mt-0.5 flex-shrink-0\" />\r\n                                Use clear, unambiguous language\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                                <CheckCircle className=\"w-4 h-4 text-emerald-500 mt-0.5 flex-shrink-0\" />\r\n                                Ensure it&apos;s measurable or testable\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                                <CheckCircle className=\"w-4 h-4 text-emerald-500 mt-0.5 flex-shrink-0\" />\r\n                                Avoid leading or loaded terms\r\n                            </li>\r\n                            <li className=\"flex items-start gap-2\">\r\n                                <CheckCircle className=\"w-4 h-4 text-emerald-500 mt-0.5 flex-shrink-0\" />\r\n                                Define your scope clearly\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction ScoreCard({ label, score, icon: Icon }: { label: string; score: number; icon: any }) {\r\n    const getScoreColor = (score: number) => {\r\n        if (score >= 80) return 'text-emerald-500'\r\n        if (score >= 60) return 'text-amber-500'\r\n        return 'text-red-500'\r\n    }\r\n\r\n    const getScoreBg = (score: number) => {\r\n        if (score >= 80) return 'bg-emerald-100 dark:bg-emerald-900/30'\r\n        if (score >= 60) return 'bg-amber-100 dark:bg-amber-900/30'\r\n        return 'bg-red-100 dark:bg-red-900/30'\r\n    }\r\n\r\n    return (\r\n        <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-5\">\r\n            <div className=\"flex items-center gap-2 mb-3\">\r\n                <Icon className={`w-5 h-5 ${getScoreColor(score)}`} />\r\n                <span className=\"text-sm text-text-light dark:text-dark-text-muted\">\r\n                    {label}\r\n                </span>\r\n            </div>\r\n            <div className=\"flex items-end gap-2\">\r\n                <span className={`text-3xl font-bold ${getScoreColor(score)}`}>\r\n                    {score}\r\n                </span>\r\n                <span className=\"text-text-light dark:text-dark-text-muted text-sm pb-1\">\r\n                    / 100\r\n                </span>\r\n            </div>\r\n            <div className=\"mt-3 h-2 bg-gray-100 dark:bg-dark-bg rounded-full overflow-hidden\">\r\n                <div\r\n                    className={`h-full rounded-full transition-all ${getScoreBg(score).replace('bg-', 'bg-')}`}\r\n                    style={{ width: `${score}%`, backgroundColor: score >= 80 ? '#10B981' : score >= 60 ? '#F59E0B' : '#EF4444' }}\r\n                />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\research-lab\\ResearchLabNav.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\research-lab\\ResearchSearchEngine.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":353,"column":64,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15751,15880],"text":"\r\n                                Search for something and click &quot;Save This Search\" to save it here\r\n                            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15751,15880],"text":"\r\n                                Search for something and click &ldquo;Save This Search\" to save it here\r\n                            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15751,15880],"text":"\r\n                                Search for something and click &#34;Save This Search\" to save it here\r\n                            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15751,15880],"text":"\r\n                                Search for something and click &rdquo;Save This Search\" to save it here\r\n                            "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":353,"column":81,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[15751,15880],"text":"\r\n                                Search for something and click \"Save This Search&quot; to save it here\r\n                            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[15751,15880],"text":"\r\n                                Search for something and click \"Save This Search&ldquo; to save it here\r\n                            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[15751,15880],"text":"\r\n                                Search for something and click \"Save This Search&#34; to save it here\r\n                            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[15751,15880],"text":"\r\n                                Search for something and click \"Save This Search&rdquo; to save it here\r\n                            "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useCallback } from 'react'\r\nimport { Search, Filter, Loader2, ChevronDown, X, Info, AlertTriangle, Link2, Quote, FileDown, Bookmark, ExternalLink, MoreHorizontal, Globe, Database, History, Copy, Plus, GitBranch, Check, Clock } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { TrustBadge } from '@/components/TrustProfileCard'\r\nimport { InlineConflictBadge } from '@/components/ConflictWarning'\r\nimport Link from 'next/link'\r\nimport type {\r\n    SearchResult, SearchFilters, Discipline, EvidenceTier, ConflictPhase,\r\n    DisciplineCategory\r\n} from '@/types/advanced'\r\n\r\n// Discipline categories for filter UI\r\nconst DISCIPLINE_CATEGORIES: { id: DisciplineCategory; name: string; disciplines: Discipline[] }[] = [\r\n    { id: 'built_environment', name: 'Built Environment', disciplines: ['architecture', 'structural_engineering', 'urban_planning', 'heritage_conservation', 'construction_methods'] },\r\n    { id: 'earth_spatial', name: 'Earth & Spatial', disciplines: ['gis_remote_sensing', 'topography_surveying', 'environmental_science', 'hydrology_climate'] },\r\n    { id: 'data_tech', name: 'Data & Tech', disciplines: ['digital_twins', 'bim_scan', 'ai_ml', 'iot_monitoring', 'simulation_modelling'] },\r\n    { id: 'socio_political', name: 'Socio-Political', disciplines: ['governance_policy', 'housing_land_property', 'legal_frameworks', 'economics_financing'] },\r\n    { id: 'human_cultural', name: 'Human & Cultural', disciplines: ['sociology', 'anthropology', 'oral_history', 'memory_documentation', 'conflict_studies'] },\r\n    { id: 'transitional', name: 'Transitional', disciplines: ['shelter_housing', 'water_sanitation', 'energy_infrastructure', 'transport_logistics'] },\r\n]\r\n\r\nconst EVIDENCE_TIERS: { value: EvidenceTier; label: string; description: string }[] = [\r\n    { value: 'primary', label: 'Primary', description: 'Field surveys, scans, photos' },\r\n    { value: 'secondary', label: 'Secondary', description: 'Papers, reports, documents' },\r\n    { value: 'derived', label: 'Derived', description: 'Models, simulations, AI' },\r\n    { value: 'interpretive', label: 'Interpretive', description: 'Analysis, commentary' },\r\n]\r\n\r\nconst CONFLICT_PHASES: { value: ConflictPhase; label: string }[] = [\r\n    { value: 'pre_conflict', label: 'Pre-2011' },\r\n    { value: 'active_conflict', label: 'Conflict (2011-2020)' },\r\n    { value: 'de_escalation', label: 'De-escalation' },\r\n    { value: 'early_reconstruction', label: 'Early Reconstruction' },\r\n    { value: 'active_reconstruction', label: 'Active Reconstruction' },\r\n]\r\n\r\n// Utility to strip Markdown formatting from text\r\nfunction stripMarkdown(text: string): string {\r\n    if (!text) return ''\r\n    return text\r\n        // Remove headers (## Header)\r\n        .replace(/^#{1,6}\\s+/gm, '')\r\n        // Remove bold/italic (**text**, *text*, __text__, _text_)\r\n        .replace(/(\\*\\*|__)(.*?)\\1/g, '$2')\r\n        .replace(/(\\*|_)(.*?)\\1/g, '$2')\r\n        // Remove links [text](url)\r\n        .replace(/\\[([^\\]]+)\\]\\([^)]+\\)/g, '$1')\r\n        // Remove inline code `code`\r\n        .replace(/`([^`]+)`/g, '$1')\r\n        // Remove images ![alt](url)\r\n        .replace(/!\\[([^\\]]*)\\]\\([^)]+\\)/g, '$1')\r\n        // Remove horizontal rules\r\n        .replace(/^[-*_]{3,}\\s*$/gm, '')\r\n        // Remove blockquotes\r\n        .replace(/^>\\s+/gm, '')\r\n        // Remove list markers\r\n        .replace(/^[\\s]*[-*+]\\s+/gm, '')\r\n        .replace(/^[\\s]*\\d+\\.\\s+/gm, '')\r\n        // Clean up extra whitespace\r\n        .replace(/\\n{2,}/g, ' ')\r\n        .replace(/\\s{2,}/g, ' ')\r\n        .trim()\r\n}\r\n\r\nexport function ResearchSearchEngine() {\r\n    const [query, setQuery] = useState('')\r\n    const [filters, setFilters] = useState<SearchFilters>({})\r\n    const [results, setResults] = useState<SearchResult[]>([])\r\n    const [webResults, setWebResults] = useState<WebSearchResult[]>([])\r\n    const [loading, setLoading] = useState(false)\r\n    const [showFilters, setShowFilters] = useState(false)\r\n    const [searchDuration, setSearchDuration] = useState<number | null>(null)\r\n    const [expandedResult, setExpandedResult] = useState<string | null>(null)\r\n    const [searchSource, setSearchSource] = useState<'internal' | 'web' | 'all'>('all')\r\n    const [savedSearches, setSavedSearches] = useState<SavedSearch[]>([])\r\n    const [loadingSaved, setLoadingSaved] = useState(false)\r\n    const [copiedId, setCopiedId] = useState<string | null>(null)\r\n    const [activeTab, setActiveTab] = useState<'search' | 'saved'>('search')\r\n    const [savingSearch, setSavingSearch] = useState(false)\r\n    const [isFromCache, setIsFromCache] = useState(false) // Track if results are from cache\r\n\r\n    // Saved search type (matches database schema)\r\n    interface SavedSearch {\r\n        id: string\r\n        query: string\r\n        filters: SearchFilters\r\n        source_type: 'internal' | 'web' | 'all'\r\n        result_count: number\r\n        title?: string\r\n        notes?: string\r\n        is_pinned: boolean\r\n        created_at: string\r\n        cached_results?: Record<string, unknown>\r\n    }\r\n\r\n    // Web search result type\r\n    interface WebSearchResult {\r\n        id: string\r\n        title: string\r\n        snippet: string\r\n        url: string\r\n        source: string\r\n        date?: string\r\n    }\r\n\r\n    const handleSearch = useCallback(async () => {\r\n        if (!query.trim()) return\r\n\r\n        setLoading(true)\r\n        setResults([])\r\n        setWebResults([])\r\n        setIsFromCache(false) // Fresh search, not from cache\r\n\r\n        try {\r\n            const promises: Promise<void>[] = []\r\n\r\n            // Internal search (posts/resources)\r\n            if (searchSource === 'internal' || searchSource === 'all') {\r\n                promises.push(\r\n                    fetch('/api/research-search', {\r\n                        method: 'POST',\r\n                        headers: { 'Content-Type': 'application/json' },\r\n                        body: JSON.stringify({\r\n                            query: query.trim(),\r\n                            filters,\r\n                            explain: true,\r\n                            limit: 20\r\n                        })\r\n                    })\r\n                        .then(res => res.json())\r\n                        .then(data => {\r\n                            if (data.results) {\r\n                                setResults(data.results)\r\n                                setSearchDuration(data.search_duration_ms)\r\n                            }\r\n                        })\r\n                )\r\n            }\r\n\r\n            // Web search (external sources)\r\n            if (searchSource === 'web' || searchSource === 'all') {\r\n                promises.push(\r\n                    fetch('/api/web-search', {\r\n                        method: 'POST',\r\n                        headers: { 'Content-Type': 'application/json' },\r\n                        body: JSON.stringify({\r\n                            query: `Syria reconstruction ${query.trim()}`,\r\n                            limit: 10\r\n                        })\r\n                    })\r\n                        .then(res => res.json())\r\n                        .then(data => {\r\n                            if (data.results) {\r\n                                setWebResults(data.results)\r\n                            }\r\n                        })\r\n                        .catch(() => {\r\n                            // Web search failed, continue with internal results\r\n                            console.log('Web search unavailable')\r\n                        })\r\n                )\r\n            }\r\n\r\n            await Promise.all(promises)\r\n        } catch (error) {\r\n            console.error('Search error:', error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }, [query, filters, searchSource])\r\n\r\n    const updateFilter = <K extends keyof SearchFilters>(key: K, value: SearchFilters[K]) => {\r\n        setFilters(prev => ({ ...prev, [key]: value }))\r\n    }\r\n\r\n    const clearFilters = () => {\r\n        setFilters({})\r\n    }\r\n\r\n    const activeFilterCount = Object.values(filters).filter(v =>\r\n        v !== undefined && (Array.isArray(v) ? v.length > 0 : true)\r\n    ).length\r\n\r\n    // Load saved searches from database\r\n    const loadSavedSearches = useCallback(async () => {\r\n        setLoadingSaved(true)\r\n        try {\r\n            const response = await fetch('/api/saved-searches')\r\n            const data = await response.json()\r\n            if (data.searches) {\r\n                setSavedSearches(data.searches)\r\n            }\r\n        } catch (error) {\r\n            console.error('Error loading saved searches:', error)\r\n        } finally {\r\n            setLoadingSaved(false)\r\n        }\r\n    }, [])\r\n\r\n    // Save current search to database\r\n    const saveSearch = useCallback(async () => {\r\n        if (!query.trim()) return\r\n\r\n        setSavingSearch(true)\r\n        try {\r\n            const response = await fetch('/api/saved-searches', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    query: query.trim(),\r\n                    filters,\r\n                    source_type: searchSource,\r\n                    result_count: results.length + webResults.length,\r\n                    cached_results: {\r\n                        internal: results,\r\n                        web: webResults\r\n                    }\r\n                })\r\n            })\r\n\r\n            const data = await response.json()\r\n            if (data.search) {\r\n                setSavedSearches(prev => [data.search, ...prev])\r\n            }\r\n        } catch (error) {\r\n            console.error('Error saving search:', error)\r\n        } finally {\r\n            setSavingSearch(false)\r\n        }\r\n    }, [query, filters, searchSource, results, webResults])\r\n\r\n    // Delete a saved search\r\n    const deleteSavedSearch = useCallback(async (id: string) => {\r\n        try {\r\n            await fetch(`/api/saved-searches?id=${id}`, { method: 'DELETE' })\r\n            setSavedSearches(prev => prev.filter(s => s.id !== id))\r\n        } catch (error) {\r\n            console.error('Error deleting search:', error)\r\n        }\r\n    }, [])\r\n\r\n    // Branch from saved search (load and modify)\r\n    const branchSearch = useCallback((search: SavedSearch) => {\r\n        setQuery(search.query)\r\n        setFilters(search.filters)\r\n        setSearchSource(search.source_type)\r\n        setActiveTab('search')\r\n    }, [])\r\n\r\n    // Restore search from cache (NO API call - uses cached results)\r\n    const restoreFromCache = useCallback((search: SavedSearch) => {\r\n        setQuery(search.query)\r\n        setFilters(search.filters)\r\n        setSearchSource(search.source_type)\r\n        setActiveTab('search')\r\n\r\n        // Restore cached results if available\r\n        if (search.cached_results) {\r\n            const cached = search.cached_results as { internal?: any[], web?: any[] }\r\n            if (cached.internal) {\r\n                setResults(cached.internal)\r\n            }\r\n            if (cached.web) {\r\n                setWebResults(cached.web)\r\n            }\r\n            setSearchDuration(null) // Cached, not measured\r\n            setIsFromCache(true) // Mark as cached results\r\n        } else {\r\n            setIsFromCache(false)\r\n        }\r\n    }, [])\r\n\r\n    // Copy link to clipboard\r\n    const copyToClipboard = useCallback((text: string, id: string) => {\r\n        navigator.clipboard.writeText(text)\r\n        setCopiedId(id)\r\n        setTimeout(() => setCopiedId(null), 2000)\r\n    }, [])\r\n\r\n    return (\r\n        <div className=\"max-w-4xl mx-auto\">\r\n            {/* Header with Tabs */}\r\n            <div className=\"mb-6\">\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                    <h1 className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">Search Engine</h1>\r\n\r\n                    {/* Tab Buttons */}\r\n                    <div className=\"flex items-center gap-1 p-1 bg-gray-100 dark:bg-dark-border rounded-lg\">\r\n                        <button\r\n                            onClick={() => setActiveTab('search')}\r\n                            className={`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${activeTab === 'search'\r\n                                ? 'bg-white dark:bg-dark-surface text-primary shadow-sm'\r\n                                : 'text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200'\r\n                                }`}\r\n                        >\r\n                            <Search className=\"w-4 h-4\" />\r\n                            Search\r\n                        </button>\r\n                        <button\r\n                            onClick={() => {\r\n                                setActiveTab('saved')\r\n                                loadSavedSearches()\r\n                            }}\r\n                            className={`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${activeTab === 'saved'\r\n                                ? 'bg-white dark:bg-dark-surface text-primary shadow-sm'\r\n                                : 'text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200'\r\n                                }`}\r\n                        >\r\n                            <Bookmark className=\"w-4 h-4\" />\r\n                            Saved\r\n                            {savedSearches.length > 0 && (\r\n                                <span className=\"px-1.5 py-0.5 text-xs bg-primary/10 text-primary rounded-full\">\r\n                                    {savedSearches.length}\r\n                                </span>\r\n                            )}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Save Search Button - only visible when there are results */}\r\n                {activeTab === 'search' && (results.length > 0 || webResults.length > 0) && (\r\n                    <div className=\"flex justify-end mb-4\">\r\n                        <button\r\n                            onClick={saveSearch}\r\n                            disabled={savingSearch}\r\n                            className=\"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium bg-primary/10 text-primary hover:bg-primary/20 rounded-md transition-colors disabled:opacity-50\"\r\n                        >\r\n                            {savingSearch ? (\r\n                                <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                            ) : (\r\n                                <Plus className=\"w-4 h-4\" />\r\n                            )}\r\n                            {savingSearch ? 'Saving...' : 'Save This Search'}\r\n                        </button>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Saved Searches Tab Content */}\r\n            {activeTab === 'saved' && (\r\n                <div className=\"mb-8\">\r\n                    {loadingSaved ? (\r\n                        <div className=\"flex items-center justify-center py-12\">\r\n                            <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\r\n                        </div>\r\n                    ) : savedSearches.length === 0 ? (\r\n                        <div className=\"text-center py-12 bg-gray-50 dark:bg-dark-bg rounded-xl border border-gray-200 dark:border-dark-border\">\r\n                            <Bookmark className=\"w-12 h-12 mx-auto mb-4 text-gray-300 dark:text-gray-600\" />\r\n                            <p className=\"text-gray-500 dark:text-gray-400\">No saved searches yet</p>\r\n                            <p className=\"text-sm text-gray-400 dark:text-gray-500 mt-1\">\r\n                                Search for something and click \"Save This Search\" to save it here\r\n                            </p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"space-y-3\">\r\n                            {savedSearches.map((search) => (\r\n                                <div\r\n                                    key={search.id}\r\n                                    className=\"flex items-center justify-between p-4 bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border hover:shadow-md transition-shadow\"\r\n                                >\r\n                                    <div className=\"flex-1 min-w-0\">\r\n                                        <div className=\"flex items-center gap-2 mb-1\">\r\n                                            <span className=\"font-medium text-gray-900 dark:text-gray-100 truncate\">\r\n                                                {search.title || search.query}\r\n                                            </span>\r\n                                            <span className=\"text-xs px-1.5 py-0.5 bg-gray-100 dark:bg-dark-border rounded text-gray-500\">\r\n                                                {search.source_type}\r\n                                            </span>\r\n                                            {search.is_pinned && (\r\n                                                <span className=\"text-xs px-1.5 py-0.5 bg-amber-100 dark:bg-amber-900/30 text-amber-600 rounded\">\r\n                                                    Pinned\r\n                                                </span>\r\n                                            )}\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400\">\r\n                                            <Clock className=\"w-3 h-3\" />\r\n                                            {new Date(search.created_at).toLocaleDateString()}\r\n                                            <span>ΓÇó</span>\r\n                                            <span>{search.result_count} results</span>\r\n                                            {search.notes && (\r\n                                                <>\r\n                                                    <span>ΓÇó</span>\r\n                                                    <span className=\"truncate max-w-[200px]\">{search.notes}</span>\r\n                                                </>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-1 ml-4\">\r\n                                        <button\r\n                                            onClick={() => branchSearch(search)}\r\n                                            className=\"p-2 text-gray-400 hover:text-primary hover:bg-gray-100 dark:hover:bg-dark-border rounded-md transition-colors\"\r\n                                            title=\"Load and modify this search\"\r\n                                        >\r\n                                            <GitBranch className=\"w-4 h-4\" />\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={() => restoreFromCache(search)}\r\n                                            className=\"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-md transition-colors\"\r\n                                            title=\"Restore from cache (no API call)\"\r\n                                        >\r\n                                            <Search className=\"w-4 h-4\" />\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={() => deleteSavedSearch(search.id)}\r\n                                            className=\"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors\"\r\n                                            title=\"Delete this search\"\r\n                                        >\r\n                                            <X className=\"w-4 h-4\" />\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            {/* Search Tab Content */}\r\n            {activeTab === 'search' && (\r\n                <>\r\n                    {/* Source Toggle */}\r\n                    <div className=\"inline-flex items-center gap-1 p-1 bg-gray-100 dark:bg-dark-border rounded-lg\">\r\n                        <button\r\n                            onClick={() => setSearchSource('all')}\r\n                            className={`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${searchSource === 'all'\r\n                                ? 'bg-white dark:bg-dark-surface text-primary shadow-sm'\r\n                                : 'text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200'\r\n                                }`}\r\n                        >\r\n                            All Sources\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setSearchSource('internal')}\r\n                            className={`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${searchSource === 'internal'\r\n                                ? 'bg-white dark:bg-dark-surface text-primary shadow-sm'\r\n                                : 'text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200'\r\n                                }`}\r\n                        >\r\n                            <Database className=\"w-3.5 h-3.5\" />\r\n                            Internal\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setSearchSource('web')}\r\n                            className={`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${searchSource === 'web'\r\n                                ? 'bg-white dark:bg-dark-surface text-primary shadow-sm'\r\n                                : 'text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200'\r\n                                }`}\r\n                        >\r\n                            <Globe className=\"w-3.5 h-3.5\" />\r\n                            Web\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Search Bar */}\r\n                    <div className=\"relative mb-4\">\r\n                        <div className=\"relative bg-white dark:bg-dark-surface rounded-2xl shadow-lg dark:shadow-none border border-gray-100 dark:border-dark-border overflow-hidden\">\r\n                            <div className=\"flex items-center\">\r\n                                <Search className=\"absolute left-5 w-5 h-5 text-gray-400 dark:text-gray-500\" />\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={query}\r\n                                    onChange={(e) => setQuery(e.target.value)}\r\n                                    onKeyDown={(e) => e.key === 'Enter' && handleSearch()}\r\n                                    placeholder=\"Search for reconstruction knowledge, policies, surveys...\"\r\n                                    className=\"flex-1 pl-14 pr-4 py-4 bg-transparent text-gray-900 dark:text-gray-100 text-lg placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:outline-none\"\r\n                                />\r\n                                <div className=\"flex items-center gap-2 pr-3\">\r\n                                    <Button\r\n                                        variant=\"outline\"\r\n                                        size=\"sm\"\r\n                                        onClick={() => setShowFilters(!showFilters)}\r\n                                        className=\"gap-1.5 border-gray-200 dark:border-dark-border hover:bg-gray-50 dark:hover:bg-dark-bg\"\r\n                                    >\r\n                                        <Filter className=\"w-4 h-4\" />\r\n                                        Filters\r\n                                        {activeFilterCount > 0 && (\r\n                                            <span className=\"ml-1 px-1.5 py-0.5 text-xs bg-primary text-white rounded-full\">\r\n                                                {activeFilterCount}\r\n                                            </span>\r\n                                        )}\r\n                                    </Button>\r\n                                    <Button\r\n                                        onClick={handleSearch}\r\n                                        disabled={loading || !query.trim()}\r\n                                        className=\"px-5\"\r\n                                    >\r\n                                        {loading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : 'Search'}\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Filters Panel */}\r\n                    {showFilters && (\r\n                        <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border p-5 mb-6 animate-in fade-in slide-in-from-top-2 duration-200\">\r\n                            <div className=\"flex items-center justify-between mb-5\">\r\n                                <h3 className=\"font-semibold text-gray-900 dark:text-gray-100\">Search Filters</h3>\r\n                                {activeFilterCount > 0 && (\r\n                                    <button onClick={clearFilters} className=\"text-sm text-primary hover:text-primary/80 transition-colors font-medium\">\r\n                                        Clear all\r\n                                    </button>\r\n                                )}\r\n                            </div>\r\n\r\n                            <div className=\"grid gap-6 md:grid-cols-2\">\r\n                                {/* Disciplines */}\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">Disciplines</label>\r\n                                    <div className=\"space-y-4 max-h-56 overflow-y-auto pr-2 scrollbar-thin\">\r\n                                        {DISCIPLINE_CATEGORIES.map(cat => (\r\n                                            <div key={cat.id} className=\"space-y-2\">\r\n                                                <p className=\"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide\">\r\n                                                    {cat.name}\r\n                                                </p>\r\n                                                <div className=\"flex flex-wrap gap-1.5\">\r\n                                                    {cat.disciplines.map(d => (\r\n                                                        <button\r\n                                                            key={d}\r\n                                                            onClick={() => {\r\n                                                                const current = filters.disciplines || []\r\n                                                                const updated = current.includes(d)\r\n                                                                    ? current.filter(x => x !== d)\r\n                                                                    : [...current, d]\r\n                                                                updateFilter('disciplines', updated)\r\n                                                            }}\r\n                                                            className={`px-2.5 py-1 text-xs rounded-md border transition-all ${(filters.disciplines || []).includes(d)\r\n                                                                ? 'bg-primary text-white border-primary shadow-sm'\r\n                                                                : 'bg-gray-50 dark:bg-dark-bg border-gray-200 dark:border-dark-border text-gray-700 dark:text-gray-300 hover:border-primary hover:text-primary dark:hover:text-primary'\r\n                                                                }`}\r\n                                                        >\r\n                                                            {d.replace(/_/g, ' ')}\r\n                                                        </button>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Evidence Tiers & Phase */}\r\n                                <div className=\"space-y-5\">\r\n                                    <div>\r\n                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">Evidence Type</label>\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            {EVIDENCE_TIERS.map(tier => (\r\n                                                <button\r\n                                                    key={tier.value}\r\n                                                    onClick={() => {\r\n                                                        const current = filters.evidence_tiers || []\r\n                                                        const updated = current.includes(tier.value)\r\n                                                            ? current.filter(x => x !== tier.value)\r\n                                                            : [...current, tier.value]\r\n                                                        updateFilter('evidence_tiers', updated)\r\n                                                    }}\r\n                                                    className={`px-3 py-1.5 text-sm rounded-md border transition-all ${(filters.evidence_tiers || []).includes(tier.value)\r\n                                                        ? 'bg-primary text-white border-primary shadow-sm'\r\n                                                        : 'bg-gray-50 dark:bg-dark-bg border-gray-200 dark:border-dark-border text-gray-700 dark:text-gray-300 hover:border-primary hover:text-primary dark:hover:text-primary'\r\n                                                        }`}\r\n                                                    title={tier.description}\r\n                                                >\r\n                                                    {tier.label}\r\n                                                </button>\r\n                                            ))}\r\n                                        </div>\r\n                                        <label className=\"flex items-center gap-2 mt-3 text-sm text-gray-600 dark:text-gray-400 cursor-pointer group\">\r\n                                            <input\r\n                                                type=\"checkbox\"\r\n                                                checked={filters.primary_evidence_only || false}\r\n                                                onChange={(e) => updateFilter('primary_evidence_only', e.target.checked)}\r\n                                                className=\"rounded border-gray-300 dark:border-dark-border text-primary focus:ring-primary\"\r\n                                            />\r\n                                            <span className=\"group-hover:text-gray-900 dark:group-hover:text-gray-200 transition-colors\">\r\n                                                Primary evidence only (highest reliability)\r\n                                            </span>\r\n                                        </label>\r\n                                    </div>\r\n\r\n                                    <div>\r\n                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">Temporal Phase</label>\r\n                                        <select\r\n                                            value={filters.conflict_phase || ''}\r\n                                            onChange={(e) => updateFilter('conflict_phase', e.target.value as ConflictPhase || undefined)}\r\n                                            className=\"w-full px-3 py-2.5 rounded-md border border-gray-200 dark:border-dark-border bg-gray-50 dark:bg-dark-bg text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent\"\r\n                                        >\r\n                                            <option value=\"\">All phases</option>\r\n                                            {CONFLICT_PHASES.map(p => (\r\n                                                <option key={p.value} value={p.value}>{p.label}</option>\r\n                                            ))}\r\n                                        </select>\r\n                                    </div>\r\n\r\n                                    <div>\r\n                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">Minimum Trust Score</label>\r\n                                        <div className=\"space-y-2\">\r\n                                            <div className=\"relative\">\r\n                                                <input\r\n                                                    type=\"range\"\r\n                                                    min=\"0\"\r\n                                                    max=\"100\"\r\n                                                    step=\"10\"\r\n                                                    value={filters.min_trust_score || 0}\r\n                                                    onChange={(e) => updateFilter('min_trust_score', parseInt(e.target.value))}\r\n                                                    className=\"w-full h-2 bg-gray-200 dark:bg-dark-border rounded-full appearance-none cursor-pointer accent-primary\"\r\n                                                />\r\n                                            </div>\r\n                                            <div className=\"flex justify-between text-xs text-gray-500 dark:text-gray-400\">\r\n                                                <span>Any</span>\r\n                                                <span className=\"font-medium text-primary\">{filters.min_trust_score || 0}+</span>\r\n                                                <span>100</span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Internal Results - Evidence Space */}\r\n                    {(searchSource === 'internal' || searchSource === 'all') && results.length > 0 && (\r\n                        <div className=\"mb-8\">\r\n                            {/* Mode Banner - Internal Evidence Space */}\r\n                            <div className=\"mb-4 p-3 bg-gradient-to-r from-primary/5 to-teal-50 dark:from-primary/10 dark:to-teal-900/10 border border-primary/20 dark:border-primary/30 rounded-lg\">\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <div className=\"p-1.5 bg-primary/10 rounded-md\">\r\n                                            <Database className=\"w-4 h-4 text-primary\" />\r\n                                        </div>\r\n                                        <div>\r\n                                            <span className=\"font-semibold text-primary dark:text-primary\">Internal Evidence Space</span>\r\n                                            <span className=\"text-xs text-gray-500 dark:text-gray-400 ml-2\">Curated ┬╖ Versioned ┬╖ Trust-Scored</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        {isFromCache && (\r\n                                            <span className=\"text-xs px-2 py-0.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded-full font-medium flex items-center gap-1\">\r\n                                                <Database className=\"w-3 h-3\" />\r\n                                                Cached\r\n                                            </span>\r\n                                        )}\r\n                                        <span className=\"text-sm text-gray-600 dark:text-gray-400\">{results.length} results</span>\r\n                                        {searchDuration && <span className=\"text-xs text-gray-400\">{searchDuration}ms</span>}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-4\">\r\n                                {results.map((result) => (\r\n                                    <SearchResultCard\r\n                                        key={result.id}\r\n                                        result={result}\r\n                                        expanded={expandedResult === result.id}\r\n                                        onToggleExpand={() => setExpandedResult(\r\n                                            expandedResult === result.id ? null : result.id\r\n                                        )}\r\n                                    />\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Web Results - Open Web */}\r\n                    {(searchSource === 'web' || searchSource === 'all') && webResults.length > 0 && (\r\n                        <div className=\"mb-8\">\r\n                            {/* Mode Banner - Open Web */}\r\n                            <div className=\"mb-4 p-3 bg-gradient-to-r from-blue-50 to-sky-50 dark:from-blue-900/10 dark:to-sky-900/10 border border-blue-200 dark:border-blue-800/40 rounded-lg\">\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <div className=\"p-1.5 bg-blue-100 dark:bg-blue-900/30 rounded-md\">\r\n                                            <Globe className=\"w-4 h-4 text-blue-500\" />\r\n                                        </div>\r\n                                        <div>\r\n                                            <span className=\"font-semibold text-blue-600 dark:text-blue-400\">Open Web</span>\r\n                                            <span className=\"text-xs text-gray-500 dark:text-gray-400 ml-2\">Unverified ┬╖ External ┬╖ Unassessed</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        {isFromCache && (\r\n                                            <span className=\"text-xs px-2 py-0.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded-full font-medium flex items-center gap-1\">\r\n                                                <Globe className=\"w-3 h-3\" />\r\n                                                Cached\r\n                                            </span>\r\n                                        )}\r\n                                        <span className=\"text-sm text-gray-600 dark:text-gray-400\">{webResults.length} results</span>\r\n                                    </div>\r\n                                </div>\r\n                                <p className=\"text-xs text-amber-600 dark:text-amber-400 mt-2 flex items-center gap-1\">\r\n                                    <AlertTriangle className=\"w-3 h-3\" />\r\n                                    Web sources require independent verification. Save as reference to track provenance.\r\n                                </p>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-4\">\r\n                                {webResults.map((result) => (\r\n                                    <WebResultCard\r\n                                        key={result.id}\r\n                                        result={result}\r\n                                        onCopyLink={copyToClipboard}\r\n                                        copiedId={copiedId}\r\n                                    />\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Empty state */}\r\n                    {!loading && query && results.length === 0 && webResults.length === 0 && (\r\n                        <div className=\"text-center py-12\">\r\n                            <Search className=\"w-12 h-12 mx-auto mb-4 text-gray-300 dark:text-gray-600\" />\r\n                            <p className=\"text-gray-500 dark:text-gray-400\">No results found. Try adjusting your search or filters.</p>\r\n                        </div>\r\n                    )}\r\n                </>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface SearchResultCardProps {\r\n    result: SearchResult\r\n    expanded: boolean\r\n    onToggleExpand: () => void\r\n}\r\n\r\nfunction SearchResultCard({ result, expanded, onToggleExpand }: SearchResultCardProps) {\r\n    const avgTrustScore = result.trust_profile\r\n        ? Math.round((\r\n            result.trust_profile.t1_source_score +\r\n            result.trust_profile.t2_method_score +\r\n            result.trust_profile.t3_proximity_score +\r\n            result.trust_profile.t4_temporal_score +\r\n            result.trust_profile.t5_validation_score\r\n        ) / 5)\r\n        : null\r\n\r\n    return (\r\n        <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-gray-200 dark:border-dark-border overflow-hidden hover:shadow-md transition-shadow\">\r\n            <div className=\"p-5\">\r\n                {/* Header */}\r\n                <div className=\"flex items-start justify-between gap-4 mb-3\">\r\n                    <Link href={`/post/${result.id}`} className=\"flex-1 min-w-0 group\">\r\n                        <h3 className=\"font-medium text-lg text-gray-900 dark:text-gray-100 group-hover:text-primary transition-colors line-clamp-1\">\r\n                            {result.title}\r\n                        </h3>\r\n                    </Link>\r\n                    <div className=\"flex items-center gap-2 shrink-0\">\r\n                        {avgTrustScore !== null && <TrustBadge score={avgTrustScore} size=\"sm\" />}\r\n                        <span className=\"text-xs px-2.5 py-1 rounded-md bg-gray-100 dark:bg-dark-border text-gray-600 dark:text-gray-300 font-medium capitalize\">\r\n                            {result.evidence_tier}\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Snippet */}\r\n                <p className=\"text-sm text-gray-600 dark:text-gray-400 line-clamp-2 mb-4\">{stripMarkdown(result.snippet)}</p>\r\n\r\n                {/* Meta row */}\r\n                <div className=\"flex items-center gap-4 text-sm\">\r\n                    {result.similarity_score !== null && (\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <div className=\"w-16 h-1.5 bg-gray-200 dark:bg-dark-border rounded-full overflow-hidden\">\r\n                                <div\r\n                                    className=\"h-full bg-primary rounded-full transition-all\"\r\n                                    style={{ width: `${result.similarity_score * 100}%` }}\r\n                                />\r\n                            </div>\r\n                            <span className=\"text-gray-500 dark:text-gray-400 font-medium\">\r\n                                {(result.similarity_score * 100).toFixed(0)}%\r\n                            </span>\r\n                        </div>\r\n                    )}\r\n                    {result.linked_resources.length > 0 && (\r\n                        <span className=\"flex items-center gap-1.5 text-gray-500 dark:text-gray-400\">\r\n                            <Link2 className=\"w-4 h-4\" />\r\n                            {result.linked_resources.length} linked\r\n                        </span>\r\n                    )}\r\n                    {result.contradictions.length > 0 && (\r\n                        <InlineConflictBadge count={result.contradictions.length} />\r\n                    )}\r\n                    <button\r\n                        onClick={onToggleExpand}\r\n                        className=\"ml-auto flex items-center gap-1.5 text-primary hover:text-primary/80 transition-colors text-sm font-medium\"\r\n                    >\r\n                        <Info className=\"w-4 h-4\" />\r\n                        {expanded ? 'Hide' : 'Show'} explanation\r\n                        <ChevronDown className={`w-4 h-4 transition-transform ${expanded ? 'rotate-180' : ''}`} />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Action buttons row */}\r\n                <div className=\"flex items-center gap-1 pt-3 mt-3 border-t border-gray-100 dark:border-dark-border\">\r\n                    <button\r\n                        onClick={() => {\r\n                            // Copy citation to clipboard\r\n                            const citation = `${result.title}. Retrieved from SyriaHub Research Archive.`\r\n                            navigator.clipboard.writeText(citation)\r\n                        }}\r\n                        className=\"flex items-center gap-1.5 px-2.5 py-1.5 text-xs rounded-md text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-dark-border transition-colors\"\r\n                        title=\"Copy citation\"\r\n                    >\r\n                        <Quote className=\"w-3.5 h-3.5\" />\r\n                        Cite\r\n                    </button>\r\n                    <button\r\n                        onClick={() => {\r\n                            // Navigate to extract data view\r\n                            window.open(`/post/${result.id}?action=extract`, '_blank')\r\n                        }}\r\n                        className=\"flex items-center gap-1.5 px-2.5 py-1.5 text-xs rounded-md text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-dark-border transition-colors\"\r\n                        title=\"Extract data\"\r\n                    >\r\n                        <FileDown className=\"w-3.5 h-3.5\" />\r\n                        Extract\r\n                    </button>\r\n                    <button\r\n                        className=\"flex items-center gap-1.5 px-2.5 py-1.5 text-xs rounded-md text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-dark-border transition-colors\"\r\n                        title=\"Save to collection\"\r\n                    >\r\n                        <Bookmark className=\"w-3.5 h-3.5\" />\r\n                        Save\r\n                    </button>\r\n                    <Link\r\n                        href={`/post/${result.id}`}\r\n                        target=\"_blank\"\r\n                        className=\"flex items-center gap-1.5 px-2.5 py-1.5 text-xs rounded-md text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-dark-border transition-colors ml-auto\"\r\n                    >\r\n                        <ExternalLink className=\"w-3.5 h-3.5\" />\r\n                        Open\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Expanded explanation */}\r\n            {expanded && result.explanation && (\r\n                <div className=\"border-t border-gray-200 dark:border-dark-border p-5 bg-gray-50 dark:bg-dark-bg\">\r\n                    <ExplanationPanel explanation={result.explanation} />\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface ExplanationPanelProps {\r\n    explanation: SearchResult['explanation']\r\n}\r\n\r\nfunction ExplanationPanel({ explanation }: ExplanationPanelProps) {\r\n    return (\r\n        <div className=\"space-y-4 text-sm\">\r\n            {/* Why it matched */}\r\n            <div>\r\n                <h4 className=\"font-medium mb-2 flex items-center gap-1\">\r\n                    <Info className=\"w-4 h-4 text-blue-500\" />\r\n                    Why this result appeared\r\n                </h4>\r\n                <ul className=\"space-y-1\">\r\n                    {explanation.match_reasons.map((reason, i) => (\r\n                        <li key={i} className=\"flex items-center gap-2\">\r\n                            <span className=\"w-1.5 h-1.5 rounded-full bg-blue-500\" />\r\n                            {reason.reason}\r\n                            <span className=\"text-text-light\">({(reason.weight * 100).toFixed(0)}% weight)</span>\r\n                        </li>\r\n                    ))}\r\n                </ul>\r\n            </div>\r\n\r\n            {/* Supporting evidence */}\r\n            {explanation.supporting_evidence.length > 0 && (\r\n                <div>\r\n                    <h4 className=\"font-medium mb-2 flex items-center gap-1\">\r\n                        <Link2 className=\"w-4 h-4 text-green-500\" />\r\n                        Supporting data\r\n                    </h4>\r\n                    <ul className=\"space-y-1\">\r\n                        {explanation.supporting_evidence.map((ev, i) => (\r\n                            <li key={i} className=\"flex items-center gap-2\">\r\n                                <span className=\"w-1.5 h-1.5 rounded-full bg-green-500\" />\r\n                                {ev.detail || `${ev.count} ${ev.type.replace(/_/g, ' ')}(s)`}\r\n                            </li>\r\n                        ))}\r\n                    </ul>\r\n                </div>\r\n            )}\r\n\r\n            {/* Data gaps */}\r\n            {explanation.data_gaps.length > 0 && (\r\n                <div>\r\n                    <h4 className=\"font-medium mb-2 flex items-center gap-1\">\r\n                        <AlertTriangle className=\"w-4 h-4 text-amber-500\" />\r\n                        Data gaps & limitations\r\n                    </h4>\r\n                    <ul className=\"space-y-1\">\r\n                        {explanation.data_gaps.map((gap, i) => (\r\n                            <li key={i} className=\"flex items-center gap-2\">\r\n                                <span className={`w-1.5 h-1.5 rounded-full ${gap.severity === 'high' ? 'bg-red-500' :\r\n                                    gap.severity === 'medium' ? 'bg-amber-500' : 'bg-gray-400'\r\n                                    }`} />\r\n                                {gap.gap}\r\n                                <span className=\"text-xs text-text-light capitalize\">({gap.severity})</span>\r\n                            </li>\r\n                        ))}\r\n                    </ul>\r\n                </div>\r\n            )}\r\n\r\n            {/* Credibility score */}\r\n            <div className=\"pt-2 border-t border-gray-200 dark:border-dark-border\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <span className=\"text-gray-500 dark:text-gray-400\">Credibility Score</span>\r\n                    <span className={`font-medium ${explanation.credibility_score >= 70 ? 'text-green-600' :\r\n                        explanation.credibility_score >= 50 ? 'text-blue-600' :\r\n                            explanation.credibility_score >= 30 ? 'text-amber-600' : 'text-red-600'\r\n                        }`}>\r\n                        {explanation.credibility_score}/100\r\n                    </span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\n// Web Result Card Component\r\ninterface WebResultCardProps {\r\n    result: {\r\n        id: string\r\n        title: string\r\n        snippet: string\r\n        url: string\r\n        source: string\r\n        date?: string\r\n    }\r\n    onCopyLink?: (url: string, id: string) => void\r\n    copiedId?: string | null\r\n}\r\n\r\nfunction WebResultCard({ result, onCopyLink, copiedId }: WebResultCardProps) {\r\n    const [saved, setSaved] = useState(false)\r\n    const [saving, setSaving] = useState(false)\r\n    const [cited, setCited] = useState(false)\r\n\r\n    // Handle save to database\r\n    const handleSave = async () => {\r\n        if (saved) {\r\n            // Unsave\r\n            try {\r\n                await fetch(`/api/saved-references?url=${encodeURIComponent(result.url)}`, { method: 'DELETE' })\r\n                setSaved(false)\r\n            } catch (error) {\r\n                console.error('Error unsaving reference:', error)\r\n            }\r\n        } else {\r\n            // Save\r\n            setSaving(true)\r\n            try {\r\n                const citation = `${result.title}. (${result.source}). Retrieved from ${result.url}`\r\n                const response = await fetch('/api/saved-references', {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify({\r\n                        title: result.title,\r\n                        url: result.url,\r\n                        snippet: result.snippet,\r\n                        source: result.source,\r\n                        citation\r\n                    })\r\n                })\r\n\r\n                if (response.ok) {\r\n                    setSaved(true)\r\n                }\r\n            } catch (error) {\r\n                console.error('Error saving reference:', error)\r\n            } finally {\r\n                setSaving(false)\r\n            }\r\n        }\r\n    }\r\n\r\n    // Handle cite with feedback\r\n    const handleCite = () => {\r\n        const citation = `${result.title}. (${result.source}). Retrieved from ${result.url}`\r\n        navigator.clipboard.writeText(citation)\r\n        setCited(true)\r\n        setTimeout(() => setCited(false), 2000)\r\n    }\r\n\r\n    return (\r\n        <div className=\"bg-white dark:bg-dark-surface rounded-xl border border-blue-100 dark:border-blue-900/30 p-5 hover:shadow-md hover:border-blue-200 dark:hover:border-blue-800/40 transition-all\">\r\n            <div className=\"flex items-start gap-3\">\r\n                <div className=\"shrink-0 w-8 h-8 rounded-lg bg-blue-50 dark:bg-blue-900/20 flex items-center justify-center\">\r\n                    <Globe className=\"w-4 h-4 text-blue-500\" />\r\n                </div>\r\n                <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <a\r\n                            href={result.url}\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                            className=\"font-medium text-gray-900 dark:text-gray-100 hover:text-blue-600 transition-colors line-clamp-1\"\r\n                        >\r\n                            {result.title}\r\n                        </a>\r\n                        <span className=\"text-xs px-1.5 py-0.5 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 rounded font-medium\">\r\n                            Web\r\n                        </span>\r\n                    </div>\r\n                    <p className=\"text-sm text-gray-600 dark:text-gray-400 line-clamp-2 mt-1\">\r\n                        {stripMarkdown(result.snippet)}\r\n                    </p>\r\n\r\n                    {/* Meta info */}\r\n                    <div className=\"flex items-center gap-3 mt-2 text-xs text-gray-500 dark:text-gray-400\">\r\n                        <span className=\"flex items-center gap-1\">\r\n                            <Globe className=\"w-3 h-3 text-blue-500\" />\r\n                            {result.source}\r\n                        </span>\r\n                        {result.date && (\r\n                            <span>{result.date}</span>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Action buttons */}\r\n                    <div className=\"flex items-center gap-1 mt-3 pt-3 border-t border-gray-100 dark:border-dark-border\">\r\n                        <button\r\n                            onClick={() => onCopyLink?.(result.url, result.id)}\r\n                            className={`flex items-center gap-1.5 px-2.5 py-1.5 text-xs rounded-md transition-colors ${copiedId === result.id\r\n                                ? 'bg-green-50 dark:bg-green-900/20 text-green-600'\r\n                                : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-dark-border'\r\n                                }`}\r\n                            title=\"Copy link\"\r\n                        >\r\n                            {copiedId === result.id ? (\r\n                                <>\r\n                                    <Check className=\"w-3.5 h-3.5\" />\r\n                                    Copied!\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <Copy className=\"w-3.5 h-3.5\" />\r\n                                    Copy Link\r\n                                </>\r\n                            )}\r\n                        </button>\r\n                        <button\r\n                            onClick={handleSave}\r\n                            disabled={saving}\r\n                            className={`flex items-center gap-1.5 px-2.5 py-1.5 text-xs rounded-md transition-colors ${saved\r\n                                ? 'bg-blue-50 dark:bg-blue-900/20 text-blue-600'\r\n                                : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-dark-border'\r\n                                } disabled:opacity-50`}\r\n                            title=\"Save as reference\"\r\n                        >\r\n                            {saving ? (\r\n                                <Loader2 className=\"w-3.5 h-3.5 animate-spin\" />\r\n                            ) : (\r\n                                <Bookmark className={`w-3.5 h-3.5 ${saved ? 'fill-current' : ''}`} />\r\n                            )}\r\n                            {saved ? 'Saved' : 'Save'}\r\n                        </button>\r\n                        <button\r\n                            onClick={handleCite}\r\n                            className={`flex items-center gap-1.5 px-2.5 py-1.5 text-xs rounded-md transition-colors ${cited\r\n                                ? 'bg-green-50 dark:bg-green-900/20 text-green-600'\r\n                                : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-dark-border'\r\n                                }`}\r\n                            title=\"Copy citation\"\r\n                        >\r\n                            {cited ? (\r\n                                <>\r\n                                    <Check className=\"w-3.5 h-3.5\" />\r\n                                    Cited!\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <Quote className=\"w-3.5 h-3.5\" />\r\n                                    Cite\r\n                                </>\r\n                            )}\r\n                        </button>\r\n                        <a\r\n                            href={result.url}\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                            className=\"flex items-center gap-1.5 px-2.5 py-1.5 text-xs rounded-md text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-dark-border transition-colors ml-auto\"\r\n                        >\r\n                            <ExternalLink className=\"w-3.5 h-3.5\" />\r\n                            Open\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\research-lab\\ShareDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\research-lab\\StatisticsTools.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\research-lab\\SurveyAuthorActions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\research-lab\\SurveyBuilder.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\research-lab\\SurveyResponsesList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\research-lab\\SurveyResultsActions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\research-lab\\SurveyResultsChart.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":165,"column":25,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6810,6837],"text":"\r\n                        &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6810,6837],"text":"\r\n                        &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6810,6837],"text":"\r\n                        &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6810,6837],"text":"\r\n                        &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":165,"column":44,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6855,6878],"text":"&quot;\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6855,6878],"text":"&ldquo;\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6855,6878],"text":"&#34;\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6855,6878],"text":"&rdquo;\r\n                    "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useTranslations } from 'next-intl'\r\n\r\ninterface BarData {\r\n    type: 'bar'\r\n    options: Array<{ label: string; value: number; percentage: number }>\r\n}\r\n\r\ninterface StatsData {\r\n    type: 'stats'\r\n    average: number\r\n    min: number\r\n    max: number\r\n    distribution: Array<{ value: number; count: number }>\r\n}\r\n\r\ninterface TextData {\r\n    type: 'text'\r\n    responses: unknown[]\r\n}\r\n\r\ntype ChartData = BarData | StatsData | TextData\r\n\r\ninterface ProcessedResult {\r\n    questionId: string\r\n    questionText: string\r\n    questionType: string\r\n    responseCount: number\r\n    data: ChartData | Record<string, unknown>\r\n}\r\n\r\ninterface SurveyResultsChartProps {\r\n    result: ProcessedResult\r\n}\r\n\r\nexport function SurveyResultsChart({ result }: SurveyResultsChartProps) {\r\n    const rawData = result.data as ChartData | undefined\r\n\r\n    if (!rawData || !('type' in rawData)) {\r\n        return null\r\n    }\r\n\r\n    if (rawData.type === 'bar') {\r\n        return <BarChart data={rawData} />\r\n    }\r\n\r\n    if (rawData.type === 'stats') {\r\n        return <StatsDisplay data={rawData} questionType={result.questionType} />\r\n    }\r\n\r\n    if (rawData.type === 'text') {\r\n        return <TextResponses data={rawData} />\r\n    }\r\n\r\n    return null\r\n}\r\n\r\nfunction BarChart({ data }: { data: BarData }) {\r\n    const maxValue = Math.max(...data.options.map(o => o.value), 1)\r\n\r\n    return (\r\n        <div className=\"space-y-3\">\r\n            {data.options.map((option, index) => (\r\n                <div key={index}>\r\n                    <div className=\"flex items-center justify-between mb-1\">\r\n                        <span className=\"text-sm text-text dark:text-dark-text\">\r\n                            {option.label}\r\n                        </span>\r\n                        <span className=\"text-sm font-medium text-text-light dark:text-dark-text-muted\">\r\n                            {option.value} ({option.percentage}%)\r\n                        </span>\r\n                    </div>\r\n                    <div className=\"h-6 bg-gray-100 dark:bg-dark-bg rounded-full overflow-hidden\">\r\n                        <div\r\n                            className=\"h-full bg-gradient-to-r from-primary to-primary/80 rounded-full transition-all duration-500\"\r\n                            style={{ width: `${(option.value / maxValue) * 100}%` }}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            ))}\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction StatsDisplay({ data, questionType }: { data: StatsData; questionType: string }) {\r\n    const t = useTranslations('Statistics')\r\n    const isRating = questionType === 'rating'\r\n    const maxValue = isRating ? 5 : 10\r\n\r\n    return (\r\n        <div className=\"space-y-4\">\r\n            {/* Stats Summary */}\r\n            <div className=\"grid grid-cols-3 gap-4\">\r\n                <div className=\"text-center p-4 bg-gray-50 dark:bg-dark-bg rounded-lg\">\r\n                    <div className=\"text-2xl font-bold text-primary\">{data.average}</div>\r\n                    <div className=\"text-sm text-text-light dark:text-dark-text-muted\">{t('average')}</div>\r\n                </div>\r\n                <div className=\"text-center p-4 bg-gray-50 dark:bg-dark-bg rounded-lg\">\r\n                    <div className=\"text-2xl font-bold text-text dark:text-dark-text\">{data.min}</div>\r\n                    <div className=\"text-sm text-text-light dark:text-dark-text-muted\">{t('minimum')}</div>\r\n                </div>\r\n                <div className=\"text-center p-4 bg-gray-50 dark:bg-dark-bg rounded-lg\">\r\n                    <div className=\"text-2xl font-bold text-text dark:text-dark-text\">{data.max}</div>\r\n                    <div className=\"text-sm text-text-light dark:text-dark-text-muted\">{t('maximum')}</div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Distribution */}\r\n            {data.distribution && data.distribution.length > 0 && (\r\n                <div>\r\n                    <p className=\"text-sm font-medium text-text dark:text-dark-text mb-2\">{t('distribution')}</p>\r\n                    <div className=\"flex items-end justify-between gap-1 h-24\">\r\n                        {data.distribution.map((item) => {\r\n                            const maxCount = Math.max(...data.distribution.map(d => d.count), 1)\r\n                            const height = (item.count / maxCount) * 100\r\n\r\n                            return (\r\n                                <div key={item.value} className=\"flex-1 flex flex-col items-center\">\r\n                                    <div className=\"w-full flex flex-col items-center\">\r\n                                        {item.count > 0 && (\r\n                                            <span className=\"text-xs text-text-light dark:text-dark-text-muted mb-1\">\r\n                                                {item.count}\r\n                                            </span>\r\n                                        )}\r\n                                        <div\r\n                                            className=\"w-full bg-primary/80 rounded-t transition-all duration-500\"\r\n                                            style={{ height: `${Math.max(height, 4)}%`, minHeight: item.count > 0 ? '4px' : '2px' }}\r\n                                        />\r\n                                    </div>\r\n                                    <span className=\"text-xs text-text-light dark:text-dark-text-muted mt-1\">\r\n                                        {isRating ? 'Γÿà'.repeat(item.value) : item.value}\r\n                                    </span>\r\n                                </div>\r\n                            )\r\n                        })}\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction TextResponses({ data }: { data: TextData }) {\r\n    const tSurveys = useTranslations('Surveys')\r\n    if (!data.responses || data.responses.length === 0) {\r\n        return (\r\n            <p className=\"text-text-light dark:text-dark-text-muted italic\">\r\n                {tSurveys('noResponses')}\r\n            </p>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-3 max-h-80 overflow-y-auto pr-2\">\r\n            {data.responses.map((response, index) => (\r\n                <div\r\n                    key={index}\r\n                    className=\"flex items-start gap-3 p-3 bg-gray-50 dark:bg-dark-bg rounded-lg border-l-4 border-primary/30 hover:border-primary/60 transition-colors\"\r\n                >\r\n                    <span className=\"flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 text-primary text-xs font-semibold flex items-center justify-center\">\r\n                        {index + 1}\r\n                    </span>\r\n                    <p className=\"text-sm text-text dark:text-dark-text leading-relaxed flex-1\">\r\n                        \"{String(response)}\"\r\n                    </p>\r\n                </div>\r\n            ))}\r\n            {data.responses.length >= 20 && (\r\n                <p className=\"text-sm text-text-light dark:text-dark-text-muted italic text-center py-2 border-t border-gray-200 dark:border-dark-border\">\r\n                    Showing first 20 responses ΓÇó View Individual Responses for more\r\n                </p>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\research-lab\\SurveyTakeForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\EmptyState.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\FloatingActionButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\InfoHint.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\UserAvatar.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":73,"column":17,"nodeType":"JSXOpeningElement","endLine":77,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\ninterface UserAvatarProps {\r\n    name?: string | null\r\n    email?: string | null\r\n    avatarUrl?: string | null\r\n    size?: 'sm' | 'md' | 'lg' | 'xl'\r\n    className?: string\r\n}\r\n\r\n/**\r\n * Generates a consistent gradient index based on user identifier\r\n */\r\nfunction getGradientIndex(identifier: string): number {\r\n    let hash = 0\r\n    for (let i = 0; i < identifier.length; i++) {\r\n        const char = identifier.charCodeAt(i)\r\n        hash = ((hash << 5) - hash) + char\r\n        hash = hash & hash // Convert to 32bit integer\r\n    }\r\n    return (Math.abs(hash) % 8) + 1 // Returns 1-8\r\n}\r\n\r\n/**\r\n * Gets the user's initials from name or email\r\n */\r\nfunction getInitials(name?: string | null, email?: string | null): string {\r\n    if (name) {\r\n        const parts = name.trim().split(/\\s+/)\r\n        if (parts.length >= 2) {\r\n            return (parts[0][0] + parts[parts.length - 1][0]).toUpperCase()\r\n        }\r\n        return name.slice(0, 2).toUpperCase()\r\n    }\r\n\r\n    if (email) {\r\n        const username = email.split('@')[0]\r\n        return username.slice(0, 2).toUpperCase()\r\n    }\r\n\r\n    return '??'\r\n}\r\n\r\nconst sizeClasses = {\r\n    sm: 'w-8 h-8 text-xs',\r\n    md: 'w-10 h-10 text-sm',\r\n    lg: 'w-12 h-12 text-base',\r\n    xl: 'w-16 h-16 text-lg',\r\n}\r\n\r\nexport function UserAvatar({\r\n    name,\r\n    email,\r\n    avatarUrl,\r\n    size = 'md',\r\n    className,\r\n}: UserAvatarProps) {\r\n    const initials = getInitials(name, email)\r\n    const identifier = email || name || 'unknown'\r\n    const gradientIndex = getGradientIndex(identifier)\r\n\r\n    if (avatarUrl) {\r\n        return (\r\n            <div\r\n                className={cn(\r\n                    'rounded-full overflow-hidden flex-shrink-0',\r\n                    sizeClasses[size],\r\n                    className\r\n                )}\r\n            >\r\n                <img\r\n                    src={avatarUrl}\r\n                    alt={name || email || 'User avatar'}\r\n                    className=\"w-full h-full object-cover\"\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div\r\n            className={cn(\r\n                'rounded-full flex-shrink-0 avatar-gradient',\r\n                `avatar-gradient-${gradientIndex}`,\r\n                sizeClasses[size],\r\n                className\r\n            )}\r\n            title={name || email || 'User'}\r\n        >\r\n            {initials}\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\dropdown-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\radio-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\textarea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\components\\ui\\tooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\contexts\\PreferencesContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\find_duplicates.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\hooks\\useServiceWorker.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\hooks\\useServiceWorker.ts:33:9\n  31 |         }\n  32 |\n> 33 |         setState((prev) => ({ ...prev, isSupported: true, isOffline: !isOnline() }))\n     |         ^^^^^^^^ Avoid calling setState() directly within an effect\n  34 |\n  35 |         // Initialize offline storage\n  36 |         initOfflineStorage()","line":33,"column":9,"nodeType":null,"endLine":33,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { initOfflineStorage, isOnline, registerConnectivityListeners, getPendingCount } from '@/lib/offlineStorage'\r\n\r\ninterface ServiceWorkerState {\r\n    isSupported: boolean\r\n    isReady: boolean\r\n    isOffline: boolean\r\n    pendingSync: number\r\n    updateAvailable: boolean\r\n}\r\n\r\n/**\r\n * Hook to manage service worker registration and offline state\r\n */\r\nexport function useServiceWorker() {\r\n    const [state, setState] = useState<ServiceWorkerState>({\r\n        isSupported: false,\r\n        isReady: false,\r\n        isOffline: false,\r\n        pendingSync: 0,\r\n        updateAvailable: false,\r\n    })\r\n\r\n    useEffect(() => {\r\n        // Check if service workers are supported\r\n        if (!('serviceWorker' in navigator)) {\r\n            console.log('[SW Hook] Service workers not supported')\r\n            return\r\n        }\r\n\r\n        setState((prev) => ({ ...prev, isSupported: true, isOffline: !isOnline() }))\r\n\r\n        // Initialize offline storage\r\n        initOfflineStorage()\r\n            .then(() => {\r\n                console.log('[SW Hook] Offline storage initialized')\r\n                return getPendingCount()\r\n            })\r\n            .then((count) => {\r\n                setState((prev) => ({ ...prev, pendingSync: count }))\r\n            })\r\n            .catch(console.error)\r\n\r\n        // Register service worker\r\n        navigator.serviceWorker\r\n            .register('/sw.js', { scope: '/' })\r\n            .then((registration) => {\r\n                console.log('[SW Hook] Service worker registered:', registration.scope)\r\n                setState((prev) => ({ ...prev, isReady: true }))\r\n\r\n                // Check for updates\r\n                registration.onupdatefound = () => {\r\n                    const installingWorker = registration.installing\r\n                    if (!installingWorker) return\r\n\r\n                    installingWorker.onstatechange = () => {\r\n                        if (installingWorker.state === 'installed') {\r\n                            if (navigator.serviceWorker.controller) {\r\n                                // New update available\r\n                                console.log('[SW Hook] New content available')\r\n                                setState((prev) => ({ ...prev, updateAvailable: true }))\r\n                            } else {\r\n                                // Content cached for offline use\r\n                                console.log('[SW Hook] Content cached for offline use')\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n            .catch((error) => {\r\n                console.error('[SW Hook] Service worker registration failed:', error)\r\n            })\r\n\r\n        // Register connectivity listeners\r\n        const cleanup = registerConnectivityListeners(\r\n            () => {\r\n                setState((prev) => ({ ...prev, isOffline: false }))\r\n                // Refresh pending count when coming back online\r\n                getPendingCount().then((count) => {\r\n                    setState((prev) => ({ ...prev, pendingSync: count }))\r\n                })\r\n            },\r\n            () => {\r\n                setState((prev) => ({ ...prev, isOffline: true }))\r\n            }\r\n        )\r\n\r\n        return cleanup\r\n    }, [])\r\n\r\n    /**\r\n     * Force update service worker\r\n     */\r\n    const updateServiceWorker = async () => {\r\n        const registration = await navigator.serviceWorker.getRegistration()\r\n        if (registration?.waiting) {\r\n            registration.waiting.postMessage({ type: 'SKIP_WAITING' })\r\n            window.location.reload()\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Update pending sync count\r\n     */\r\n    const refreshPendingCount = async () => {\r\n        const count = await getPendingCount()\r\n        setState((prev) => ({ ...prev, pendingSync: count }))\r\n    }\r\n\r\n    return {\r\n        ...state,\r\n        updateServiceWorker,\r\n        refreshPendingCount,\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\i18n\\request.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\apiUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\citations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\email.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\embeddings.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\externalData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\featureFlags.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\fingerprint.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\gamification.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\hooks\\useAutosave.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\hooks\\useAutosave.ts:57:21\n  55 |                     // Draft expired, clean up\n  56 |                     localStorage.removeItem(storageKey)\n> 57 |                     setHasDraft(false)\n     |                     ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  58 |                     setDraftData(null)\n  59 |                 } else if (parsed.title || parsed.content) {\n  60 |                     // Valid draft exists","line":57,"column":21,"nodeType":null,"endLine":57,"endColumn":32}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect, useCallback, useRef } from 'react'\r\n\r\nexport interface DraftData {\r\n    title: string\r\n    content: string\r\n    tags: string\r\n    contentType: 'article' | 'question'\r\n    coverImage: string | null\r\n    license: string\r\n    lastSaved: number\r\n}\r\n\r\ninterface UseAutosaveOptions {\r\n    key: string\r\n    debounceMs?: number\r\n    enabled?: boolean\r\n}\r\n\r\ninterface UseAutosaveResult {\r\n    hasDraft: boolean\r\n    draftData: DraftData | null\r\n    lastSaved: Date | null\r\n    restoreDraft: () => DraftData | null\r\n    clearDraft: () => void\r\n    saveDraft: (data: Omit<DraftData, 'lastSaved'>) => void\r\n}\r\n\r\nconst AUTOSAVE_INTERVAL = 30000 // 30 seconds\r\nconst DRAFT_EXPIRY_HOURS = 72 // Keep drafts for 72 hours\r\n\r\nexport function useAutosave({\r\n    key,\r\n    debounceMs = 2000,\r\n    enabled = true,\r\n}: UseAutosaveOptions): UseAutosaveResult {\r\n    const [hasDraft, setHasDraft] = useState(false)\r\n    const [draftData, setDraftData] = useState<DraftData | null>(null)\r\n    const [lastSaved, setLastSaved] = useState<Date | null>(null)\r\n    const saveTimeoutRef = useRef<NodeJS.Timeout | null>(null)\r\n    const storageKey = `syrealize_draft_${key}`\r\n\r\n    // Check for existing draft on mount\r\n    useEffect(() => {\r\n        if (!enabled) return\r\n\r\n        try {\r\n            const stored = localStorage.getItem(storageKey)\r\n            if (stored) {\r\n                const parsed: DraftData = JSON.parse(stored)\r\n                const expiryTime = parsed.lastSaved + DRAFT_EXPIRY_HOURS * 60 * 60 * 1000\r\n\r\n                if (Date.now() > expiryTime) {\r\n                    // Draft expired, clean up\r\n                    localStorage.removeItem(storageKey)\r\n                    setHasDraft(false)\r\n                    setDraftData(null)\r\n                } else if (parsed.title || parsed.content) {\r\n                    // Valid draft exists\r\n                    setHasDraft(true)\r\n                    setDraftData(parsed)\r\n                    setLastSaved(new Date(parsed.lastSaved))\r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.error('Error loading draft:', error)\r\n            localStorage.removeItem(storageKey)\r\n        }\r\n    }, [storageKey, enabled])\r\n\r\n    // Save draft function\r\n    const saveDraft = useCallback(\r\n        (data: Omit<DraftData, 'lastSaved'>) => {\r\n            if (!enabled) return\r\n\r\n            // Clear any pending saves\r\n            if (saveTimeoutRef.current) {\r\n                clearTimeout(saveTimeoutRef.current)\r\n            }\r\n\r\n            // Debounce the save\r\n            saveTimeoutRef.current = setTimeout(() => {\r\n                try {\r\n                    // Don't save empty drafts\r\n                    if (!data.title.trim() && !data.content.trim()) {\r\n                        return\r\n                    }\r\n\r\n                    const draftWithTimestamp: DraftData = {\r\n                        ...data,\r\n                        lastSaved: Date.now(),\r\n                    }\r\n\r\n                    localStorage.setItem(storageKey, JSON.stringify(draftWithTimestamp))\r\n                    setLastSaved(new Date(draftWithTimestamp.lastSaved))\r\n                    setHasDraft(true)\r\n                    setDraftData(draftWithTimestamp)\r\n                } catch (error) {\r\n                    console.error('Error saving draft:', error)\r\n                }\r\n            }, debounceMs)\r\n        },\r\n        [storageKey, debounceMs, enabled]\r\n    )\r\n\r\n    // Restore draft function\r\n    const restoreDraft = useCallback((): DraftData | null => {\r\n        if (!draftData) return null\r\n        return draftData\r\n    }, [draftData])\r\n\r\n    // Clear draft function\r\n    const clearDraft = useCallback(() => {\r\n        if (saveTimeoutRef.current) {\r\n            clearTimeout(saveTimeoutRef.current)\r\n        }\r\n        localStorage.removeItem(storageKey)\r\n        setHasDraft(false)\r\n        setDraftData(null)\r\n        setLastSaved(null)\r\n    }, [storageKey])\r\n\r\n    // Cleanup timeout on unmount\r\n    useEffect(() => {\r\n        return () => {\r\n            if (saveTimeoutRef.current) {\r\n                clearTimeout(saveTimeoutRef.current)\r\n            }\r\n        }\r\n    }, [])\r\n\r\n    return {\r\n        hasDraft,\r\n        draftData,\r\n        lastSaved,\r\n        restoreDraft,\r\n        clearDraft,\r\n        saveDraft,\r\n    }\r\n}\r\n\r\n// Utility to format time since last save\r\nexport function formatTimeSince(date: Date): string {\r\n    const seconds = Math.floor((Date.now() - date.getTime()) / 1000)\r\n\r\n    if (seconds < 60) {\r\n        return 'Just now'\r\n    }\r\n\r\n    const minutes = Math.floor(seconds / 60)\r\n    if (minutes < 60) {\r\n        return `${minutes}m ago`\r\n    }\r\n\r\n    const hours = Math.floor(minutes / 60)\r\n    if (hours < 24) {\r\n        return `${hours}h ago`\r\n    }\r\n\r\n    const days = Math.floor(hours / 24)\r\n    return `${days}d ago`\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\hooks\\useCollaboration.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\hooks\\useViewTracking.ts","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\hooks\\useViewTracking.ts:11:41\n   9 |\n  10 | export function useViewTracking({ postId, enabled = true }: UseViewTrackingOptions) {\n> 11 |     const startTimeRef = useRef<number>(Date.now())\n     |                                         ^^^^^^^^^^ Cannot call impure function\n  12 |     const maxScrollDepthRef = useRef<number>(0)\n  13 |     const hasTrackedRef = useRef<boolean>(false)\n  14 |     const sessionIdRef = useRef<string>('')","line":11,"column":41,"nodeType":null,"endLine":11,"endColumn":51}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useEffect, useRef, useCallback } from 'react'\r\n\r\ninterface UseViewTrackingOptions {\r\n    postId: string\r\n    enabled?: boolean\r\n}\r\n\r\nexport function useViewTracking({ postId, enabled = true }: UseViewTrackingOptions) {\r\n    const startTimeRef = useRef<number>(Date.now())\r\n    const maxScrollDepthRef = useRef<number>(0)\r\n    const hasTrackedRef = useRef<boolean>(false)\r\n    const sessionIdRef = useRef<string>('')\r\n\r\n    // Generate or retrieve session ID\r\n    useEffect(() => {\r\n        if (typeof window !== 'undefined') {\r\n            let sessionId = sessionStorage.getItem('view_session_id')\r\n            if (!sessionId) {\r\n                sessionId = crypto.randomUUID()\r\n                sessionStorage.setItem('view_session_id', sessionId)\r\n            }\r\n            sessionIdRef.current = sessionId\r\n        }\r\n    }, [])\r\n\r\n    // Track scroll depth\r\n    useEffect(() => {\r\n        if (!enabled) return\r\n\r\n        const handleScroll = () => {\r\n            const windowHeight = window.innerHeight\r\n            const documentHeight = document.documentElement.scrollHeight - windowHeight\r\n            const scrollTop = window.scrollY\r\n            const scrollDepth = documentHeight > 0 ? scrollTop / documentHeight : 0\r\n\r\n            if (scrollDepth > maxScrollDepthRef.current) {\r\n                maxScrollDepthRef.current = Math.min(scrollDepth, 1)\r\n            }\r\n        }\r\n\r\n        window.addEventListener('scroll', handleScroll, { passive: true })\r\n        return () => window.removeEventListener('scroll', handleScroll)\r\n    }, [enabled])\r\n\r\n    // Track view on component unmount or page unload\r\n    const trackView = useCallback(async () => {\r\n        if (hasTrackedRef.current || !enabled) return\r\n        hasTrackedRef.current = true\r\n\r\n        const duration = Math.floor((Date.now() - startTimeRef.current) / 1000)\r\n        const referrer = document.referrer || undefined\r\n\r\n        try {\r\n            await fetch('/api/analytics', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    postId,\r\n                    sessionId: sessionIdRef.current,\r\n                    duration,\r\n                    scrollDepth: maxScrollDepthRef.current,\r\n                    referrer,\r\n                }),\r\n                keepalive: true, // Ensures request completes on page unload\r\n            })\r\n        } catch (error) {\r\n            console.error('Failed to track view:', error)\r\n        }\r\n    }, [postId, enabled])\r\n\r\n    // Track on unmount\r\n    useEffect(() => {\r\n        if (!enabled) return\r\n\r\n        const handleBeforeUnload = () => {\r\n            trackView()\r\n        }\r\n\r\n        const handleVisibilityChange = () => {\r\n            if (document.visibilityState === 'hidden') {\r\n                trackView()\r\n            }\r\n        }\r\n\r\n        window.addEventListener('beforeunload', handleBeforeUnload)\r\n        document.addEventListener('visibilitychange', handleVisibilityChange)\r\n\r\n        return () => {\r\n            window.removeEventListener('beforeunload', handleBeforeUnload)\r\n            document.removeEventListener('visibilitychange', handleVisibilityChange)\r\n            trackView()\r\n        }\r\n    }, [trackView, enabled])\r\n\r\n    return { trackView }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\i18n\\config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\i18n\\dictionaries.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\i18n\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\i18n\\provider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\moderation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\offlineStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\rateLimit.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\recommendationAnalysis.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\sessionContext.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\supabaseClient.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\supabase\\client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\supabase\\middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\supabase\\server.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\navigation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\next.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\playwright.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\public\\sw.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\read_keys.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\add-comments.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\apply-forum-migrations.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\apply-migrations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\check-columns.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\check-consistency.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\create-admin-user.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\create-researcher-user.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\debug-group-creation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\debug-invitations.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\debug-invitations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\debug-post-fetch.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\debug-post-insert.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\direct-test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\fix-env-keys.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\generate-embeddings.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\generate-token.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\list-badges.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\list-posts.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\populate-recommendations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\promote-user.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\read-status.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\seed-posts.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-advanced-features.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-analytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-diff.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-events.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-explore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-forum-flow.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-moderation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-plagiarism-flow.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-plagiarism.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-profile.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-qa.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-realtime.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-resources.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-schema.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-search-filters.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-search.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-storage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-supabase-invites.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\test-versioning.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\verify-automated-badges.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\verify-group-member.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\verify-group-posts-schema.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\verify-group-settings.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\verify-notifications.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\verify-plagiarism.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\verify-post-creation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\verify-profile-edit.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\verify-qa-flow.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\verify-qa.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\verify-reputation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\verify-schema-completeness.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\scripts\\verify-tag-system.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\supabase\\functions\\send-email\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\tailwind.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\test-node.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\tests\\e2e\\home.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\tests\\unit\\components\\Footer.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\tests\\utils\\test-utils.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\types\\advanced.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\verify_events.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\verify_rsvp_hypothesis.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\verify_rsvp_upsert.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\vitest.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\AvArc\\RiderProjects\\SyriaHub\\vitest.setup.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
